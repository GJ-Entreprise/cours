<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Exercices modbus - Cours - GJ enterprise</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Exercices modbus";
    var mkdocs_page_input_path = "reseaux_industriels/exercice_modbus.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Cours - GJ enterprise</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Welcome to courses website</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Management</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../management/STMicroelectronics/">STMicroelectronics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../management/exploitation_base_de_donne/">L'exploitation de base de données</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../management/proteger_le_travail/">Proteger le travail</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Memoire entreprise</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../memoire_entreprise/instruction_memoire_entreprise/">Instruction memoire entreprise</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Reseaux industriels</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Exercices modbus</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#julien-faou">Julien Faou</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#installation-modbus">Installation modbus</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#exercice-1-compromission-avec-modbus-cli">Exercice 1 - Compromission avec modbus-cli</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#exercice-2-scan-avec-nmap">Exercice 2 - Scan avec Nmap</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#exercice-3">Exercice 3</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../reseaux_industriel/">Réseaux industriels</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Cours - GJ enterprise</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Reseaux industriels &raquo;</li>
        
      
    
    <li>Exercices modbus</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="exercices-modbus">Exercices modbus</h1>
<h5 id="julien-faou">Julien Faou</h5>
<h2 id="installation-modbus">Installation modbus</h2>
<pre><code>sudo pip3 install pyModbus
</code></pre>

<h2 id="exercice-1-compromission-avec-modbus-cli">Exercice 1 - Compromission avec modbus-cli</h2>
<pre><code>sudo modbus read -h
Usage:
    modbus read [OPTIONS] HOST ADDRESS COUNT

Parameters:
    HOST                             IP address or hostname for the Modbus device
    ADDRESS                          Start address (eg %M100, %MW100, 101, 400101)
    COUNT                            number of data to read

Options:
    -w, --word                       use unsigned 16 bit integers
    -i, --int                        use signed 16 bit integers
    -d, --dword                      use unsigned 32 bit integers
    -f, --float                      use signed 32 bit floating point values
    --modicon                        use Modicon addressing (eg. coil: 101, word: 400001)
    --schneider                      use Schneider addressing (eg. coil: %M100, word: %MW0, float: %MF0, dword: %MD0)
    -s, --slave ID                   use slave id ID (default: 1)
    -p, --port PORT                  use TCP port (default: 502)
    -o, --output FILE                write results to file FILE
    -D, --debug                      show debug messages
    -T, --timeout TIMEOUT            Specify the timeout in seconds when talking to the slave
    -C, --connect-timeout TIMEOUT    Specify the timeout in seconds when connecting to TCP socket
    -h, --help                       print help
</code></pre>

<p><strong>A l’aide de la commande modbus read, lisez les 5 premiers registres de type bit</strong></p>
<pre><code>sudo modbus 192.168.43.161 1 5
</code></pre>

<pre><code>1          1
2          1
3          1
4          1
5          1
</code></pre>

<pre><code>sudo modbus -i 192.168.43.161 1 5
</code></pre>

<h2 id="exercice-2-scan-avec-nmap">Exercice 2 - Scan avec Nmap</h2>
<p><strong>Executer un nmap avec un script nse dédié à l’énumération pour modbus</strong></p>
<pre><code>nmap --script-help &quot;*modbus*&quot;
</code></pre>

<pre><code>Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-01 14:24 CEST

modbus-discover
Categories: discovery intrusive
https://nmap.org/nsedoc/scripts/modbus-discover.html
  Enumerates SCADA Modbus slave ids (sids) and collects their device information.

  Modbus is one of the popular SCADA protocols. This script does Modbus device
  information disclosure. It tries to find legal sids (slave ids) of Modbus
  devices and to get additional information about the vendor and firmware. This
  script is improvement of modscan python utility written by Mark Bristow.

  Information about MODBUS protocol and security issues:
  * MODBUS application protocol specification:  http://www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf
  * Defcon 16 Modscan presentation: https://www.defcon.org/images/defcon-16/dc16-presentations/defcon-16-bristow.pdf
  * Modscan utility is hosted at google code: http://code.google.com/p/modscan/
</code></pre>

<pre><code>nmap -sT -p502 --script modbus-discover 192.168.43.161
</code></pre>

<pre><code>Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-01 14:48 CEST
Nmap scan report for 192.168.43.161
Host is up (0.00087s latency).

PORT    STATE    SERVICE
502/tcp filtered mbap

Nmap done: 1 IP address (1 host up) scanned in 0.50 seconds
</code></pre>

<h2 id="exercice-3">Exercice 3</h2>
<p><strong>Trouver au moins un exploit existant dans exploit-db.com concernant un serveur modbus</strong></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../reseaux_industriel/" class="btn btn-neutral float-right" title="Réseaux industriels">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../memoire_entreprise/instruction_memoire_entreprise/" class="btn btn-neutral" title="Instruction memoire entreprise"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../memoire_entreprise/instruction_memoire_entreprise/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../reseaux_industriel/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
